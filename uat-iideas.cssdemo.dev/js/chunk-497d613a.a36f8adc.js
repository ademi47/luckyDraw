(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-497d613a"],{"077b":function(e,t,r){"use strict";r("f652")},"21a6":function(e,t,r){(function(r){var s,a,n;(function(r,o){a=[],s=o,n="function"===typeof s?s.apply(t,a):s,void 0===n||(e.exports=n)})(0,(function(){"use strict";function t(e,t){return"undefined"==typeof t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function s(e,t,r){var s=new XMLHttpRequest;s.open("GET",e),s.responseType="blob",s.onload=function(){l(s.response,t,r)},s.onerror=function(){console.error("could not download file")},s.send()}function a(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function n(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(s){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var o="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof r&&r.global===r?r:void 0,i=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=o.saveAs||("object"!=typeof window||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!i?function(e,t,r){var i=o.URL||o.webkitURL,l=document.createElement("a");t=t||e.name||"download",l.download=t,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?n(l):a(l.href)?s(e,t,r):n(l,l.target="_blank")):(l.href=i.createObjectURL(e),setTimeout((function(){i.revokeObjectURL(l.href)}),4e4),setTimeout((function(){n(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,r,o){if(r=r||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,o),r);else if(a(e))s(e,r,o);else{var i=document.createElement("a");i.href=e,i.target="_blank",setTimeout((function(){n(i)}))}}:function(e,t,r,a){if(a=a||open("","_blank"),a&&(a.document.title=a.document.body.innerText="downloading..."),"string"==typeof e)return s(e,t,r);var n="application/octet-stream"===e.type,l=/constructor/i.test(o.HTMLElement)||o.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||n&&l||i)&&"undefined"!=typeof FileReader){var d=new FileReader;d.onloadend=function(){var e=d.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=e:location=e,a=null},d.readAsDataURL(e)}else{var u=o.URL||o.webkitURL,p=u.createObjectURL(e);a?a.location=p:location.href=p,a=null,setTimeout((function(){u.revokeObjectURL(p)}),4e4)}});o.saveAs=l.saveAs=l,e.exports=l}))}).call(this,r("c8ba"))},"6c32":function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e._self._c;return t("div",[t("b-card",[t("div",{staticClass:"d-flex justify-content-between align-items-center"},[t("h4",[e._v("Client User")]),t("div",[t("button",{staticClass:"btn btn-warning mr-2",attrs:{disabled:!e.safeClientList.length},on:{click:e.getExcelReport}},[e._v("Export")]),t("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.add-user-modal",modifiers:{"add-user-modal":!0}}],attrs:{variant:"primary"}},[e._v("Add")])],1)]),e.safeClientList.length?t("b-table",{staticClass:"mt-3",attrs:{hover:"",bordered:"",responsive:"",items:e.safeClientList,fields:e.tableFields},on:{"row-clicked":e.openUserDetailsModal},scopedSlots:e._u([{key:"cell(index)",fn:function(t){return[e._v(" "+e._s(t.index+1)+" ")]}},{key:"cell(PASSWORD)",fn:function(r){return[t("span",[e._v(e._s(r.item.PASSWORD))])]}}],null,!1,1754950291)}):t("div",{staticClass:"text-center py-5 text-muted"},[t("h5",[t("b",[e._v("NO USER FOUND")])])])],1),t("b-modal",{ref:"userModal",attrs:{id:"modal-3",title:"Edit Client User",size:"lg","hide-footer":""}},[e.editableUser?t("div",[t("div",{staticClass:"row"},[t("div",{staticClass:"col-md-4"},[t("label",[e._v("Person Name")]),t("b-form-input",{attrs:{type:"text"},model:{value:e.editableUser.PERSON_NAME,callback:function(t){e.$set(e.editableUser,"PERSON_NAME",t)},expression:"editableUser.PERSON_NAME"}}),e.editErrors.PERSON_NAME?t("small",{staticClass:"validation-error"},[e._v(e._s(e.editErrors.PERSON_NAME))]):e._e()],1),t("div",{staticClass:"col-md-4"},[t("label",[e._v("Username")]),t("b-form-input",{attrs:{type:"email"},model:{value:e.editableUser.USER_NAME,callback:function(t){e.$set(e.editableUser,"USER_NAME",t)},expression:"editableUser.USER_NAME"}}),e.editErrors.USER_NAME?t("small",{staticClass:"validation-error"},[e._v(e._s(e.editErrors.USER_NAME))]):e._e()],1),t("div",{staticClass:"col-md-4"},[t("label",[e._v("Password")]),t("b-form-input",{attrs:{type:"text"},model:{value:e.editableUser.PASSWORD,callback:function(t){e.$set(e.editableUser,"PASSWORD",t)},expression:"editableUser.PASSWORD"}}),e.editErrors.PASSWORD?t("small",{staticClass:"validation-error"},[e._v(e._s(e.editErrors.PASSWORD))]):e._e()],1)]),t("div",{staticClass:"mt-3 text-center"},[t("div",{staticClass:"d-flex justify-content-center my-3"},[t("VueQRCodeComponent",{ref:"qrCode",attrs:{text:e.generateQRCodeText(e.editableUser),size:100}})],1),t("div",{staticClass:"mt-2"},[t("button",{staticClass:"btn btn-info",on:{click:e.downloadQR}},[e._v("Download QR")])])]),t("div",{staticClass:"d-flex mt-3 justify-content-between"},[t("div",[t("button",{staticClass:"btn btn-danger mr-2",attrs:{disabled:e.isLoading},on:{click:e.confirmDelete}},[e._v("Delete")]),t("button",{staticClass:"btn btn-secondary",on:{click:e.cancelEdit}},[e._v("Cancel")])]),t("button",{staticClass:"btn btn-primary",attrs:{disabled:e.isLoading},on:{click:e.saveEdit}},[e._v("Update")])])]):e._e()]),t("b-modal",{attrs:{id:"add-user-modal",title:"Add Client User",size:"lg","hide-footer":""}},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-md-4"},[t("label",[e._v("Person Name")]),t("b-form-input",{attrs:{type:"text",placeholder:"Enter person name"},model:{value:e.new_user.person_name,callback:function(t){e.$set(e.new_user,"person_name",t)},expression:"new_user.person_name"}}),e.addErrors.person_name?t("small",{staticClass:"validation-error"},[e._v(e._s(e.addErrors.person_name))]):e._e()],1),t("div",{staticClass:"col-md-4"},[t("label",[e._v("Username")]),t("b-form-input",{attrs:{type:"email",placeholder:"Enter username"},model:{value:e.new_user.username,callback:function(t){e.$set(e.new_user,"username",t)},expression:"new_user.username"}}),e.addErrors.username?t("small",{staticClass:"validation-error"},[e._v(e._s(e.addErrors.username))]):e._e()],1),t("div",{staticClass:"col-md-4"},[t("label",[e._v("Password")]),t("b-form-input",{attrs:{type:"text",placeholder:"Enter password"},model:{value:e.new_user.password,callback:function(t){e.$set(e.new_user,"password",t)},expression:"new_user.password"}}),e.addErrors.password?t("small",{staticClass:"validation-error"},[e._v(e._s(e.addErrors.password))]):e._e()],1)]),t("div",{staticClass:"d-flex mt-3 justify-content-between"},[t("button",{staticClass:"btn btn-secondary",on:{click:function(t){return e.$bvModal.hide("add-user-modal")}}},[e._v("Cancel")]),t("button",{staticClass:"btn btn-primary",attrs:{disabled:e.isLoading},on:{click:e.addClientUserDetails}},[e._v("Save")])])])],1)},a=[],n=r("5530"),o=r("c7eb"),i=r("1da1"),l=r("2909"),c=r("53ca"),d=(r("4de4"),r("d3b7"),r("e9c4"),r("159b"),r("14d9"),r("d81d"),r("99af"),r("ac1f"),r("00b4"),r("b64b"),r("471e")),u=r("dfcf"),p=r("323e"),_=r.n(p),f=r("25ca"),b=r("21a6"),v={components:{VueQRCodeComponent:u["a"]},data:function(){return{event_sys_id:null,user_sys_id:null,isLoading:!1,client_list_details:[],selectedUser:null,editableUser:null,new_user:{person_name:"",username:"",password:""},addErrors:{},editErrors:{},tableFields:[{key:"index",label:"SlNo"},{key:"PERSON_NAME",label:"Person Name"},{key:"USER_NAME",label:"Username"},{key:"PASSWORD",label:"Password"}]}},computed:{safeClientList:function(){return this.client_list_details.filter((function(e){return e&&"object"===Object(c["a"])(e)&&e.PERSON_NAME}))}},mounted:function(){this.event_sys_id=JSON.parse(localStorage.getItem("selectedEventSysId"));var e=JSON.parse(localStorage.getItem("userInfo"));this.user_sys_id=(null===e||void 0===e?void 0:e.user_id)||1,this.getClientUserDetailsInfo()},methods:{getExcelReport:function(){if(this.safeClientList.length){var e=["S/N","Person Name","Username","Password"],t=["Index","PERSON_NAME","USER_NAME","PASSWORD"],r=[],s=JSON.parse(JSON.stringify(this.safeClientList));s.forEach((function(e,t){e["Index"]=t+1,r.push(e)}));var a=this.formatJson(t,r);this.generateXlsx(e,a,"ClientUserList")}},formatJson:function(e,t){return t.map((function(t){return e.map((function(e){return t[e]}))}))},generateXlsx:function(e,t,r){var s=f["c"].aoa_to_sheet([e].concat(Object(l["a"])(t))),a=f["c"].book_new();f["c"].book_append_sheet(a,s,"Sheet1");var n=f["d"](a,{bookType:"xlsx",type:"array"});Object(b["saveAs"])(new Blob([n],{type:"application/octet-stream"}),"".concat(r,".xlsx"))},validateForm:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r={},s=void 0!==e.PERSON_NAME?"PERSON_NAME":"person_name",a=void 0!==e.USER_NAME?"USER_NAME":"username",n=void 0!==e.PASSWORD?"PASSWORD":"password";return e[s]||t||(r[s]="Person name is required."),e[a]||t||(r[a]="Username is required."),e[a]&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e[a])&&(r[a]="Invalid email format."),e[n]||t||(r[n]="Password is required."),e[n]&&e[n].length<4&&(r[n]="Password must be at least 4 characters."),r},getClientUserDetailsInfo:function(){var e=this;return Object(i["a"])(Object(o["a"])().mark((function t(){var r,s;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r={ITEM:"VIEW_ALL",EVENT_SYS_ID:e.event_sys_id},t.prev=1,t.next=4,e.$apiCall.get(e.$apiBus.api_get_client_user,{params:r});case 4:s=t.sent,"true"===s.status&&Array.isArray(s.response)?e.client_list_details=s.response.filter((function(e){return e&&"object"===Object(c["a"])(e)})):e.client_list_details=[],t.next=12;break;case 8:t.prev=8,t.t0=t["catch"](1),console.error("Fetch error",t.t0),d["a"].showErrorAlert(!0,"error","Failed to fetch client users.");case 12:case"end":return t.stop()}}),t,null,[[1,8]])})))()},addClientUserDetails:function(){var e=this;return Object(i["a"])(Object(o["a"])().mark((function t(){var r,s;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.addErrors=e.validateForm(e.new_user),!(Object.keys(e.addErrors).length>0)){t.next=3;break}return t.abrupt("return");case 3:return _.a.start(),e.isLoading=!0,r={ITEM:"ADD",EVENT_SYS_ID:e.event_sys_id,PERSON_NAME:e.new_user.person_name,USER_NAME:e.new_user.username,PASSWORD:e.new_user.password,CREATED_BY:e.user_sys_id},t.prev=6,t.next=9,e.$apiCall.post(e.$apiBus.api_post_add_update_client_user,r);case 9:if(s=t.sent,"true"!==s.status){t.next=18;break}return t.next=13,e.getClientUserDetailsInfo();case 13:e.$bvModal.hide("add-user-modal"),d["a"].showSuccessAlert(!0,"success",s.response),e.new_user={person_name:"",username:"",password:""},t.next=19;break;case 18:d["a"].showErrorAlert(!0,"error",s.response);case 19:t.next=25;break;case 21:t.prev=21,t.t0=t["catch"](6),console.error("Add error",t.t0),d["a"].showErrorAlert(!0,"error","Failed to add client user.");case 25:return t.prev=25,e.isLoading=!1,_.a.done(),t.finish(25);case 29:case"end":return t.stop()}}),t,null,[[6,21,25,29]])})))()},openUserDetailsModal:function(e){var t=this;return Object(i["a"])(Object(o["a"])().mark((function r(){var s,a;return Object(o["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return s={ITEM:"SPECIFIC",CLIENT_USER_SYS_ID:e.CLIENT_USER_SYS_ID},r.prev=1,r.next=4,t.$apiCall.get(t.$apiBus.api_get_specific_client_user,{params:s});case 4:a=r.sent,"true"===a.status&&Array.isArray(a.response)?(t.selectedUser=a.response[0]||null,t.editableUser=Object(n["a"])({},t.selectedUser),t.$refs.userModal.show()):(t.selectedUser=null,d["a"].showErrorAlert(!0,"error",a.response)),r.next=12;break;case 8:r.prev=8,r.t0=r["catch"](1),console.error("Fetch specific user error",r.t0),d["a"].showErrorAlert(!0,"error","Failed to fetch user details.");case 12:case"end":return r.stop()}}),r,null,[[1,8]])})))()},cancelEdit:function(){this.$refs.userModal.hide(),this.editableUser=null,this.editErrors={}},saveEdit:function(){var e=this;return Object(i["a"])(Object(o["a"])().mark((function t(){var r,s;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.editErrors=e.validateForm(e.editableUser,!0),!(Object.keys(e.editErrors).length>0)){t.next=3;break}return t.abrupt("return");case 3:return _.a.start(),e.isLoading=!0,r={ITEM:"UPDATE",EVENT_SYS_ID:e.event_sys_id,CLIENT_USER_SYS_ID:e.editableUser.CLIENT_USER_SYS_ID,CREATED_BY:e.user_sys_id,PERSON_NAME:e.editableUser.PERSON_NAME,USER_NAME:e.editableUser.USER_NAME,PASSWORD:e.editableUser.PASSWORD},t.prev=6,t.next=9,e.$apiCall.post(e.$apiBus.api_post_add_update_client_user,r);case 9:s=t.sent,"true"===s.status?(e.getClientUserDetailsInfo(),e.$bvModal.hide("modal-3"),d["a"].showSuccessAlert(!0,"success",s.response)):d["a"].showErrorAlert(!0,"error",s.response),t.next=17;break;case 13:t.prev=13,t.t0=t["catch"](6),console.error("Update error",t.t0),d["a"].showErrorAlert(!0,"error","Update failed.");case 17:return t.prev=17,e.isLoading=!1,e.editableUser=null,_.a.done(),t.finish(17);case 22:case"end":return t.stop()}}),t,null,[[6,13,17,22]])})))()},generateQRCodeText:function(e){return e?"Name: ".concat(e.PERSON_NAME,"\nUsername: ").concat(e.USER_NAME,"\nPassword: ").concat(e.PASSWORD):""},downloadQR:function(){var e,t,r=null===(e=this.$refs.qrCode)||void 0===e||null===(t=e.$el)||void 0===t?void 0:t.querySelector("canvas");if(!r)return d["a"].showErrorAlert(!0,"error","QR code not available.");try{var s=document.createElement("a");s.href=r.toDataURL("image/png"),s.download="client-user-qr.png",s.click(),d["a"].showSuccessAlert(!0,"success","QR code downloaded.")}catch(a){console.error("QR download error",a),d["a"].showErrorAlert(!0,"error","Failed to download QR code.")}},confirmDelete:function(){var e=this;return Object(i["a"])(Object(o["a"])().mark((function t(){var r,s,a,n;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(null!==(r=e.selectedUser)&&void 0!==r&&r.CLIENT_USER_SYS_ID){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,d["a"].showConfirmationAlert("Are you sure?","You want to delete this record!","warning");case 5:if(s=t.sent,!s.isConfirmed){t.next=21;break}return e.isLoading=!0,_.a.start(),a={ITEM:"DELETE",CLIENT_USER_SYS_ID:e.selectedUser.CLIENT_USER_SYS_ID},t.next=12,e.$apiCall.post(e.$apiBus.api_post_add_update_client_user,a);case 12:if(n=t.sent,"true"!==n.status){t.next=20;break}return d["a"].showSuccessAlert(!0,"success",n.response),e.$refs.userModal.hide(),t.next=18,e.getClientUserDetailsInfo();case 18:t.next=21;break;case 20:d["a"].showErrorAlert(!0,"error",n.response);case 21:t.next=27;break;case 23:t.prev=23,t.t0=t["catch"](2),console.error("Delete error",t.t0),d["a"].showErrorAlert(!0,"error","Delete failed.");case 27:return t.prev=27,e.isLoading=!1,_.a.done(),t.finish(27);case 31:case"end":return t.stop()}}),t,null,[[2,23,27,31]])})))()}}},E=v,m=(r("077b"),r("2877")),w=Object(m["a"])(E,s,a,!1,null,"f2624eaa",null);t["default"]=w.exports},f652:function(e,t,r){}}]);