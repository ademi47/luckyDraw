(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-724804aa"],{"67d8":function(e,t,r){"use strict";r("ff09")},"95cd":function(e,t,r){e.exports=r.p+"img/loader.85135c1c.gif"},a5d8:function(e,t,r){},ceea:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e._self._c;return t("div",[e.isLoading?t("div",[e._m(0)]):e._e(),t("div",{staticClass:"main-content"},[t("b-card",[t("div",{staticClass:"d-flex justify-content-between align-items-center"},[t("h4",{staticClass:"card-title mb-0"},[e._v("Team")]),t("b-button",{attrs:{variant:"primary"},on:{click:e.showAddMemberModal}},[e._v("Add Member")])],1),t("div",{staticClass:"d-flex justify-content-between flex-wrap mt-3"},[t("div",{staticClass:"search-container"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.search_text,expression:"search_text"}],staticClass:"search-input",attrs:{type:"text",placeholder:"Search person name"},domProps:{value:e.search_text},on:{input:function(t){t.target.composing||(e.search_text=t.target.value)}}}),t("button",{staticClass:"search-button"},[t("i",{staticClass:"fa fa-search"})])])]),t("div",{staticClass:"table-responsive mt-3"},[t("b-table",{staticClass:"cursor-pointer",attrs:{"head-variant":"light",filter:e.search_text,bordered:"",hover:"",fields:e.team_fields,items:e.team_list,"show-empty":""},scopedSlots:e._u([{key:"head(index)",fn:function(){return[t("div",{staticClass:"text-center"},[e._v("Sl No.")])]},proxy:!0},{key:"cell(index)",fn:function(r){return[t("div",{staticClass:"text-center"},[e._v(e._s(r.index+1))])]}},{key:"cell(TEAM_MEMBER_NAME)",fn:function(t){return[e._v(" "+e._s(t.item.TEAM_MEMBER_NAME)+" ")]}},{key:"cell(TEAM_MEMBER_EMAIL)",fn:function(t){return[e._v(" "+e._s(t.item.TEAM_MEMBER_EMAIL||"N/A")+" ")]}},{key:"cell(PROJECT_ROLE_SYS_ID)",fn:function(r){return[t("b-form-select",{staticClass:"form-control",attrs:{options:e.Project_Role_list_details},on:{change:function(t){return e.updateUserRole(r.item)}},model:{value:r.item.PROJECT_ROLE_SYS_ID,callback:function(t){e.$set(r.item,"PROJECT_ROLE_SYS_ID",t)},expression:"data.item.PROJECT_ROLE_SYS_ID"}},[t("option",{domProps:{value:null}},[e._v("Select")])])]}},{key:"cell(action)",fn:function(r){return[t("div",{staticClass:"text-center"},[t("b-button",{attrs:{variant:"danger",size:"sm"},on:{click:function(t){return t.stopPropagation(),e.removeMember(r.item)}}},[t("i",{staticClass:"fa fa-times"})])],1)]}}])})],1)])],1),t("validation-observer",{ref:"memberObserver",scopedSlots:e._u([{key:"default",fn:function(r){var s=r.handleSubmit;return[t("b-modal",{attrs:{id:"add-member-modal",title:"Add New Team Member",size:"lg","hide-footer":""},on:{hidden:e.resetAddMemberModal}},[t("b-form",{on:{submit:function(t){return t.preventDefault(),s(e.addMember)}}},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-md-12"},[t("validation-provider",{attrs:{name:"Name",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("label",[e._v("Name "),t("span",{staticClass:"text-danger"},[e._v("*")])]),t("b-form-input",{attrs:{id:"name-input",placeholder:"Enter member name",state:e.getValidationState(r)},model:{value:e.newMember.TEAM_MEMBER_NAME,callback:function(t){e.$set(e.newMember,"TEAM_MEMBER_NAME",t)},expression:"newMember.TEAM_MEMBER_NAME"}}),t("b-form-invalid-feedback",[e._v(e._s(r.errors[0]))])]}}],null,!0)})],1)]),t("div",{staticClass:"row mt-3"},[t("div",{staticClass:"col-md-12"},[t("validation-provider",{attrs:{name:"Email",rules:"required|email"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("label",[e._v("Email "),t("span",{staticClass:"text-danger"},[e._v("*")])]),t("b-form-input",{attrs:{id:"email-input",type:"email",placeholder:"Enter email address",state:e.getValidationState(r)},model:{value:e.newMember.TEAM_MEMBER_EMAIL,callback:function(t){e.$set(e.newMember,"TEAM_MEMBER_EMAIL",t)},expression:"newMember.TEAM_MEMBER_EMAIL"}}),t("b-form-invalid-feedback",[e._v(e._s(r.errors[0]))])]}}],null,!0)})],1)]),t("div",{staticClass:"row mt-3"},[t("div",{staticClass:"col-md-12"},[t("validation-provider",{attrs:{name:"Project Role",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("label",[e._v("Project Role "),t("span",{staticClass:"text-danger"},[e._v("*")])]),t("b-form-select",{attrs:{id:"role-select",options:e.Project_Role_list_details,state:e.getValidationState(r)},scopedSlots:e._u([{key:"first",fn:function(){return[t("b-form-select-option",{attrs:{value:null,disabled:""}},[e._v("-- Please select a role --")])]},proxy:!0}],null,!0),model:{value:e.newMember.PROJECT_ROLE_SYS_ID,callback:function(t){e.$set(e.newMember,"PROJECT_ROLE_SYS_ID",t)},expression:"newMember.PROJECT_ROLE_SYS_ID"}}),t("b-form-invalid-feedback",[e._v(e._s(r.errors[0]))])]}}],null,!0)})],1)]),t("div",{staticClass:"row mt-4"},[t("div",{staticClass:"col-6 text-left"},[t("b-button",{attrs:{type:"button",variant:"secondary"},on:{click:function(t){return e.$bvModal.hide("add-member-modal")}}},[e._v(" Cancel ")])],1),t("div",{staticClass:"col-6 text-right"},[t("b-button",{attrs:{type:"submit",variant:"primary",disabled:e.isLoading}},[e.isLoading?t("b-spinner",{attrs:{small:""}}):t("span",[e._v("Add")])],1)],1)])])],1)]}}])})],1)},a=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"loading_main_background",attrs:{id:"upload_loader"}},[t("img",{attrs:{src:r("95cd")}})])}],o=r("2909"),i=r("c7eb"),n=r("1da1"),l=(r("4de4"),r("d3b7"),r("caad"),r("2532"),r("3ca3"),r("ddb0"),r("e9c4"),r("d81d"),r("99af"),r("323e")),d=r.n(l),c=(r("a5d8"),r("471e")),_={data:function(){return{isLoading:!1,search_text:"",Project_Role_list_details:[],rolesLoaded:!1,team_list:[],team_fields:[{key:"index",label:"Sl No.",thStyle:{width:"70px"}},{key:"TEAM_MEMBER_NAME",label:"Name"},{key:"TEAM_MEMBER_EMAIL",label:"Email"},{key:"PROJECT_ROLE_SYS_ID",label:"Role"},{key:"action",label:"Action",thClass:"text-center",tdClass:"text-center align-middle",thStyle:{width:"100px"}}],newMember:{TEAM_MEMBER_NAME:"",TEAM_MEMBER_EMAIL:"",PROJECT_ROLE_SYS_ID:null},selected_event_sys_id:null,organisation_sys_id:null,isProjectRoleApiCalled:!1,user_sys_id:null,userDetails:null}},computed:{filteredTeam:function(){var e=this;return this.search_text?this.team_list.filter((function(t){var r;return null===(r=t.TEAM_MEMBER_NAME)||void 0===r?void 0:r.toLowerCase().includes(e.search_text.toLowerCase())})):this.team_list},getAuthUser:function(){var e,t,r;return(null===(e=this.$store)||void 0===e||null===(t=e.state)||void 0===t||null===(r=t.auth)||void 0===r?void 0:r.user)||null}},mounted:function(){var e=this;return Object(n["a"])(Object(i["a"])().mark((function t(){var r,s;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(console.log("Team component mounted"),r=localStorage.getItem("selectedEventSysId"),r&&(e.selected_event_sys_id=r),s=localStorage.getItem("userInfo"),s&&(e.userDetails=JSON.parse(s),e.user_sys_id=e.userDetails),!e.selected_event_sys_id){t.next=8;break}return t.next=8,e.initializeData(e.selected_event_sys_id);case 8:case"end":return t.stop()}}),t)})))()},methods:{startProgress:function(){d.a.start(),d.a.set(.1),this.isLoading=!0},doneProgress:function(){d.a.done(),this.isLoading=!1},showAddMemberModal:function(){this.$bvModal.show("add-member-modal")},hideAddMemberModal:function(){this.$bvModal.hide("add-member-modal")},resetAddMemberModal:function(){var e;this.newMember={TEAM_MEMBER_NAME:"",TEAM_MEMBER_EMAIL:"",PROJECT_ROLE_SYS_ID:null},null===(e=this.$refs.memberObserver)||void 0===e||e.reset()},initializeData:function(e){var t=this;return Object(n["a"])(Object(i["a"])().mark((function r(){return Object(i["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.startProgress(),r.prev=1,r.next=4,t.getSpecificEvent(e);case 4:if(!t.organisation_sys_id){r.next=7;break}return r.next=7,Promise.all([t.getProjectRoleInfo(),t.getViewTeamListInfo()]);case 7:r.next=12;break;case 9:r.prev=9,r.t0=r["catch"](1),console.error("Error initializing data:",r.t0);case 12:return r.prev=12,t.doneProgress(),r.finish(12);case 15:case"end":return r.stop()}}),r,null,[[1,9,12,15]])})))()},getSpecificEvent:function(e){var t=this;return Object(n["a"])(Object(i["a"])().mark((function r(){var s,a;return Object(i["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.$apiCall.get(t.$apiBus.api_get_specific_event_info,{params:{ITEM:"SPECIFIC",EVENT_SYS_ID:e}});case 3:s=r.sent,"true"===s.status&&s.response.length?(a=s.response[0],t.organisation_sys_id=a.ORGANIZATION_SYS_ID,console.log("Event loaded, organization ID:",t.organisation_sys_id)):c["a"].showErrorAlert(!0,"error","Event not found"),r.next=11;break;case 7:r.prev=7,r.t0=r["catch"](0),console.error("Error loading event:",r.t0),c["a"].showErrorAlert(!0,"error","Error loading event");case 11:case"end":return r.stop()}}),r,null,[[0,7]])})))()},loadCachedData:function(){try{var e=localStorage.getItem("project_roles_data"),t=localStorage.getItem("team_list_data");e&&(this.Project_Role_list_details=JSON.parse(e),this.rolesLoaded=!0),t&&(this.team_list=JSON.parse(t))}catch(r){console.error("Error loading cached data:",r)}},getViewTeamListInfo:function(){var e=this;if(this.organisation_sys_id&&this.selected_event_sys_id){var t={ITEM:"VIEW_ALL",ORGANIZATION_SYS_ID:this.organisation_sys_id,EVENT_SYS_ID:this.selected_event_sys_id};return console.log("Fetching team list with params:",t),this.$apiCall.get(this.$apiBus.api_get_view_team,{params:t}).then((function(t){console.log("Team list response:",t);var r="string"===typeof t?JSON.parse(t):(null===t||void 0===t?void 0:t.data)||t;if("true"===(null===r||void 0===r?void 0:r.status)&&Array.isArray(r.response)){var s=r.response.filter((function(e){return"ACTIVE"===e.STATUS||!e.STATUS}));e.team_list=s,localStorage.setItem("team_list_data",JSON.stringify(e.team_list)),console.log("Team list loaded:",e.team_list)}else console.error("Failed to load team list:",r),e.team_list=[],c["a"].showErrorAlert(!0,"error","Failed to load team list")})).catch((function(t){console.error("Failed to fetch team list:",t),e.team_list=[],c["a"].showErrorAlert(!0,"error","Failed to fetch team list")}))}this.team_list=[]},getProjectRoleInfo:function(){var e=this;if(this.organisation_sys_id){if(!this.isProjectRoleApiCalled||!this.rolesLoaded){var t={ITEM:"VIEW_ALL",ORGANIZATION_SYS_ID:this.organisation_sys_id};return console.log("Fetching project roles with params:",t),this.$apiCall.get(this.$apiBus.api_get_view_project_role,{params:t}).then((function(t){console.log("Project roles response:",t);var r="string"===typeof t?JSON.parse(t):(null===t||void 0===t?void 0:t.data)||t;if("true"===(null===r||void 0===r?void 0:r.status)&&Array.isArray(r.response)){e.isProjectRoleApiCalled=!0;var s=r.response.filter((function(e){return"ACTIVE"===e.STATUS})).map((function(e){return{value:e.PROJECT_ROLE_SYS_ID,text:e.PROJECT_ROLE}}));e.Project_Role_list_details=[{value:null,text:"Select"}].concat(Object(o["a"])(s)),localStorage.setItem("project_roles_data",JSON.stringify(e.Project_Role_list_details)),e.rolesLoaded=!0,console.log("Project roles loaded:",e.Project_Role_list_details)}else console.error("Failed to load project roles:",r),c["a"].showErrorAlert(!0,"error","Failed to load project roles")})).catch((function(e){console.error("Failed to load roles:",e),c["a"].showErrorAlert(!0,"error","Failed to load project roles")}))}}else this.Project_Role_list_details=[{value:null,text:"Select Role"}]},addMember:function(){var e,t,r=this,s=(null===(e=this.getAuthUser)||void 0===e?void 0:e.UserId)||(null===(t=this.userDetails)||void 0===t?void 0:t.USER_SYS_ID)||1,a={ITEM:"ADD_UPDATE",TEAM_SYS_ID:0,EVENT_SYS_ID:this.selected_event_sys_id,ORGANIZATION_SYS_ID:this.organisation_sys_id,TEAM_MEMBER_NAME:this.newMember.TEAM_MEMBER_NAME,TEAM_MEMBER_EMAIL:this.newMember.TEAM_MEMBER_EMAIL,PROJECT_ROLE_SYS_ID:this.newMember.PROJECT_ROLE_SYS_ID,CREATED_BY:s};return this.startProgress(),console.log("Adding team member:",a),this.$apiCall.post(this.$apiBus.api_post_add_update_team,a).then((function(e){console.log("Add member response:",e);var t="string"===typeof e?JSON.parse(e):(null===e||void 0===e?void 0:e.data)||e;"true"===(null===t||void 0===t?void 0:t.status)?(c["a"].showSuccessAlert(!0,"success","Team member added successfully"),r.getViewTeamListInfo(),r.hideAddMemberModal(),r.resetAddMemberModal()):c["a"].showErrorAlert(!0,"error",t.response||"Failed to add team member")})).catch((function(e){console.error("Failed to add member:",e),c["a"].showErrorAlert(!0,"error","Failed to add team member")})).finally((function(){r.doneProgress()}))},updateUserRole:function(e){var t,r,s=this,a=(null===(t=this.getAuthUser)||void 0===t?void 0:t.UserId)||(null===(r=this.userDetails)||void 0===r?void 0:r.USER_SYS_ID)||1,o={ITEM:"ADD_UPDATE",TEAM_SYS_ID:e.TEAM_SYS_ID,EVENT_SYS_ID:this.selected_event_sys_id,ORGANIZATION_SYS_ID:this.organisation_sys_id,TEAM_MEMBER_NAME:e.TEAM_MEMBER_NAME,TEAM_MEMBER_EMAIL:e.TEAM_MEMBER_EMAIL,PROJECT_ROLE_SYS_ID:e.PROJECT_ROLE_SYS_ID,CREATED_BY:a};return this.startProgress(),console.log("Updating user role:",o),this.$apiCall.post(this.$apiBus.api_post_add_update_team,o).then((function(e){console.log("Update role response:",e);var t="string"===typeof e?JSON.parse(e):(null===e||void 0===e?void 0:e.data)||e;"true"===(null===t||void 0===t?void 0:t.status)?(c["a"].showSuccessAlert(!0,"success","Role updated successfully"),s.getViewTeamListInfo()):c["a"].showErrorAlert(!0,"error",t.response||"Failed to update role")})).catch((function(e){console.error("Role update failed:",e),c["a"].showErrorAlert(!0,"error","Failed to update role")})).finally((function(){s.doneProgress()}))},removeMember:function(e){var t=this;return Object(n["a"])(Object(i["a"])().mark((function r(){var s,a,o,n,l;return Object(i["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,c["a"].showConfirmationAlert("Are you sure?","You want to remove ".concat(e.TEAM_MEMBER_NAME," from the team!"),"warning");case 3:if(o=r.sent,o.isConfirmed){r.next=6;break}return r.abrupt("return");case 6:return t.startProgress(),n=(null===(s=t.getAuthUser)||void 0===s?void 0:s.UserId)||(null===(a=t.userDetails)||void 0===a?void 0:a.USER_SYS_ID)||1,l={ITEM:"DELETE",TEAM_SYS_ID:e.TEAM_SYS_ID,EVENT_SYS_ID:t.selected_event_sys_id,ORGANIZATION_SYS_ID:t.organisation_sys_id,CREATED_BY:n},console.log("Removing team member:",l),r.abrupt("return",t.$apiCall.post(t.$apiBus.api_post_add_update_team,l).then((function(e){console.log("Delete response:",e);var r="string"===typeof e?JSON.parse(e):(null===e||void 0===e?void 0:e.data)||e;"true"===(null===r||void 0===r?void 0:r.status)?(c["a"].showSuccessAlert(!0,"success","Team member removed successfully"),t.getViewTeamListInfo()):c["a"].showErrorAlert(!0,"error",r.response||"Failed to remove team member")})).catch((function(e){console.error("Delete failed:",e),c["a"].showErrorAlert(!0,"error","Failed to remove team member")})).finally((function(){t.doneProgress()})));case 13:r.prev=13,r.t0=r["catch"](0),console.error("Delete confirmation error:",r.t0);case 16:case"end":return r.stop()}}),r,null,[[0,13]])})))()},getValidationState:function(e){var t=e.dirty,r=e.validated,s=e.valid;return t||r?s:null}}},u=_,m=(r("67d8"),r("2877")),E=Object(m["a"])(u,s,a,!1,null,"82cf5f5a",null);t["default"]=E.exports},ff09:function(e,t,r){}}]);