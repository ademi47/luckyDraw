(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9f6400f4"],{"1d98":function(e,t,n){},"4a98":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e._self._c;return t("div",[t("b-card",[t("div",{staticClass:"d-flex",staticStyle:{"justify-content":"space-between","align-items":"center"}},[t("h4",[e._v("Registration List")]),t("div",[t("button",{staticClass:"btn btn-success",attrs:{disabled:0===e.register_list_details.length},on:{click:e.downloadAllBadges}},[t("i",{staticClass:"fas fa-download mr-2"}),e._v("Download All Badges ")])])]),t("div",{staticClass:"table-responsive mt-3"},[t("b-table",{staticClass:"cursor-pointer",attrs:{"head-variant":"light",bordered:"",hover:"",fields:e.registration_fields,items:e.register_list_details,"show-empty":""},scopedSlots:e._u([{key:"head(index)",fn:function(){return[t("div",{staticClass:"text-center"},[e._v("S/N")])]},proxy:!0},{key:"cell(index)",fn:function(n){return[t("div",{staticClass:"text-center"},[e._v(e._s(n.index+1))])]}},{key:"cell(QR_CODE)",fn:function(n){return[t("div",{staticClass:"text-center"},[n.item.REGISTRATION_QR_CODE?t("VueQRCodeComponent",{attrs:{text:n.item.REGISTRATION_QR_CODE,size:50,level:"H"}}):t("div",{staticClass:"text-muted"},[e._v("No QR")])],1)]}},{key:"cell(actions)",fn:function(n){return[t("div",{staticClass:"text-center"},[t("b-button",{staticClass:"mr-2",attrs:{size:"sm",variant:"primary",title:"Print Badge"},on:{click:function(t){return e.openPrintBadge(n.item)}}},[t("i",{staticClass:"fas fa-print"})]),t("b-button",{attrs:{size:"sm",variant:"success",title:"Download Badge"},on:{click:function(t){return e.downloadBadge(n.item)}}},[t("i",{staticClass:"fas fa-download"})])],1)]}}])})],1)]),t("div",{staticStyle:{display:"none"}},[t("VueQRCodeComponent",{ref:"qrCode",attrs:{text:e.selectedUserQRText,size:100,level:"H"}})],1),t("vue-html2pdf",{ref:"html2PdfSingleBadge",staticStyle:{display:"none"},attrs:{"show-layout":!1,"float-layout":!0,"enable-download":!0,"preview-modal":!1,filename:"Badge_".concat(e.selectedUser?e.selectedUser.PERSON_NAME:""),"pdf-quality":2,"pdf-format":"a4","pdf-orientation":"portrait"}},[t("section",{staticStyle:{display:"flex","justify-content":"center","align-items":"center",height:"100vh"},attrs:{slot:"pdf-content"},slot:"pdf-content"},[t("div",{domProps:{innerHTML:e._s(e.badgeHtmlContent)}})])]),t("vue-html2pdf",{ref:"html2PdfAllBadges",staticStyle:{display:"none"},attrs:{"show-layout":!1,"float-layout":!0,"enable-download":!0,"preview-modal":!1,filename:"All_Badges","pdf-quality":2,"manual-pagination":!0,"pdf-format":"a4","pdf-orientation":"portrait"}},[t("section",{attrs:{slot:"pdf-content"},slot:"pdf-content"},[t("div",{staticClass:"badge-grid"},e._l(e.allBadgesHtmlContent,(function(n,a){return t("div",{key:a,staticClass:"badge-wrapper"},[t("div",{domProps:{innerHTML:e._s(n)}})])})),0)])])],1)},r=[],i=n("c7eb"),s=n("1da1"),o=(n("e9c4"),n("99af"),n("d81d"),n("d3b7"),n("3ca3"),n("ddb0"),n("471e")),c=n("323e"),d=n.n(c),l=n("dfcf"),g=n("6480"),f=n("d055"),u=n.n(f),p={components:{VueQRCodeComponent:l["a"],VueHtml2pdf:g["a"]},data:function(){return{registration_fields:[{key:"index",label:"S/N",thClass:"text-center",tdClass:"text-center"},{key:"PERSON_NAME",label:"Name"},{key:"DESIGNATION",label:"Designation"},{key:"COMPANY_NAME",label:"Company Name"},{key:"PERSON_EMAIL",label:"Email"},{key:"QR_CODE",label:"QR Code",thClass:"text-center"},{key:"actions",label:"Actions",thClass:"text-center"}],register_list_details:[],event_sys_id:null,user_sys_id:null,selectedUser:null,selectedUserQRText:"",badgeConfig:null,badgeHtmlContent:"",allBadgesHtmlContent:[],printBadgeCache:{}}},mounted:function(){this.event_sys_id=JSON.parse(localStorage.getItem("selectedEventSysId"));var e=JSON.parse(localStorage.getItem("userInfo"));this.user_sys_id=(null===e||void 0===e?void 0:e.user_id)||1,this.loadPrintBadgeCache(),this.getregestartionlist()},methods:{getregestartionlist:function(){var e=this;return Object(s["a"])(Object(i["a"])().mark((function t(){var n;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.event_sys_id){t.next=3;break}return o["a"].showErrorAlert(!0,"error","Event ID is missing. Cannot fetch data."),t.abrupt("return");case 3:return d.a.start(),t.prev=4,t.next=7,e.$apiCall.get(e.$apiBus.api_get_regestrations,{params:{ITEM:"VIEW_ALL",EVENT_SYS_ID:e.event_sys_id}});case 7:n=t.sent,n&&"true"===n.status&&Array.isArray(n.response)?e.register_list_details=n.response:(e.register_list_details=[],o["a"].showErrorAlert(!0,"error",n.response||"Failed to fetch registration list.")),t.next=15;break;case 11:t.prev=11,t.t0=t["catch"](4),e.register_list_details=[],o["a"].showErrorAlert(!0,"error","A network error occurred while fetching data.");case 15:return t.prev=15,d.a.done(),t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[4,11,15,18]])})))()},loadPrintBadgeCache:function(){try{var e=localStorage.getItem("printBadgeCache");e&&(this.printBadgeCache=JSON.parse(e))}catch(t){console.error("Error loading print badge cache:",t)}},savePrintBadgeCache:function(){try{localStorage.setItem("printBadgeCache",JSON.stringify(this.printBadgeCache))}catch(e){console.error("Error saving print badge cache:",e)}},getBadgeConfig:function(){var e=this;return Object(s["a"])(Object(i["a"])().mark((function t(){var n;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.badgeConfig){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,e.$apiCall.get(e.$apiBus.api_get_view_badges,{params:{ITEM:"VIEW_ALL",EVENT_SYS_ID:e.event_sys_id}});case 5:n=t.sent,"true"===n.status&&n.response.length>0&&(e.badgeConfig=n.response[0]),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](2),console.error("Error fetching badge config:",t.t0);case 12:case"end":return t.stop()}}),t,null,[[2,9]])})))()},generateBadgeHtml:function(e,t){if(!this.badgeConfig)return"<div>Badge configuration is missing.</div>";var n="";1==this.badgeConfig.QR_CODE&&t&&(n='\n          <div style="margin-bottom: '.concat(this.badgeConfig.QR_STATIC_GAP||12,'px; margin-top:5px;">\n            <img src="').concat(t,'" style="width:90px; height:90px; border:1px solid #ddd; border-radius:4px; background:white;"/>\n          </div>'));var a="";return 1==this.badgeConfig.PERSON_NAME&&e.PERSON_NAME&&"0"!==e.PERSON_NAME&&0!==e.PERSON_NAME&&(a+='<div class="person-name">'.concat(e.PERSON_NAME,"</div>")),1==this.badgeConfig.DESIGNATION&&e.DESIGNATION&&"0"!==e.DESIGNATION&&0!==e.DESIGNATION&&(a+='<div class="designation">'.concat(e.DESIGNATION,"</div>")),1==this.badgeConfig.COMPANY_NAME&&e.COMPANY_NAME&&"0"!==e.COMPANY_NAME&&0!==e.COMPANY_NAME&&(a+='<div class="company-name">'.concat(e.COMPANY_NAME,"</div>")),1==this.badgeConfig.TABLE_NUMBER&&e.TABLE_NO&&"0"!==e.TABLE_NO&&0!==e.TABLE_NO&&(a+='<div class="other-info">Table No: '.concat(e.TABLE_NO,"</div>")),1==this.badgeConfig.TICKET_ID&&e.TICKET_ID&&"0"!==e.TICKET_ID&&0!==e.TICKET_ID&&(a+='<div class="other-info">Ticket ID: '.concat(e.TICKET_ID,"</div>")),'\n        <div style="'.concat(this.getBadgeContainerStyles(),'">\n          ').concat(1==this.badgeConfig.NEED_HEADER?'<div style="'.concat(this.getBadgeHeaderStyles(),'">').concat(this.badgeConfig.HEADER_TEXT||"","</div>"):"",'\n          <div style="flex:1; display:flex; flex-direction:column; justify-content:flex-start; align-items:center; padding:8px; text-align:center;">\n            ').concat(n,'\n            <div style="width:100%; flex:1; display:flex; flex-direction:column; justify-content:center; align-items:center;">\n              <div style="width:100%; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:2px;">\n                ').concat(a||'<div class="other-info" style="text-align:center; font-style:italic;">No information available</div>',"\n              </div>\n            </div>\n          </div>\n          ").concat(1==this.badgeConfig.NEED_FOOTER?'<div style="'.concat(this.getBadgeFooterStyles(),'">').concat(this.badgeConfig.FOOTER_TEXT||"","</div>"):"","\n        </div>")},openPrintBadge:function(e){var t=this;return Object(s["a"])(Object(i["a"])().mark((function n(){return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.REGISTRATION_QR_CODE){n.next=3;break}return o["a"].showErrorAlert(!0,"error","QR Code not available for this registration."),n.abrupt("return");case 3:return t.selectedUser=e,t.selectedUserQRText=e.REGISTRATION_QR_CODE,n.next=7,t.getBadgeConfig();case 7:t.$nextTick((function(){var n=t.$refs.qrCode;if(n&&n.$el){var a=n.$el.querySelector("canvas");if(a){var r=a.toDataURL();t.printQRCode(t.generateBadgeHtml(e,r))}}}));case 8:case"end":return n.stop()}}),n)})))()},downloadBadge:function(e){var t=this;return Object(s["a"])(Object(i["a"])().mark((function n(){return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.REGISTRATION_QR_CODE){n.next=3;break}return o["a"].showErrorAlert(!0,"error","QR Code not available for this registration."),n.abrupt("return");case 3:return d.a.start(),t.selectedUser=e,t.selectedUserQRText=e.REGISTRATION_QR_CODE,n.next=8,t.getBadgeConfig();case 8:t.$nextTick((function(){var n=t.$refs.qrCode;if(n&&n.$el){var a=n.$el.querySelector("canvas");if(a){var r=a.toDataURL();t.badgeHtmlContent=t.generateBadgeHtml(e,r),t.$nextTick((function(){t.$refs.html2PdfSingleBadge.generatePdf(),t.updatePrintBadgeStatus(),d.a.done()}))}else d.a.done()}else d.a.done()}));case 9:case"end":return n.stop()}}),n)})))()},prepareAllBadgesForDownload:function(){var e=this;return Object(s["a"])(Object(i["a"])().mark((function t(){var n;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return d.a.start(),n=e.register_list_details.map(function(){var t=Object(s["a"])(Object(i["a"])().mark((function t(n){var a;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n.REGISTRATION_QR_CODE){t.next=2;break}return t.abrupt("return",e.generateBadgeHtml(n,null));case 2:return t.next=4,u.a.toDataURL(n.REGISTRATION_QR_CODE,{errorCorrectionLevel:"H",width:100});case 4:return a=t.sent,t.abrupt("return",e.generateBadgeHtml(n,a));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.next=4,Promise.all(n);case 4:e.allBadgesHtmlContent=t.sent,d.a.done();case 6:case"end":return t.stop()}}),t)})))()},downloadAllBadges:function(){var e=this;return Object(s["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0!==e.register_list_details.length){t.next=3;break}return o["a"].showErrorAlert(!0,"error","No badges to download."),t.abrupt("return");case 3:return t.next=5,e.getBadgeConfig();case 5:return t.next=7,e.prepareAllBadgesForDownload();case 7:e.$nextTick((function(){e.$refs.html2PdfAllBadges.generatePdf()}));case 8:case"end":return t.stop()}}),t)})))()},printQRCode:function(e){var t=window.open("","_blank");t.document.write("\n        <html>\n          <head>\n            <title>Print Badge</title>\n            <style>\n              body { margin: 0; padding: 20px; display: flex; justify-content: center; align-items: center; }\n              @media print { body { padding: 0; } .badge-container { box-shadow: none; page-break-inside: avoid; } }\n              ".concat(this.getBadgeStyles(),"\n            </style>\n          </head>\n          <body>").concat(e,"</body>\n        </html>")),t.document.close(),t.focus(),t.onafterprint=function(){return t.close()},t.print(),this.updatePrintBadgeStatus()},updatePrintBadgeStatus:function(){var e=this;return Object(s["a"])(Object(i["a"])().mark((function t(){var n;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.selectedUser){t.next=2;break}return t.abrupt("return");case 2:return n=e.selectedUser.REGISTRATION_SYS_ID,e.$set(e.printBadgeCache,n,1),e.savePrintBadgeCache(),t.prev=5,t.next=8,e.$apiCall.post(e.$apiBus.api_post_add_update_regestrations,{ITEM:"UPDATE_PRINT_BADGE",REGISTRATION_SYS_ID:n,PRINT_BADGE_FLAG:1,CREATED_BY:e.user_sys_id});case 8:t.next=15;break;case 10:t.prev=10,t.t0=t["catch"](5),console.error("Failed to update print status:",t.t0),e.$set(e.printBadgeCache,n,0),e.savePrintBadgeCache();case 15:case"end":return t.stop()}}),t,null,[[5,10]])})))()},getBadgeStyles:function(){return"\n        .person-name { font-size: 14px; font-weight: bold; color: #000; text-transform: uppercase; margin: 2px 0; }\n        .designation { font-size: 11px; font-weight: 600; color: #333; text-transform: uppercase; margin: 1px 0; }\n        .company-name { font-size: 9px; font-weight: 500; color: #555; text-transform: uppercase; margin: 1px 0; }\n        .other-info { font-size: 10px; color: #666; margin: 1px 0; }"},getBadgeContainerStyles:function(){return this.badgeConfig?"width:".concat(this.badgeConfig.BADGE_WIDTH||400,"px; height:").concat(this.badgeConfig.BADGE_HEIGHT||600,"px; border:2px solid #000; border-radius:12px; display:flex; flex-direction:column; background:").concat(this.badgeConfig.BADGE_BACKGROUND_IMAGE?"url(".concat(this.badgeConfig.BADGE_BACKGROUND_IMAGE,") no-repeat center/cover"):this.badgeConfig.BADGE_BACKGROUND||"#fff","; font-family:'Arial', sans-serif; position:relative; overflow:hidden;"):""},getBadgeHeaderStyles:function(){return this.badgeConfig?"height:".concat(this.badgeConfig.HEADER_HEIGHT||0,"px; background:").concat(this.badgeConfig.HEADER_BACKGROUND_IMAGE?"url(".concat(this.badgeConfig.HEADER_BACKGROUND_IMAGE,") no-repeat center/cover"):this.badgeConfig.HEADER_BACKGROUND||"#f0f0f0","; display:flex; align-items:center; justify-content:center; color:#333;"):""},getBadgeFooterStyles:function(){return this.badgeConfig?"height:".concat(this.badgeConfig.FOOTER_HEIGHT||0,"px; background:").concat(this.badgeConfig.FOOTER_BACKGROUND_IMAGE?"url(".concat(this.badgeConfig.FOOTER_BACKGROUND_IMAGE,") no-repeat center/cover"):this.badgeConfig.FOOTER_BACKGROUND||"#f0f0f0","; display:flex; align-items:center; justify-content:center; color:#333;"):""}}},h=p,_=(n("4e37"),n("df83"),n("2877")),b=Object(_["a"])(h,a,r,!1,null,"15220814",null);t["default"]=b.exports},"4e37":function(e,t,n){"use strict";n("1d98")},8699:function(e,t,n){},df83:function(e,t,n){"use strict";n("8699")}}]);