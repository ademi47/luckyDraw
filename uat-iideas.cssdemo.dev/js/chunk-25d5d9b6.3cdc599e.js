(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-25d5d9b6"],{"129f":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},"1b72":function(t,e,a){"use strict";a("6931")},2689:function(t,e,a){"use strict";a("f1b8")},"344e":function(t,e,a){"use strict";a("a5c8")},"34fd":function(t,e,a){"use strict";a("95c8")},"3c58":function(t,e,a){"use strict";a("a960")},"437a":function(t,e,a){},"498a":function(t,e,a){"use strict";var i=a("23e7"),r=a("58a8").trim,n=a("c8d2");i({target:"String",proto:!0,forced:n("trim")},{trim:function(){return r(this)}})},"4f40":function(t,e,a){"use strict";a("64df")},"50e0":function(t,e,a){"use strict";a("8340")},5352:function(t,e,a){"use strict";a("e260");var i=a("23e7"),r=a("da84"),n=a("c65b"),s=a("e330"),l=a("83ab"),o=a("f354"),c=a("cb2d"),u=a("edd0"),d=a("6964"),p=a("d44e"),_=a("dcc3"),v=a("69f3"),f=a("19aa"),h=a("1626"),m=a("1a2d"),b=a("0366"),D=a("f5df"),P=a("825a"),E=a("861d"),I=a("577e"),w=a("7c73"),C=a("5c6c"),N=a("9a1f"),A=a("35a1"),T=a("d6d6"),g=a("b622"),R=a("addb"),y=g("iterator"),S="URLSearchParams",L=S+"Iterator",O=v.set,k=v.getterFor(S),x=v.getterFor(L),W=Object.getOwnPropertyDescriptor,M=function(t){if(!l)return r[t];var e=W(r,t);return e&&e.value},z=M("fetch"),Y=M("Request"),U=M("Headers"),F=Y&&Y.prototype,B=U&&U.prototype,j=r.RegExp,V=r.TypeError,$=r.decodeURIComponent,K=r.encodeURIComponent,Z=s("".charAt),G=s([].join),H=s([].push),X=s("".replace),J=s([].shift),q=s([].splice),Q=s("".split),tt=s("".slice),et=/\+/g,at=Array(4),it=function(t){return at[t-1]||(at[t-1]=j("((?:%[\\da-f]{2}){"+t+"})","gi"))},rt=function(t){try{return $(t)}catch(e){return t}},nt=function(t){var e=X(t,et," "),a=4;try{return $(e)}catch(i){while(a)e=X(e,it(a--),rt);return e}},st=/[!'()~]|%20/g,lt={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},ot=function(t){return lt[t]},ct=function(t){return X(K(t),st,ot)},ut=_((function(t,e){O(this,{type:L,iterator:N(k(t).entries),kind:e})}),"Iterator",(function(){var t=x(this),e=t.kind,a=t.iterator.next(),i=a.value;return a.done||(a.value="keys"===e?i.key:"values"===e?i.value:[i.key,i.value]),a}),!0),dt=function(t){this.entries=[],this.url=null,void 0!==t&&(E(t)?this.parseObject(t):this.parseQuery("string"==typeof t?"?"===Z(t,0)?tt(t,1):t:I(t)))};dt.prototype={type:S,bindURL:function(t){this.url=t,this.update()},parseObject:function(t){var e,a,i,r,s,l,o,c=A(t);if(c){e=N(t,c),a=e.next;while(!(i=n(a,e)).done){if(r=N(P(i.value)),s=r.next,(l=n(s,r)).done||(o=n(s,r)).done||!n(s,r).done)throw V("Expected sequence with length 2");H(this.entries,{key:I(l.value),value:I(o.value)})}}else for(var u in t)m(t,u)&&H(this.entries,{key:u,value:I(t[u])})},parseQuery:function(t){if(t){var e,a,i=Q(t,"&"),r=0;while(r<i.length)e=i[r++],e.length&&(a=Q(e,"="),H(this.entries,{key:nt(J(a)),value:nt(G(a,"="))}))}},serialize:function(){var t,e=this.entries,a=[],i=0;while(i<e.length)t=e[i++],H(a,ct(t.key)+"="+ct(t.value));return G(a,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var pt=function(){f(this,_t);var t=arguments.length>0?arguments[0]:void 0,e=O(this,new dt(t));l||(this.length=e.entries.length)},_t=pt.prototype;if(d(_t,{append:function(t,e){T(arguments.length,2);var a=k(this);H(a.entries,{key:I(t),value:I(e)}),l||this.length++,a.updateURL()},delete:function(t){T(arguments.length,1);var e=k(this),a=e.entries,i=I(t),r=0;while(r<a.length)a[r].key===i?q(a,r,1):r++;l||(this.length=a.length),e.updateURL()},get:function(t){T(arguments.length,1);for(var e=k(this).entries,a=I(t),i=0;i<e.length;i++)if(e[i].key===a)return e[i].value;return null},getAll:function(t){T(arguments.length,1);for(var e=k(this).entries,a=I(t),i=[],r=0;r<e.length;r++)e[r].key===a&&H(i,e[r].value);return i},has:function(t){T(arguments.length,1);var e=k(this).entries,a=I(t),i=0;while(i<e.length)if(e[i++].key===a)return!0;return!1},set:function(t,e){T(arguments.length,1);for(var a,i=k(this),r=i.entries,n=!1,s=I(t),o=I(e),c=0;c<r.length;c++)a=r[c],a.key===s&&(n?q(r,c--,1):(n=!0,a.value=o));n||H(r,{key:s,value:o}),l||(this.length=r.length),i.updateURL()},sort:function(){var t=k(this);R(t.entries,(function(t,e){return t.key>e.key?1:-1})),t.updateURL()},forEach:function(t){var e,a=k(this).entries,i=b(t,arguments.length>1?arguments[1]:void 0),r=0;while(r<a.length)e=a[r++],i(e.value,e.key,this)},keys:function(){return new ut(this,"keys")},values:function(){return new ut(this,"values")},entries:function(){return new ut(this,"entries")}},{enumerable:!0}),c(_t,y,_t.entries,{name:"entries"}),c(_t,"toString",(function(){return k(this).serialize()}),{enumerable:!0}),l&&u(_t,"size",{get:function(){return k(this).entries.length},configurable:!0,enumerable:!0}),p(pt,S),i({global:!0,constructor:!0,forced:!o},{URLSearchParams:pt}),!o&&h(U)){var vt=s(B.has),ft=s(B.set),ht=function(t){if(E(t)){var e,a=t.body;if(D(a)===S)return e=t.headers?new U(t.headers):new U,vt(e,"content-type")||ft(e,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),w(t,{body:C(0,I(a)),headers:C(0,e)})}return t};if(h(z)&&i({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(t){return z(t,arguments.length>1?ht(arguments[1]):{})}}),h(Y)){var mt=function(t){return f(this,F),new Y(t,arguments.length>1?ht(arguments[1]):{})};F.constructor=mt,mt.prototype=F,i({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:mt})}}t.exports={URLSearchParams:pt,getState:k}},"64df":function(t,e,a){},6931:function(t,e,a){},"6be4":function(t,e,a){"use strict";a("db35")},"7db0":function(t,e,a){"use strict";var i=a("23e7"),r=a("b727").find,n=a("44d2"),s="find",l=!0;s in[]&&Array(1)[s]((function(){l=!1})),i({target:"Array",proto:!0,forced:l},{find:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(s)},8112:function(t,e,a){"use strict";a("be37")},8340:function(t,e,a){},"841c":function(t,e,a){"use strict";var i=a("c65b"),r=a("d784"),n=a("825a"),s=a("7234"),l=a("1d80"),o=a("129f"),c=a("577e"),u=a("dc4a"),d=a("14c3");r("search",(function(t,e,a){return[function(e){var a=l(this),r=s(e)?void 0:u(e,t);return r?i(r,e,a):new RegExp(e)[t](c(a))},function(t){var i=n(this),r=c(t),s=a(e,i,r);if(s.done)return s.value;var l=i.lastIndex;o(l,0)||(i.lastIndex=0);var u=d(i,r);return o(i.lastIndex,l)||(i.lastIndex=l),null===u?-1:u.index}]}))},9129:function(t,e,a){var i=a("23e7");i({target:"Number",stat:!0},{isNaN:function(t){return t!=t}})},"95c8":function(t,e,a){},"95cd":function(t,e,a){t.exports=a.p+"img/loader.85135c1c.gif"},9764:function(t,e,a){},9861:function(t,e,a){a("5352")},"9e79":function(t,e,a){"use strict";a("a608")},a434:function(t,e,a){"use strict";var i=a("23e7"),r=a("7b0b"),n=a("23cb"),s=a("5926"),l=a("07fa"),o=a("3a34"),c=a("3511"),u=a("65f0"),d=a("8418"),p=a("083a"),_=a("1dde"),v=_("splice"),f=Math.max,h=Math.min;i({target:"Array",proto:!0,forced:!v},{splice:function(t,e){var a,i,_,v,m,b,D=r(this),P=l(D),E=n(t,P),I=arguments.length;for(0===I?a=i=0:1===I?(a=0,i=P-E):(a=I-2,i=h(f(s(e),0),P-E)),c(P+a-i),_=u(D,i),v=0;v<i;v++)m=E+v,m in D&&d(_,v,D[m]);if(_.length=i,a<i){for(v=E;v<P-i;v++)m=v+i,b=v+a,m in D?D[b]=D[m]:p(D,b);for(v=P;v>P-i+a;v--)p(D,v-1)}else if(a>i)for(v=P-i;v>E;v--)m=v+i-1,b=v+a-1,m in D?D[b]=D[m]:p(D,b);for(v=0;v<a;v++)D[v+E]=arguments[v+2];return o(D,P-i+a),_}})},a5c8:function(t,e,a){},a608:function(t,e,a){},a960:function(t,e,a){},b85c:function(t,e,a){"use strict";a.d(e,"a",(function(){return r}));a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0"),a("d9e2");var i=a("06c5");function r(t,e){var a="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=Object(i["a"])(t))||e&&t&&"number"===typeof t.length){a&&(t=a);var r=0,n=function(){};return{s:n,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,l=!0,o=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return l=t.done,t},e:function(t){o=!0,s=t},f:function(){try{l||null==a["return"]||a["return"]()}finally{if(o)throw s}}}}},be37:function(t,e,a){},c228:function(t,e,a){"use strict";a("f4e8")},c8d2:function(t,e,a){var i=a("5e77").PROPER,r=a("d039"),n=a("5899"),s="​᠎";t.exports=function(t){return r((function(){return!!n[t]()||s[t]()!==s||i&&n[t].name!==t}))}},cb04:function(t,e,a){"use strict";a("9764")},d2ca2:function(t,e,a){"use strict";a.r(e);a("99af"),a("fb6a"),a("4de4"),a("d3b7"),a("b0c0"),a("a4d3"),a("e01a");var i,r,n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"participant-container"},[t.isLoading?e("div",[t._m(0)]):t._e(),e("b-card",[e("div",[e("b-tabs",{staticClass:"mt-3"},[e("b-tab",{attrs:{title:"Settings",lazy:""}},[e("div",{staticClass:"p-3"},[e("div",{staticClass:"row"}),e("b-card",{staticClass:"mb-4"},[e("h4",{staticClass:"mb-3"},[t._v("Lucky Draw ")]),e("div",{staticClass:"mb-4"},[e("div",{staticClass:"form-check mb-2"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.liveDraw.enabled,expression:"liveDraw.enabled"}],staticClass:"form-check-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.liveDraw.enabled)?t._i(t.liveDraw.enabled,null)>-1:t.liveDraw.enabled},on:{change:[function(e){var a=t.liveDraw.enabled,i=e.target,r=!!i.checked;if(Array.isArray(a)){var n=null,s=t._i(a,n);i.checked?s<0&&t.$set(t.liveDraw,"enabled",a.concat([n])):s>-1&&t.$set(t.liveDraw,"enabled",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.liveDraw,"enabled",r)},t.saveControlPanelSettings]}}),e("label",{staticClass:"form-check-label"},[e("strong",[t._v("Live ")])])]),t.liveDraw.enabled?e("div",{staticClass:"live-draw-row d-flex flex-wrap gap-3 mt-3"},[e("div",{staticClass:"flex-fill"},[e("label",{staticClass:"form-label",attrs:{for:"liveFromNumber"}},[t._v("From Number")]),e("b-form-input",{staticClass:"form-control",attrs:{id:"liveFromNumber",type:"number",placeholder:"Enter number"},on:{blur:t.saveControlPanelSettings},model:{value:t.liveDraw.fromNumber,callback:function(e){t.$set(t.liveDraw,"fromNumber",e)},expression:"liveDraw.fromNumber"}})],1),e("div",{staticClass:"flex-fill"},[e("label",{staticClass:"form-label",attrs:{for:"liveToNumber"}},[t._v("To Number")]),e("b-form-input",{staticClass:"form-control",attrs:{id:"liveToNumber",type:"number",placeholder:"Enter number"},on:{blur:t.saveControlPanelSettings},model:{value:t.liveDraw.toNumber,callback:function(e){t.$set(t.liveDraw,"toNumber",e)},expression:"liveDraw.toNumber"}})],1)]):t._e()]),e("div",{staticClass:"mb-4"},[e("div",{staticClass:"form-check mb-2"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.preLiveDraw.enabled,expression:"preLiveDraw.enabled"}],staticClass:"form-check-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.preLiveDraw.enabled)?t._i(t.preLiveDraw.enabled,null)>-1:t.preLiveDraw.enabled},on:{change:[function(e){var a=t.preLiveDraw.enabled,i=e.target,r=!!i.checked;if(Array.isArray(a)){var n=null,s=t._i(a,n);i.checked?s<0&&t.$set(t.preLiveDraw,"enabled",a.concat([n])):s>-1&&t.$set(t.preLiveDraw,"enabled",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.preLiveDraw,"enabled",r)},t.saveControlPanelSettings]}}),e("label",{staticClass:"form-check-label"},[e("strong",[t._v("Pre-Live ")])])]),t.preLiveDraw.enabled?e("div",{staticClass:"prelive-draw-section mt-3"},[e("div",{staticClass:"d-flex flex-wrap gap-3"},[e("div",{staticClass:"flex-fill"},[e("label",{staticClass:"form-label",attrs:{for:"preLiveFromNumber"}},[t._v("From Number")]),e("b-form-input",{staticClass:"form-control",attrs:{id:"preLiveFromNumber",type:"number",placeholder:"Enter number"},on:{blur:t.saveControlPanelSettings},model:{value:t.preLiveDraw.fromNumber,callback:function(e){t.$set(t.preLiveDraw,"fromNumber",e)},expression:"preLiveDraw.fromNumber"}})],1),e("div",{staticClass:"flex-fill"},[e("label",{staticClass:"form-label",attrs:{for:"preLiveToNumber"}},[t._v("To Number")]),e("b-form-input",{staticClass:"form-control",attrs:{id:"preLiveToNumber",type:"number",placeholder:"Enter number"},on:{blur:t.saveControlPanelSettings},model:{value:t.preLiveDraw.toNumber,callback:function(e){t.$set(t.preLiveDraw,"toNumber",e)},expression:"preLiveDraw.toNumber"}})],1),e("div",{staticClass:"flex-fill"},[e("label",{staticClass:"form-label",attrs:{for:"preLivePrizePosition"}},[t._v("Winner Per Slide")]),e("b-form-input",{staticClass:"form-control",attrs:{id:"preLivePrizePosition",type:"number",placeholder:"Enter number"},on:{blur:t.saveControlPanelSettings},model:{value:t.preLiveDraw.prizePositions,callback:function(e){t.$set(t.preLiveDraw,"prizePositions",e)},expression:"preLiveDraw.prizePositions"}})],1)])]):t._e()]),e("div",{staticClass:"mb-4"},[e("div",{staticClass:"form-check mb-2"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.preDraw.enabled,expression:"preDraw.enabled"}],staticClass:"form-check-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.preDraw.enabled)?t._i(t.preDraw.enabled,null)>-1:t.preDraw.enabled},on:{change:[function(e){var a=t.preDraw.enabled,i=e.target,r=!!i.checked;if(Array.isArray(a)){var n=null,s=t._i(a,n);i.checked?s<0&&t.$set(t.preDraw,"enabled",a.concat([n])):s>-1&&t.$set(t.preDraw,"enabled",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.preDraw,"enabled",r)},t.saveControlPanelSettings]}}),e("label",{staticClass:"form-check-label"},[e("strong",[t._v("Pre Draw")])])]),t.preDraw.enabled?e("div",{staticClass:"prelive-draw-section mt-3"},[e("div",{staticClass:"d-flex flex-wrap gap-3"},[e("div",{staticClass:"flex-fill"},[e("label",{staticClass:"form-label",attrs:{for:"preDrawFromNumber"}},[t._v("From Number")]),e("b-form-input",{staticClass:"form-control",attrs:{id:"preDrawFromNumber",type:"number",placeholder:"Enter number"},on:{blur:t.saveControlPanelSettings},model:{value:t.preDraw.fromNumber,callback:function(e){t.$set(t.preDraw,"fromNumber",e)},expression:"preDraw.fromNumber"}})],1),e("div",{staticClass:"flex-fill"},[e("label",{staticClass:"form-label",attrs:{for:"preDrawToNumber"}},[t._v("To Number")]),e("b-form-input",{staticClass:"form-control",attrs:{id:"preDrawToNumber",type:"number",placeholder:"Enter number"},on:{blur:t.saveControlPanelSettings},model:{value:t.preDraw.toNumber,callback:function(e){t.$set(t.preDraw,"toNumber",e)},expression:"preDraw.toNumber"}})],1),e("div",{staticClass:"flex-fill"},[e("label",{staticClass:"form-label",attrs:{for:"preDrawPrizePosition"}},[t._v("Winner Per Slide")]),e("b-form-input",{staticClass:"form-control",attrs:{id:"preDrawPrizePosition",type:"number",placeholder:"Enter number"},on:{blur:t.saveControlPanelSettings},model:{value:t.preDraw.prizePositions,callback:function(e){t.$set(t.preDraw,"prizePositions",e)},expression:"preDraw.prizePositions"}})],1)])]):t._e()])]),e("b-card",[e("h4",{staticClass:"mb-3"},[t._v("Special Draw ")]),e("div",{staticClass:"mb-4"},[e("div",{staticClass:"form-check mb-2"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.earlyBird.enabled,expression:"earlyBird.enabled"}],staticClass:"form-check-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.earlyBird.enabled)?t._i(t.earlyBird.enabled,null)>-1:t.earlyBird.enabled},on:{change:[function(e){var a=t.earlyBird.enabled,i=e.target,r=!!i.checked;if(Array.isArray(a)){var n=null,s=t._i(a,n);i.checked?s<0&&t.$set(t.earlyBird,"enabled",a.concat([n])):s>-1&&t.$set(t.earlyBird,"enabled",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.earlyBird,"enabled",r)},t.saveControlPanelSettings]}}),e("label",{staticClass:"form-check-label"},[e("strong",[t._v("Early Bird")])])]),t.earlyBird.enabled?e("div",{staticClass:"prelive-draw-section mt-3"},[e("div",{staticClass:"d-flex flex-wrap gap-3"},[e("div",{staticClass:"flex-fill"},[e("label",{staticClass:"form-label",attrs:{for:"earlyBirdFromNumber"}},[t._v("From Number")]),e("b-form-input",{staticClass:"form-control",attrs:{id:"earlyBirdFromNumber",type:"number",placeholder:"Enter number"},on:{blur:t.saveControlPanelSettings},model:{value:t.earlyBird.fromNumber,callback:function(e){t.$set(t.earlyBird,"fromNumber",e)},expression:"earlyBird.fromNumber"}})],1),e("div",{staticClass:"flex-fill"},[e("label",{staticClass:"form-label",attrs:{for:"earlyBirdToNumber"}},[t._v("To Number")]),e("b-form-input",{staticClass:"form-control",attrs:{id:"earlyBirdToNumber",type:"number",placeholder:"Enter number"},on:{blur:t.saveControlPanelSettings},model:{value:t.earlyBird.toNumber,callback:function(e){t.$set(t.earlyBird,"toNumber",e)},expression:"earlyBird.toNumber"}})],1),e("div",{staticClass:"flex-fill"},[e("label",{staticClass:"form-label",attrs:{for:"earlyBirdPrizePosition"}},[t._v("Winner Per Slide")]),e("b-form-input",{staticClass:"form-control",attrs:{id:"earlyBirdPrizePosition",type:"number",placeholder:"Enter number"},on:{blur:t.saveControlPanelSettings},model:{value:t.earlyBird.prizePositions,callback:function(e){t.$set(t.earlyBird,"prizePositions",e)},expression:"earlyBird.prizePositions"}})],1)])]):t._e()])])],1)]),e("b-tab",{attrs:{title:"Trigger",active:"",lazy:""},on:{click:t.onWinnersTabClick}},[e("b-card",[e("div",{staticClass:"row"}),e("div",{staticClass:"draw-wrapper"},[e("div",{staticClass:"draw-left"},[e("label",{staticClass:"font-weight-bold mb-2"},[t._v(" Draw Type")]),e("b-form-select",{on:{change:t.onLiveDrawTypeChange},model:{value:t.selectedLiveDrawType,callback:function(e){t.selectedLiveDrawType=e},expression:"selectedLiveDrawType"}},[e("b-form-select-option",{attrs:{value:"LUCKY_DRAW"}},[t._v("Lucky Draw")])],1)],1),"LUCKY_DRAW"===t.selectedLiveDrawType?e("div",{staticClass:"draw-right"},[e("label",{staticClass:"font-weight-bold mb-2"},[t._v("Select Lucky Draw Type")]),e("div",{staticClass:"draw-type-cards"},[e("div",{staticClass:"draw-card",class:{active:"LIVE"===t.selectedLuckyDrawSubType},on:{click:function(e){return t.selectLuckyType("LIVE")}}},[t._v("Live")]),e("div",{staticClass:"draw-card",class:{active:"PRE_LIVE"===t.selectedLuckyDrawSubType},on:{click:function(e){return t.selectLuckyType("PRE_LIVE")}}},[t._v("Pre-Live")]),e("div",{staticClass:"draw-card",class:{active:"PRE_DRAW"===t.selectedLuckyDrawSubType},on:{click:function(e){return t.selectLuckyType("PRE_DRAW")}}},[t._v("Pre-Draw")])])]):t._e()]),t.selectedLiveDrawType&&"LIVE"===t.selectedLuckyDrawSubType?e("div",{staticClass:"row d-flex"},[e("div",{staticClass:"col-md-6"},[e("h4",{staticClass:"mb-3"},[t._v(t._s(t.getLiveDrawTitle))]),e("p",{staticClass:"text-muted"},[t._v(t._s(t.getLiveDrawDescription))]),"LUCKY_DRAW"===t.selectedLiveDrawType&&t.canStartDraw?e("div",{staticClass:"mt-3"},[e("label",{staticClass:"font-weight-bold"},[t._v("Select Draw Order")]),e("p",{staticClass:"text-muted small"},[t._v("Before starting the event, please confirm the desired drawing approach with the customer.")]),e("div",{staticClass:"row",on:{change:t.saveDrawOrder}},[e("div",{staticClass:"col-md-12"},[e("label",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.drawOrder,expression:"drawOrder"}],staticClass:"mr-1",attrs:{type:"radio",value:"top-to-bottom"},domProps:{checked:t._q(t.drawOrder,"top-to-bottom")},on:{change:function(e){t.drawOrder="top-to-bottom"}}}),t._v(" Top to Bottom (e.g., 1st, 2nd, 3rd...) ")])]),e("div",{staticClass:"col-md-12"},[e("label",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.drawOrder,expression:"drawOrder"}],staticClass:"mr-1",attrs:{type:"radio",value:"bottom-to-top"},domProps:{checked:t._q(t.drawOrder,"bottom-to-top")},on:{change:function(e){t.drawOrder="bottom-to-top"}}}),t._v(" Bottom to Top (e.g., 10th, 9th, 8th...) ")])])])]):t._e(),e("div",{staticClass:"mt-3"},[e("b-button",{attrs:{variant:"primary",size:"lg",disabled:!t.canStartDraw},on:{click:t.startLiveDrawForWinnerAnnounced}},[e("i",{staticClass:"fas fa-play mr-2"}),t._v("Start Live Draw ")]),"LUCKY_DRAW"===t.selectedLiveDrawType&&!t.getDrawSettings.enabled&&t.selectedLuckyDrawSubType?e("small",{staticClass:"text-danger d-block mt-2"},[e("i",{staticClass:"fas fa-exclamation-triangle mr-1"}),t._v(" This draw type is not enabled. Please enable it in the Control Panel first. ")]):t._e(),"LUCKY_DRAW"!==t.selectedLiveDrawType||t.selectedLuckyDrawSubType?t._e():e("small",{staticClass:"text-warning d-block mt-2"},[e("i",{staticClass:"fas fa-info-circle mr-1"}),t._v(" Please select a Lucky Draw sub-type (Live, Pre-Live, or Pre-Draw). ")])],1)]),t.showPrizeBoxes?e("div",{staticClass:"col-md-6"},[e("div",{staticClass:"prize-ranks-container"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-6"},[e("h5",{staticClass:"font-weight-bold"},[e("i",{staticClass:"fas fa-trophy mr-2 text-warning"}),t._v("Prize Ranks ")]),e("p",{staticStyle:{color:"#fff","margin-left":"2rem !important"}},[t._v("Total Positions: "+t._s(t.totalPrizePositions))])]),e("div",{staticClass:"col-md-6"},[e("div",{staticClass:"prize-legend"},[e("div",{staticClass:"legend-item"},[e("span",{staticClass:"legend-box legend-empty"}),e("span",{staticClass:"legend-text"},[t._v("Available")])]),e("div",{staticClass:"legend-item"},[e("span",{staticClass:"legend-box legend-filled"}),e("span",{staticClass:"legend-text"},[t._v("Winner Selected")])])])])]),e("div",{staticClass:"prize-boxes-grid"},t._l(t.totalPrizePositions,(function(a){return e("div",{key:a,staticClass:"prize-box",class:{"prize-box-filled":t.isRankFilled(a)},staticStyle:{cursor:"pointer"},on:{contextmenu:function(e){return e.preventDefault(),t.openWinnerModalForPosition(a)}}},[e("div",{staticClass:"prize-rank-number"},[t._v(t._s(a))]),e("div",{staticClass:"prize-rank-label"},[t._v(t._s(t.getRankLabel(a)))])])})),0)])]):t._e()]):t.selectedLiveDrawType&&"PRE_LIVE"===t.selectedLuckyDrawSubType?e("div",[e("PreliveEvent")],1):t.selectedLiveDrawType&&"PRE_DRAW"===t.selectedLuckyDrawSubType?e("div",[e("PreDrawEvent")],1):e("div",{staticClass:"text-center py-5 text-muted"},[e("i",{staticClass:"fas fa-hand-pointer fa-3x mb-3"}),e("p",[t._v("Please select a draw type from the dropdown above to begin")])]),e("div",{staticClass:"row",staticStyle:{display:"none"}},[e("div",{class:t.showPrizeBoxes?"col-md-7":"col-md-12"},[e("div",{staticClass:"row align-items-end mb-4"},[e("div",{staticClass:"col-md-6"},[e("label",{staticClass:"font-weight-bold mb-2",attrs:{for:"liveDrawTypeDropdown"}},[t._v("Select Draw Type")]),e("b-form-select",{staticClass:"form-control",attrs:{id:"liveDrawTypeDropdown"},on:{change:t.onLiveDrawTypeChange},model:{value:t.selectedLiveDrawType,callback:function(e){t.selectedLiveDrawType=e},expression:"selectedLiveDrawType"}},[e("b-form-select-option",{attrs:{value:null}},[t._v("-- Select Draw Type --")]),e("b-form-select-option",{attrs:{value:"LUCKY_DRAW"}},[t._v("Lucky Draw")]),e("b-form-select-option",{attrs:{value:"SPINNING_WHEEL"}},[t._v("Spinning Wheel")]),e("b-form-select-option",{attrs:{value:"EARLY_BIRD"}},[t._v("Early Bird")]),e("b-form-select-option",{attrs:{value:"DOOR_GIFT"}},[t._v("Door Gift")])],1)],1),"LUCKY_DRAW"===t.selectedLiveDrawType?e("div",{staticClass:"col-md-6"},[e("label",{staticClass:"font-weight-bold mb-2",attrs:{for:"luckyDrawSubType"}},[t._v("Select Lucky Draw Type")]),e("b-form-select",{staticClass:"form-control",attrs:{id:"luckyDrawSubType"},on:{change:t.onLuckyDrawSubTypeChange},model:{value:t.selectedLuckyDrawSubType,callback:function(e){t.selectedLuckyDrawSubType=e},expression:"selectedLuckyDrawSubType"}},[e("b-form-select-option",{attrs:{value:null}},[t._v("-- Select Type --")]),e("b-form-select-option",{attrs:{value:"LIVE"}},[t._v("Live")]),e("b-form-select-option",{attrs:{value:"PRE_LIVE"}},[t._v("Pre-Live")]),e("b-form-select-option",{attrs:{value:"PRE_DRAW"}},[t._v("Pre-Draw")])],1)],1):t._e()]),t.selectedLiveDrawType?e("div",{staticClass:"mt-4"},[e("h4",{staticClass:"mb-3"},[t._v(t._s(t.getLiveDrawTitle))]),e("p",{staticClass:"text-muted"},[t._v(t._s(t.getLiveDrawDescription))]),"LUCKY_DRAW"===t.selectedLiveDrawType&&t.canStartDraw?e("div",{staticClass:"mt-4"},[e("label",{staticClass:"font-weight-bold"},[t._v("Select Draw Order")]),e("p",{staticClass:"text-muted small"},[t._v("Before starting the event, please confirm the desired drawing approach with the customer.")]),e("div",{staticClass:"d-flex",staticStyle:{gap:"20px"},on:{change:t.saveDrawOrder}},[e("label",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.drawOrder,expression:"drawOrder"}],staticClass:"mr-1",attrs:{type:"radio",value:"top-to-bottom"},domProps:{checked:t._q(t.drawOrder,"top-to-bottom")},on:{change:function(e){t.drawOrder="top-to-bottom"}}}),t._v(" Top to Bottom (e.g., 1st, 2nd, 3rd...) ")]),e("label",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.drawOrder,expression:"drawOrder"}],staticClass:"mr-1",attrs:{type:"radio",value:"bottom-to-top"},domProps:{checked:t._q(t.drawOrder,"bottom-to-top")},on:{change:function(e){t.drawOrder="bottom-to-top"}}}),t._v(" Bottom to Top (e.g., 10th, 9th, 8th...) ")])])]):t._e(),e("div",{staticClass:"mt-4"},[e("b-button",{attrs:{variant:"primary",size:"lg",disabled:!t.canStartDraw},on:{click:t.startLiveDrawForWinnerAnnounced}},[e("i",{staticClass:"fas fa-play mr-2"}),t._v("Start Live Draw ")]),"LUCKY_DRAW"===t.selectedLiveDrawType&&!t.getDrawSettings.enabled&&t.selectedLuckyDrawSubType?e("small",{staticClass:"text-danger d-block mt-2"},[e("i",{staticClass:"fas fa-exclamation-triangle mr-1"}),t._v(" This draw type is not enabled. Please enable it in the Control Panel first. ")]):t._e(),"LUCKY_DRAW"!==t.selectedLiveDrawType||t.selectedLuckyDrawSubType?t._e():e("small",{staticClass:"text-warning d-block mt-2"},[e("i",{staticClass:"fas fa-info-circle mr-1"}),t._v(" Please select a Lucky Draw sub-type (Live, Pre-Live, or Pre-Draw). ")])],1)]):e("div",{staticClass:"text-center py-5 text-muted"},[e("i",{staticClass:"fas fa-hand-pointer fa-3x mb-3"}),e("p",[t._v("Please select a draw type from the dropdown above to begin")])])]),t.showPrizeBoxes?e("div",{staticClass:"col-md-5"},[e("div",{staticClass:"prize-ranks-container"},[e("h5",{staticClass:"mb-3 font-weight-bold"},[e("i",{staticClass:"fas fa-trophy mr-2 text-warning"}),t._v("Prize Ranks ")]),e("p",{staticClass:"text-muted small mb-3"},[t._v("Total Positions: "+t._s(t.totalPrizePositions))]),e("div",{staticClass:"prize-boxes-grid"},t._l(t.totalPrizePositions,(function(a){return e("div",{key:a,staticClass:"prize-box",class:{"prize-box-filled":t.isRankFilled(a)}},[e("div",{staticClass:"prize-rank-number"},[t._v(t._s(a))]),e("div",{staticClass:"prize-rank-label"},[t._v(t._s(t.getRankLabel(a)))])])})),0),e("div",{staticClass:"prize-legend mt-3"},[e("div",{staticClass:"legend-item"},[e("span",{staticClass:"legend-box legend-empty"}),e("span",{staticClass:"legend-text"},[t._v("Available")])]),e("div",{staticClass:"legend-item"},[e("span",{staticClass:"legend-box legend-filled"}),e("span",{staticClass:"legend-text"},[t._v("Winner Selected")])])])])]):t._e()])])],1),e("b-tab",{attrs:{title:"Participants",lazy:""}},[e("eventLuckyDrawParticipentNewVue")],1),e("b-tab",{attrs:{title:"Winners",lazy:""}},[e("eventLuckyDrawWinner")],1),e("b-tab",{attrs:{title:"Prizes",lazy:""},on:{click:t.onPrizesTabClick}},[e("b-card",[e("div",{staticClass:"d-flex justify-content-between align-items-center mb-2"},[e("div",{staticClass:"search-container"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.filter,expression:"filter"}],staticClass:"search-input",attrs:{type:"text",placeholder:"Type to search..."},domProps:{value:t.filter},on:{input:function(e){e.target.composing||(t.filter=e.target.value)}}}),e("button",{staticClass:"search-button"},[e("i",{staticClass:"fa fa-search"})])]),e("div",{staticClass:"d-flex align-items-center"},[e("label",{staticClass:"mr-2 mb-0 text-nowrap",attrs:{for:"prize-filter"}},[t._v("Select Draw Type")]),e("b-form-select",{staticClass:"form-control",staticStyle:{"max-width":"250px"},attrs:{id:"prize-filter",options:t.drawTypeOptions},model:{value:t.selectedPrizeDrawType,callback:function(e){t.selectedPrizeDrawType=e},expression:"selectedPrizeDrawType"}})],1),e("div",{staticClass:"d-flex",staticStyle:{gap:"5px"}},[e("b-button",{attrs:{variant:"info"},on:{click:function(e){t.showPrizeImportModal=!0}}},[e("i",{staticClass:"fas fa-upload mr-1"}),t._v(" Import ")]),e("b-button",{attrs:{variant:"primary"},on:{click:t.openAddPrizeModal}},[e("i",{staticClass:"fas fa-plus mr-1"}),t._v(" Add Prize ")])],1)]),e("div",{staticClass:"table-responsive mt-3"},[e("b-table",{staticClass:"cursor-pointer",attrs:{"head-variant":"light",bordered:"",hover:"",fields:t.prizeFields,items:t.filteredPrizes,"show-empty":""},on:{"row-clicked":t.openPrizeUpdateModal},scopedSlots:t._u([{key:"head(index)",fn:function(){return[e("div",{staticClass:"text-center"},[t._v("S/N")])]},proxy:!0},{key:"cell(index)",fn:function(a){return[e("div",{staticClass:"text-center"},[t._v(t._s(a.index+1))])]}},{key:"cell(PRIZE_POSITION)",fn:function(a){return[e("div",{staticClass:"text-left"},[e("span",[t._v(" "+t._s(a.item.PRIZE_POSITION)+" ")])])]}},{key:"cell(LUCKY_DRAW_NO)",fn:function(a){return[e("div",[t._v(t._s(a.item.LUCKY_DRAW_NO?a.item.LUCKY_DRAW_NO:"-"))])]}}])})],1)])],1),e("b-tab",{attrs:{title:"Backdrop Design",lazy:""}},[e("CreateBackdrop")],1)],1)],1)]),e("b-modal",{attrs:{id:"list-settings-modal",title:"Winners List Settings",centered:"","hide-footer":""}},[e("div",{staticClass:"p-3"},[e("h5",{staticClass:"mb-3"},[t._v("Select columns to display:")]),t._l(t.winnerFieldOptions,(function(a){return e("div",{key:a.key,staticClass:"form-check mb-3"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.visible,expression:"field.visible"}],staticClass:"form-check-input",staticStyle:{transform:"scale(1.2)"},attrs:{type:"checkbox",id:"field-checkbox-"+a.key,disabled:a.disabled},domProps:{checked:Array.isArray(a.visible)?t._i(a.visible,null)>-1:a.visible},on:{change:function(e){var i=a.visible,r=e.target,n=!!r.checked;if(Array.isArray(i)){var s=null,l=t._i(i,s);r.checked?l<0&&t.$set(a,"visible",i.concat([s])):l>-1&&t.$set(a,"visible",i.slice(0,l).concat(i.slice(l+1)))}else t.$set(a,"visible",n)}}}),e("label",{staticClass:"form-check-label ml-2",attrs:{for:"field-checkbox-"+a.key}},[t._v(" "+t._s(a.label)+" ")])])}))],2),e("div",{staticClass:"d-flex justify-content-between p-3",staticStyle:{"background-color":"#f9f9f9","border-top":"1px solid #dee2e6"}},[e("b-button",{staticClass:"px-4",attrs:{variant:"secondary"},on:{click:t.resetWinnerFields}},[t._v("Reset")]),e("b-button",{staticClass:"px-4",attrs:{variant:"success"},on:{click:function(e){return t.$bvModal.hide("list-settings-modal")}}},[t._v("Done")])],1)]),e("b-modal",{ref:"prizeImportModal",attrs:{size:"xl",title:"Import Prizes","hide-footer":"","modal-class":"upload-excel-modal"},model:{value:t.showPrizeImportModal,callback:function(e){t.showPrizeImportModal=e},expression:"showPrizeImportModal"}},[e("div",{staticClass:"d-flex justify-content-between align-items-center mb-3 mt-0"},[e("div",[e("p",{staticClass:"mb-0 font-weight-bold text-muted",staticStyle:{"font-size":"15px"}},[t._v("Import Prizes from Excel")]),e("p",{staticClass:"mb-0",staticStyle:{"font-size":"13px"}},[t._v("Upload an Excel file containing prize information")])]),e("div",{staticClass:"d-flex"},[e("b-button",{staticClass:"mr-2",attrs:{size:"sm",variant:"warning"},on:{click:t.triggerPrizeFileInput}},[e("i",{staticClass:"fas fa-upload mr-1"}),t._v(" Upload Excel ")]),t._v("   "),e("b-button",{attrs:{size:"sm",variant:"primary"},on:{click:t.downloadPrizeFormat}},[e("i",{staticClass:"fas fa-download mr-1"}),t._v(" Download Format ")]),e("input",{ref:"prizeFileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:".xlsx, .xls"},on:{change:t.handlePrizeFileUpload}})],1)]),e("hr"),t.prizeExcelData.length>0?e("div",[e("h6",{staticClass:"mb-2 text-primary"},[t._v("Preview Uploaded Data ("+t._s(t.prizeExcelData.length)+" records)")]),e("div",{staticClass:"table-responsive"},[e("b-table",{attrs:{items:t.prizeExcelData,fields:t.prizeTableFields,striped:"",bordered:"",hover:"",responsive:"sm"}})],1),e("div",{staticClass:"mt-3"},[e("b-button",{staticClass:"mr-2 float-left",attrs:{variant:"success",disabled:t.isImportingPrizes},on:{click:t.onHandleImportPrizeData}},[e("i",{staticClass:"fas fa-check mr-1"}),t._v(" "+t._s(t.isImportingPrizes?"Importing...":"Import Data")+" ")]),t._v("   "),e("b-button",{staticClass:"float-right ml-2",staticStyle:{float:"inline-end"},attrs:{variant:"danger"},on:{click:t.cancelPrizeUpload}},[e("i",{staticClass:"fas fa-times mr-1"}),t._v(" Cancel ")])],1)]):e("div",{staticClass:"text-center text-muted py-5"},[e("i",{staticClass:"fas fa-file-excel fa-3x mb-3 text-secondary"}),e("p",{staticClass:"mb-1",staticStyle:{"font-size":"13px"}},[t._v("No Excel file uploaded yet.")]),e("small",{staticStyle:{color:"red"}},[t._v("Please upload an Excel file to preview and import Prize data.")]),e("br"),e("br"),e("small",{staticClass:"text-info"},[e("strong",[t._v("Expected format:")]),t._v(" Name, Position, Type ")])])]),e("b-modal",{attrs:{size:"lg",id:"add-prize-modal","hide-footer":"",centered:""},scopedSlots:t._u([{key:"modal-header",fn:function(){return[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-10"},[e("h5",{staticClass:"mt-1 text-white text-left"},[e("b",{staticStyle:{color:"#17a2b8 !important"}},[t._v("Add New Prize")])])]),e("div",{staticClass:"col-md-2 float-end"},[e("b-button",{staticClass:"float-end close-btn-white text-right",attrs:{size:"sm",variant:"link"},on:{click:function(e){return t.$bvModal.hide("add-prize-modal")}}},[e("i",{staticClass:"fas fa-close"})])],1)])]},proxy:!0}])},[e("div",[e("validation-observer",{ref:"addObserver",scopedSlots:t._u([{key:"default",fn:function(a){var i=a.handleSubmit;return[e("b-form",{on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),i(t.addPrizeDetails)}}},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-12"},[e("validation-provider",{attrs:{name:"Draw Type",rules:{required:!0}},scopedSlots:t._u([{key:"default",fn:function(a){return[e("label",{attrs:{for:"prizeName"}},[t._v("Draw Type "),e("span",{staticStyle:{color:"red"}},[t._v("*")])]),e("b-form-select",{staticClass:"form-control",attrs:{id:"prizeName",state:t.getValidationState(a),"aria-describedby":"prize-name-feedback"},model:{value:t.newPrize.draw,callback:function(e){t.$set(t.newPrize,"draw",e)},expression:"newPrize.draw"}},[e("b-form-select-option",{attrs:{value:""}},[t._v("Select Draw Type")]),e("b-form-select-option",{attrs:{value:"LIVE"}},[t._v("Live")]),e("b-form-select-option",{attrs:{value:"PRE_LIVE"}},[t._v("Pre Live")]),e("b-form-select-option",{attrs:{value:"PRE_DRAW"}},[t._v("Pre Draw")]),e("b-form-select-option",{attrs:{value:"EARLY_BIRD"}},[t._v("Early Bird")])],1),e("b-form-invalid-feedback",{attrs:{id:"prize-name-feedback"}},[t._v(" "+t._s(a.errors[0])+" ")])]}}],null,!0)})],1),e("div",{staticClass:"col-md-12"},[e("validation-provider",{attrs:{name:"Prize Name",rules:{required:!0}},scopedSlots:t._u([{key:"default",fn:function(a){return[e("label",{attrs:{for:"prizeName"}},[t._v("Prize Name "),e("span",{staticStyle:{color:"red"}},[t._v("*")])]),e("b-form-input",{staticClass:"form-control",attrs:{id:"prizeName",placeholder:"Enter prize name",type:"text",state:t.getValidationState(a),"aria-describedby":"prize-name-feedback"},model:{value:t.newPrize.name,callback:function(e){t.$set(t.newPrize,"name",e)},expression:"newPrize.name"}}),e("b-form-invalid-feedback",{attrs:{id:"prize-name-feedback"}},[t._v(t._s(a.errors[0]))])]}}],null,!0)})],1),e("div",{staticClass:"col-md-12 mt-3"},[e("validation-provider",{attrs:{name:"Prize Position",rules:{required:!0}},scopedSlots:t._u([{key:"default",fn:function(a){return[e("label",{attrs:{for:"prizePosition"}},[t._v("Prize Position "),e("span",{staticStyle:{color:"red"}},[t._v("*")])]),e("b-form-input",{staticClass:"form-control",attrs:{id:"prizePosition",placeholder:"Enter prize position",type:"number",state:t.getValidationState(a),"aria-describedby":"prize-position-feedback"},model:{value:t.newPrize.position,callback:function(e){t.$set(t.newPrize,"position",e)},expression:"newPrize.position"}}),e("b-form-invalid-feedback",{attrs:{id:"prize-position-feedback"}},[t._v(t._s(a.errors[0]))])]}}],null,!0)})],1),e("div",{staticClass:"col-md-12 mt-3"},[e("validation-provider",{attrs:{name:"Prize Description"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("label",{attrs:{for:"prizeDescription"}},[t._v("Prize Description")]),e("b-form-textarea",{staticClass:"form-control",attrs:{id:"prizeDescription",rows:"3",placeholder:"Enter prize description (optional)",state:t.getValidationState(a),"aria-describedby":"prize-description-feedback"},model:{value:t.newPrize.description,callback:function(e){t.$set(t.newPrize,"description",e)},expression:"newPrize.description"}}),e("b-form-invalid-feedback",{attrs:{id:"prize-description-feedback"}},[t._v(t._s(a.errors[0]))])]}}],null,!0)})],1)]),e("hr"),e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-12",attrs:{align:"left"}},[e("button",{staticClass:"btn btn-success ripple customerBox mr-2",attrs:{type:"submit"}},[e("i",{staticClass:"fas fa-save mr-2",staticStyle:{"font-size":"20px"}}),e("b",{staticStyle:{"font-size":"16px"}},[t._v("Submit")])]),e("button",{staticClass:"btn btn-danger ripple customerBox mr-2",attrs:{type:"button"},on:{click:function(e){return t.$bvModal.hide("add-prize-modal")}}},[e("i",{staticClass:"fas fa-close mr-2 btn-close"}),e("b",{staticStyle:{"font-size":"16px"}},[t._v("Close")])])])])])]}}])})],1)]),e("b-modal",{attrs:{size:"lg",id:"update-prize-modal","hide-footer":"",centered:""},scopedSlots:t._u([{key:"modal-header",fn:function(){return[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-10"},[e("h5",{staticClass:"mt-1 text-white text-left"},[e("b",{staticStyle:{color:"#17a2b8 !important"}},[t._v("Update Prize")])])]),e("div",{staticClass:"col-md-2 float-end"},[e("b-button",{staticClass:"float-end close-btn-white text-right",attrs:{size:"sm",variant:"link"},on:{click:function(e){return t.$bvModal.hide("update-prize-modal")}}},[e("i",{staticClass:"fas fa-close"})])],1)])]},proxy:!0}])},[t.updatePrizeData?e("div",[e("validation-observer",{ref:"updateObserver",scopedSlots:t._u([{key:"default",fn:function(a){var i=a.handleSubmit;return[e("b-form",{on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),i(t.updatePrizeDetails)}}},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-12"},[e("validation-provider",{attrs:{name:"Draw Type",rules:{required:!0}},scopedSlots:t._u([{key:"default",fn:function(a){return[e("label",{attrs:{for:"updatePrizeDrawType"}},[t._v("Draw Type "),e("span",{staticStyle:{color:"red"}},[t._v("*")])]),e("b-form-select",{staticClass:"form-control",attrs:{id:"updatePrizeDrawType",state:t.getValidationState(a),"aria-describedby":"prize-draw-type-feedback"},model:{value:t.updatePrizeData.draw,callback:function(e){t.$set(t.updatePrizeData,"draw",e)},expression:"updatePrizeData.draw"}},[e("b-form-select-option",{attrs:{value:""}},[t._v("Select Draw Type")]),e("b-form-select-option",{attrs:{value:"LIVE"}},[t._v("Live")]),e("b-form-select-option",{attrs:{value:"PRE_LIVE"}},[t._v("Pre Live")]),e("b-form-select-option",{attrs:{value:"PRE_DRAW"}},[t._v("Pre Draw")]),e("b-form-select-option",{attrs:{value:"EARLY_BIRD"}},[t._v("Early Bird")])],1),e("b-form-invalid-feedback",{attrs:{id:"prize-draw-type-feedback"}},[t._v(" "+t._s(a.errors[0])+" ")])]}}],null,!0)})],1),e("div",{staticClass:"col-md-12 mt-3"},[e("validation-provider",{attrs:{name:"Prize Name",rules:{required:!0}},scopedSlots:t._u([{key:"default",fn:function(a){return[e("label",{attrs:{for:"updatePrizeName"}},[t._v("Prize Name "),e("span",{staticStyle:{color:"red"}},[t._v("*")])]),e("b-form-input",{staticClass:"form-control",attrs:{id:"updatePrizeName",type:"text",state:t.getValidationState(a),"aria-describedby":"update-prize-name-feedback"},model:{value:t.updatePrizeData.PRIZE_NAME,callback:function(e){t.$set(t.updatePrizeData,"PRIZE_NAME",e)},expression:"updatePrizeData.PRIZE_NAME"}}),e("b-form-invalid-feedback",{attrs:{id:"update-prize-name-feedback"}},[t._v(t._s(a.errors[0]))])]}}],null,!0)})],1),e("div",{staticClass:"col-md-12 mt-3"},[e("validation-provider",{attrs:{name:"Prize Position",rules:{required:!0}},scopedSlots:t._u([{key:"default",fn:function(a){return[e("label",{attrs:{for:"updatePrizePosition"}},[t._v("Prize Position "),e("span",{staticStyle:{color:"red"}},[t._v("*")])]),e("b-form-input",{staticClass:"form-control",attrs:{id:"updatePrizePosition",type:"number",state:t.getValidationState(a),"aria-describedby":"update-prize-position-feedback"},model:{value:t.updatePrizeData.PRIZE_POSITION,callback:function(e){t.$set(t.updatePrizeData,"PRIZE_POSITION",e)},expression:"updatePrizeData.PRIZE_POSITION"}}),e("b-form-invalid-feedback",{attrs:{id:"update-prize-position-feedback"}},[t._v(t._s(a.errors[0]))])]}}],null,!0)})],1),e("div",{staticClass:"col-md-12 mt-3"},[e("validation-provider",{attrs:{name:"Prize Description"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("label",{attrs:{for:"updatePrizeDescription"}},[t._v("Prize Description")]),e("b-form-textarea",{staticClass:"form-control",attrs:{id:"updatePrizeDescription",rows:"3",state:t.getValidationState(a),"aria-describedby":"update-prize-description-feedback"},model:{value:t.updatePrizeData.PRIZE_DESCRIPTION,callback:function(e){t.$set(t.updatePrizeData,"PRIZE_DESCRIPTION",e)},expression:"updatePrizeData.PRIZE_DESCRIPTION"}}),e("b-form-invalid-feedback",{attrs:{id:"update-prize-description-feedback"}},[t._v(t._s(a.errors[0]))])]}}],null,!0)})],1)]),e("hr"),e("div",{staticClass:"row mt-4"},[e("div",{staticClass:"col-md-12 d-flex justify-content-between align-items-center flex-wrap"},[e("div",{staticClass:"d-flex flex-wrap"},[e("button",{staticClass:"btn btn-danger ripple customerBox mr-2",attrs:{type:"button"},on:{click:function(e){return t.deletePrize(t.updatePrizeData)}}},[e("i",{staticClass:"fas fa-trash-alt mr-2"}),e("b",{staticStyle:{"font-size":"16px"}},[t._v("Delete")])]),e("button",{staticClass:"btn btn-secondary ripple customerBox",attrs:{type:"button"},on:{click:function(e){return t.$bvModal.hide("update-prize-modal")}}},[e("i",{staticClass:"fas fa-close mr-2 btn-close"}),e("b",{staticStyle:{"font-size":"16px"}},[t._v("Close")])])]),e("div",[e("button",{staticClass:"btn btn-success ripple customerBox",attrs:{type:"submit"}},[e("i",{staticClass:"fas fa-save mr-2",staticStyle:{"font-size":"18px"}}),e("b",{staticStyle:{"font-size":"16px"}},[t._v("Update")])])])])])])]}}],null,!1,1721104758)})],1):t._e()]),e("b-modal",{ref:"beneficiaryModal",attrs:{size:"xl",title:"Beneficiary Details","hide-footer":"","modal-class":"upload-excel-modal"},model:{value:t.showBeneficiaryModal,callback:function(e){t.showBeneficiaryModal=e},expression:"showBeneficiaryModal"}},[e("div",{staticClass:"d-flex justify-content-between align-items-center mb-3 mt-0 p"},[e("div",[e("p",{staticClass:"mb-0 font-weight-bold text-muted",staticStyle:{"font-size":"15px"}},[t._v("Event Name :")]),e("p",{staticClass:"mb-0",staticStyle:{"font-size":"15px"}},[t._v(t._s(t.specific_event_details.EVENT_NAME||"-"))])]),e("div",[e("p",{staticClass:"mb-0 font-weight-bold text-muted",staticStyle:{"font-size":"15px"}},[t._v("Event Venue:")]),e("p",{staticClass:"mb-0",staticStyle:{"font-size":"15px"}},[t._v(t._s(t.specific_event_details.EVENT_VENUE||"-"))])]),e("div",{staticClass:"d-flex"},[e("b-button",{staticClass:"mr-2",attrs:{size:"sm",variant:"warning"},on:{click:t.triggerFileInput}},[e("i",{staticClass:"fas fa-upload mr-1"}),t._v(" Upload Excel ")]),t._v("   "),e("b-button",{attrs:{size:"sm",variant:"primary"},on:{click:t.downloadFormat}},[e("i",{staticClass:"fas fa-download mr-1"}),t._v(" Download Format ")]),e("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:".xlsx, .xls"},on:{change:t.handleFileUpload}})],1)]),e("hr"),t.excelData.length>0?e("div",[e("h6",{staticClass:"mb-2 text-primary"},[t._v("Preview Uploaded Data ("+t._s(t.excelData.length)+" records)")]),e("div",{staticClass:"table-responsive"},[e("b-table",{attrs:{items:t.excelData,fields:t.tableFields,striped:"",bordered:"",hover:"",responsive:"sm"}})],1),e("div",{staticClass:"mt-3"},[e("b-button",{staticClass:"mr-2 float-left",attrs:{variant:"success",disabled:t.isImporting},on:{click:t.onHandleImportBeneficiaryData}},[e("i",{staticClass:"fas fa-check mr-1"}),t._v(" "+t._s(t.isImporting?"Importing...":"Import Data")+" ")]),t._v("   "),e("b-button",{staticClass:"float-right ml-2",staticStyle:{float:"inline-end"},attrs:{variant:"danger"},on:{click:t.cancelUpload}},[e("i",{staticClass:"fas fa-times mr-1"}),t._v(" Cancel ")])],1)]):e("div",{staticClass:"text-center text-muted py-5"},[e("i",{staticClass:"fas fa-file-excel fa-3x mb-3 text-secondary"}),e("p",{staticClass:"mb-1",staticStyle:{"font-size":"13px"}},[t._v("No Excel file uploaded yet.")]),e("small",{staticStyle:{color:"red"}},[t._v("Please upload an Excel file to preview and import Attendees data.")]),e("br"),e("br"),e("small",{staticClass:"text-info"},[e("strong",[t._v("Expected format:")]),t._v(" Name, Email, Phone, Company, Designation, How Heard About Us ")])])]),e("b-modal",{ref:"participantImportModalOld",attrs:{size:"xl",title:"Import Participants","hide-footer":"","modal-class":"upload-excel-modal"},model:{value:t.showParticipantImportModalOld,callback:function(e){t.showParticipantImportModalOld=e},expression:"showParticipantImportModalOld"}},[e("div",{staticClass:"d-flex justify-content-between align-items-center mb-3 mt-0"},[e("div",[e("p",{staticClass:"mb-0 font-weight-bold text-muted",staticStyle:{"font-size":"15px"}},[t._v("Import Participants from Excel")]),e("p",{staticClass:"mb-0",staticStyle:{"font-size":"13px"}},[t._v("Upload an Excel file containing participant information")])]),e("div",{staticClass:"d-flex"},[e("b-button",{staticClass:"mr-2",attrs:{size:"sm",variant:"warning"},on:{click:t.triggerParticipantFileInput}},[e("i",{staticClass:"fas fa-upload mr-1"}),t._v(" Upload Excel ")]),e("b-button",{attrs:{size:"sm",variant:"primary"},on:{click:t.downloadParticipantFormat}},[e("i",{staticClass:"fas fa-download mr-1"}),t._v(" Download Format ")]),e("input",{ref:"participantFileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:".xlsx, .xls"},on:{change:t.handleParticipantFileUpload}})],1)]),e("hr"),t.participantExcelData.length>0?e("div",[e("h6",{staticClass:"mb-2 text-primary"},[t._v("Preview Uploaded Data ("+t._s(t.participantExcelData.length)+" records)")]),e("div",{staticClass:"table-responsive"},[e("b-table",{attrs:{items:t.participantExcelData,fields:t.participantTableFields,striped:"",bordered:"",hover:"",responsive:"sm"}})],1),e("div",{staticClass:"mt-3"},[e("b-button",{staticClass:"mr-2 float-left",attrs:{variant:"success",disabled:t.isImportingParticipants},on:{click:t.onHandleImportParticipantData}},[e("i",{staticClass:"fas fa-check mr-1"}),t._v(" "+t._s(t.isImportingParticipants?"Importing...":"Import Data")+" ")]),e("b-button",{staticClass:"float-right ml-2",attrs:{variant:"danger"},on:{click:t.cancelParticipantUpload}},[e("i",{staticClass:"fas fa-times mr-1"}),t._v(" Cancel ")])],1)]):e("div",{staticClass:"text-center text-muted py-5"},[e("i",{staticClass:"fas fa-file-excel fa-3x mb-3 text-secondary"}),e("p",{staticClass:"mb-1",staticStyle:{"font-size":"13px"}},[t._v("No Excel file uploaded yet.")]),e("small",{staticStyle:{color:"red"}},[t._v("Please upload an Excel file to preview and import participant data.")]),e("br"),e("br"),e("small",{staticClass:"text-info"},[e("strong",[t._v("Expected format:")]),t._v(" Participant Name, Email, Contact Number, Checked In, Draw Types ")])])]),e("b-modal",{attrs:{id:"modal-1",title:"Add Participant",size:"lg","hide-footer":""}},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-4"},[e("label",[t._v("Person Name")]),e("b-form-input",{attrs:{type:"text"},model:{value:t.formData.PERSON_NAME,callback:function(e){t.$set(t.formData,"PERSON_NAME",e)},expression:"formData.PERSON_NAME"}})],1),e("div",{staticClass:"col-md-4"},[e("label",[t._v("Email")]),e("b-form-input",{attrs:{type:"email"},model:{value:t.formData.PERSON_EMAIL,callback:function(e){t.$set(t.formData,"PERSON_EMAIL",e)},expression:"formData.PERSON_EMAIL"}})],1),e("div",{staticClass:"col-md-4"},[e("label",[t._v("Contact Number")]),e("b-form-input",{attrs:{type:"number"},model:{value:t.formData.PERSON_CONTACT_NO,callback:function(e){t.$set(t.formData,"PERSON_CONTACT_NO",e)},expression:"formData.PERSON_CONTACT_NO"}})],1)]),e("div",{staticClass:"row mt-3"},[e("div",{staticClass:"col-md-4"},[e("label",[t._v("Designation")]),e("b-form-input",{attrs:{type:"text"},model:{value:t.formData.DESIGNATION,callback:function(e){t.$set(t.formData,"DESIGNATION",e)},expression:"formData.DESIGNATION"}})],1),e("div",{staticClass:"col-md-4"},[e("label",[t._v("Company Name")]),e("b-form-input",{attrs:{type:"text"},model:{value:t.formData.COMPANY_NAME,callback:function(e){t.$set(t.formData,"COMPANY_NAME",e)},expression:"formData.COMPANY_NAME"}})],1),e("div",{staticClass:"col-md-4"},[e("label",[t._v("Ticket ID")]),e("b-form-input",{attrs:{type:"text"},model:{value:t.formData.TICKET_ID,callback:function(e){t.$set(t.formData,"TICKET_ID",e)},expression:"formData.TICKET_ID"}})],1)]),e("div",{staticClass:"row mt-3"},[e("div",{staticClass:"col-md-4"},[e("label",[t._v("Table Number")]),e("b-form-select",{staticClass:"form-control",attrs:{options:t.tableOptions},on:{focus:t.loadTables},model:{value:t.formData.TABLE_NO,callback:function(e){t.$set(t.formData,"TABLE_NO",e)},expression:"formData.TABLE_NO"}},[e("option",{domProps:{value:null}},[t._v("Select Table")])])],1),e("div",{staticClass:"col-md-8"},[e("label",[t._v("How Heard")]),e("b-form-input",{attrs:{type:"text"},model:{value:t.formData.HOW_HEARD,callback:function(e){t.$set(t.formData,"HOW_HEARD",e)},expression:"formData.HOW_HEARD"}})],1)]),e("div",{staticClass:"d-flex mt-3 justify-content-between"},[e("button",{staticClass:"btn btn-secondary",on:{click:function(e){return t.$bvModal.hide("modal-1")}}},[t._v("Cancel")]),e("button",{staticClass:"btn btn-primary",on:{click:t.onHandleAddParticipants}},[t._v("Save")])])]),e("b-modal",{ref:"participantImportModal",attrs:{size:"xl",title:"Import Participants","hide-footer":"","modal-class":"upload-excel-modal"},model:{value:t.showParticipantImportModal,callback:function(e){t.showParticipantImportModal=e},expression:"showParticipantImportModal"}},[e("div",{staticClass:"d-flex justify-content-between align-items-center mb-3 mt-0"},[e("div",[e("p",{staticClass:"mb-0 font-weight-bold text-muted",staticStyle:{"font-size":"15px"}},[t._v("Import Participants from Excel")]),e("p",{staticClass:"mb-0",staticStyle:{"font-size":"13px"}},[t._v("Upload an Excel file containing participant information")])]),e("div",{staticClass:"d-flex"},[e("b-button",{staticClass:"mr-2",attrs:{size:"sm",variant:"warning"},on:{click:t.triggerParticipantFileInput}},[e("i",{staticClass:"fas fa-upload mr-1"}),t._v(" Upload Excel ")]),t._v("   "),e("b-button",{attrs:{size:"sm",variant:"primary"},on:{click:t.downloadParticipantFormat}},[e("i",{staticClass:"fas fa-download mr-1"}),t._v(" Download Format ")]),e("input",{ref:"participantFileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:".xlsx, .xls"},on:{change:t.handleParticipantFileUpload}})],1)]),e("hr"),t.participantExcelData.length>0?e("div",[e("h6",{staticClass:"mb-2 text-primary"},[t._v(" Preview Uploaded Data ("+t._s(t.participantExcelData.length)+" records) ")]),e("div",{staticClass:"table-responsive"},[e("b-table",{attrs:{items:t.participantExcelData,fields:t.participantTableFields,striped:"",bordered:"",hover:"",responsive:"sm"}})],1),e("div",{staticClass:"mt-3"},[e("b-button",{staticClass:"mr-2 float-left",attrs:{variant:"success",disabled:t.isImportingParticipants},on:{click:t.onHandleImportParticipantData}},[e("i",{staticClass:"fas fa-check mr-1"}),t._v(" "+t._s(t.isImportingParticipants?"Importing...":"Import Data")+" ")]),t._v("   "),e("b-button",{staticClass:"float-right ml-2",staticStyle:{float:"inline-end"},attrs:{variant:"danger"},on:{click:t.cancelParticipantUpload}},[e("i",{staticClass:"fas fa-times mr-1"}),t._v(" Cancel ")])],1)]):e("div",{staticClass:"text-center text-muted py-5"},[e("i",{staticClass:"fas fa-file-excel fa-3x mb-3 text-secondary"}),e("p",{staticClass:"mb-1",staticStyle:{"font-size":"13px"}},[t._v("No Excel file uploaded yet.")]),e("small",{staticStyle:{color:"red"}},[t._v("Please upload an Excel file to preview and import participant data.")]),e("br"),e("br"),e("small",{staticClass:"text-info"},[e("strong",[t._v("Expected format:")]),t._v(" Lucky Draw Number, Participant Name ")])])]),e("b-modal",{attrs:{id:"winningModalForLiveDraw","hide-footer":"","hide-header":"",centered:"","content-class":"bg-transparent border-0","body-class":"p-0"},on:{hidden:t.resetWinnerModal}},[e("div",{staticClass:"flipper-display-section"},[e("div",{staticClass:"winner-display-grid"},[e("div",{staticClass:"display-box"},[e("div",{staticClass:"box-content prize-position"},[t._v(" "+t._s(t.getRankLabel(t.currentPrizePosition))+" ")]),e("div",{staticClass:"box-content prize-description"},[t._v(" "+t._s(t.currentWinner&&t.currentWinner.prize?t.currentWinner.prize.PRIZE_NAME:"...")+" ")])]),e("div",{staticClass:"display-box lucky-draw-box"},[e("div",{staticClass:"box-content"},[e("div",{staticClass:"main-flipper-display",class:{disabled:t.isDrawing}},t._l(t.mainDisplayDigits,(function(a,i){return e("div",{key:"main-".concat(i),staticClass:"flip-card"},[e("div",{staticClass:"flipper",class:{flip:a.isFlipping}},[e("div",{staticClass:"card-face front"},[e("div",{staticClass:"flip-card-inner"},[e("div",{staticClass:"flip-card-top"},[e("span",[t._v(t._s(a.current))])]),e("div",{staticClass:"flip-card-bottom"},[e("span",[t._v(t._s(a.current))])]),e("div",{staticClass:"flip-card-divider"})])]),e("div",{staticClass:"card-face back"},[e("div",{staticClass:"flip-card-inner"},[e("div",{staticClass:"flip-card-top"},[e("span",[t._v(t._s(a.next))])]),e("div",{staticClass:"flip-card-bottom"},[e("span",[t._v(t._s(a.next))])]),e("div",{staticClass:"flip-card-divider"})])])])])})),0)])]),e("div",{staticClass:"display-box"},[e("div",{staticClass:"box-content winner-name"},[t._v(" "+t._s(!t.isDrawing&&t.currentWinner&&t.currentWinner.participant?t.currentWinner.participant.PARTICIPANT_NAME:"...")+" ")])]),e("div",{staticClass:"display-box"},[e("div",{staticClass:"box-content winner-department"},[t._v(" "+t._s(!t.isDrawing&&t.currentWinner&&t.currentWinner.participant?t.currentWinner.participant.DEPARTMENT:"...")+" ")])]),e("div",{staticClass:"actions-container"},[t.winnerFound?e("div",{staticClass:"d-flex justify-content-center",staticStyle:{gap:"20px"}},[e("button",{staticClass:"action-btn info-btn",staticStyle:{"background-color":"#17a2b8",color:"white"},attrs:{disabled:t.isDrawing||t.isSavingWinner},on:{click:t.drawAgain}},[e("i",{staticClass:"fas fa-play-circle"}),t._v(" Draw Again ")]),e("button",{staticClass:"action-btn redraw-btn",attrs:{disabled:t.isSavingWinner},on:{click:t.redrawCurrentWinner}},[e("i",{staticClass:"fas fa-undo"}),t._v(" Redraw ")]),e("button",{staticClass:"action-btn cancel-btn",on:{click:function(e){return t.$bvModal.hide("winningModalForLiveDraw")}}},[e("i",{staticClass:"fas fa-times"}),t._v(" Close ")]),e("button",{staticClass:"action-btn refresh-btn",attrs:{disabled:t.isSavingWinner},on:{click:t.prepareNextDraw}},[e("i",{class:t.isSavingWinner?"fas fa-spinner fa-spin":"fas fa-sync-alt"}),t._v(" "+t._s(t.isSavingWinner?"Saving...":"Next Draw")+" ")])]):e("div",{staticClass:"d-flex justify-content-center",staticStyle:{gap:"20px"}},[e("button",{staticClass:"action-btn cancel-btn",attrs:{disabled:t.isDrawing},on:{click:function(e){return t.$bvModal.hide("winningModalForLiveDraw")}}},[e("i",{staticClass:"fas fa-times"}),t._v(" Cancel ")]),e("button",{staticClass:"action-btn confirm-btn",attrs:{disabled:t.isDrawing},on:{click:t.requestDraw}},[e("i",{staticClass:"fas fa-check"}),t._v(" "+t._s(t.isDrawing?"Drawing...":"Start")+" ")])])])]),t.currentWinner||t.isDrawing?t._e():e("div",{staticClass:"click-instruction"})])])],1)},s=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"loading_main_background",attrs:{id:"upload_loader"}},[e("img",{attrs:{src:a("95cd")}})])}],l=a("ade3"),o=a("b85c"),c=a("53ca"),u=a("2909"),d=a("5530"),p=a("c7eb"),_=a("1da1"),v=(a("e9c4"),a("14d9"),a("159b"),a("498a"),a("25f0"),a("caad"),a("2532"),a("d81d"),a("ac1f"),a("5319"),a("7db0"),a("ace4"),a("5cc6"),a("907a"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("986a"),a("1d02"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7"),a("1b3b"),a("3d71"),a("c6e3"),a("b64b"),a("4e82"),a("00b4"),a("9129"),a("a9e3"),a("6062"),a("3ca3"),a("ddb0"),a("d9e2"),a("a434"),a("4d90"),a("7386")),f=a("7bb1"),h=a("25ca"),m=a("471e"),b=a("323e"),D=a.n(b),P=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("div",{staticClass:"flipper-display-section",staticStyle:{"background-size":"cover"},style:{backgroundImage:"url("+t.luckydrawbg+")"}},[e("div",{staticClass:"display-container"},[e("div",{staticClass:"top-bar"},[e("div",{staticClass:"top-right-controls"},[e("button",{staticClass:"fullscreen-btn",attrs:{title:"Toggle Fullscreen"},on:{click:function(e){return e.stopPropagation(),t.toggleFullScreen.apply(null,arguments)}}},[e("svg",{attrs:{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{d:"M4 8V4H8M4 4L9 9M20 8V4H16M20 4L15 9M4 16V20H8M4 20L9 15M20 16V20H16M20 20L15 15","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}})])])])]),e("div",{staticClass:"prize-info-wrapper"},[e("div",{staticClass:"prize-info"},[e("h1",{staticClass:"prize-position"},[t._v(t._s(t.getRankLabel(t.currentPrizePosition)))]),e("h2",{staticClass:"prize-description"},[t._v(t._s(t.prizeDescription))])])]),e("div",{staticClass:"lucky-number-wrapper mt-3"},[e("div",{staticClass:"main-flipper-display",class:{disabled:t.isDrawing}},t._l(t.mainDisplayDigits,(function(a,i){return e("div",{key:i,staticClass:"flip-card"},[e("div",{staticClass:"flipper",class:{flip:a.isFlipping}},[e("div",{staticClass:"card-face front"},[e("div",{staticClass:"flip-card-inner"},[e("div",{staticClass:"flip-card-top"},[e("span",[t._v(t._s(a.current))])]),e("div",{staticClass:"flip-card-bottom"},[e("span",[t._v(t._s(a.current))])]),e("div",{staticClass:"flip-card-divider"})])]),e("div",{staticClass:"card-face back"},[e("div",{staticClass:"flip-card-inner"},[e("div",{staticClass:"flip-card-top"},[e("span",[t._v(t._s(a.next))])]),e("div",{staticClass:"flip-card-bottom"},[e("span",[t._v(t._s(a.next))])]),e("div",{staticClass:"flip-card-divider"})])])])])})),0)]),e("div",{staticClass:"winner-name-display mt-3"},[e("h2",{staticClass:"winner-name"},[t._v(t._s(t.winnerName))])])])])])},E=[],I=a("ed34"),w=a.n(I),C=function(){var t=this,e=t._self._c;return e("div",{staticClass:"lucky-draw-container"},[e("div",{staticClass:"carousel-container"},[e("div",{staticClass:"cards-wrapper"},[e("div",{staticClass:"card",class:{animate:t.animated,"slide-out":t.isAnimating}},[e("h2",{staticClass:"card-title"},[t._v("Prize Position")]),e("div",{staticClass:"card-content"},[e("p",{staticClass:"prize-text"},[t._v(t._s(t.currentPrize.position))])])]),e("div",{staticClass:"card",class:{animate:t.animated,"slide-out":t.isAnimating}},[e("h2",{staticClass:"card-title"},[t._v("Prize Description")]),e("div",{staticClass:"card-content"},[e("p",{staticClass:"description-text"},[t._v(t._s(t.currentPrize.description))])])]),e("div",{staticClass:"card",class:{animate:t.animated,"slide-out":t.isAnimating}},[e("h2",{staticClass:"card-title"},[t._v("Lucky Draw Number")]),e("div",{staticClass:"card-content"},[e("p",{staticClass:"lucky-number"},[t._v(t._s(t.currentPrize.luckyNumber))])])]),e("div",{staticClass:"card",class:{animate:t.animated,"slide-out":t.isAnimating}},[e("h2",{staticClass:"card-title"},[t._v("Winner's Name")]),e("div",{staticClass:"card-content"},[e("p",{staticClass:"winner-text"},[t._v(t._s(t.currentPrize.winnerName))])])])])])])},N=[],A=(a("9861"),a("841c"),{name:"LuckyDrawCards",data:function(){return{animated:!1,isAnimating:!1,currentIndex:0,backgroundUrl:w.a,eventName:"",eventLoading:!1,event_sys_id:null,drawType:null,luckyDrawSubType:null,isLoading:!1,prizeData:[]}},computed:{currentPrize:function(){return this.prizeData.length?this.prizeData[this.currentIndex]:{position:"N/A",description:"N/A",luckyNumber:"N/A",winnerName:"N/A"}},drawTypeLabel:function(){if(!this.drawType)return"Lucky Draw";var t={LUCKY_DRAW:"Lucky Draw",SPINNING_WHEEL:"Spinning Wheel",EARLY_BIRD:"Early Bird",DOOR_GIFT:"Door Gift"},e=t[this.drawType]||"Lucky Draw";if("LUCKY_DRAW"===this.drawType&&this.luckyDrawSubType){var a={LIVE:"Live",PRE_LIVE:"Pre-Live",PRE_DRAW:"Pre-Draw"};e+=" - ".concat(a[this.luckyDrawSubType]||"")}return e}},mounted:function(){var t=this;this.getUrlParameters();var e=localStorage.getItem("selectedEventSysId");if(e){try{this.event_sys_id=JSON.parse(e)}catch(a){this.event_sys_id=e}this.getEventDetails(),this.getWinnerDetailsInfo()}setTimeout((function(){return t.animated=!0}),100)},methods:{getUrlParameters:function(){var t=new URLSearchParams(window.location.search);this.drawType=t.get("DRAW_TYPE"),this.luckyDrawSubType=t.get("LUCKY_DRAW_SUB_TYPE");var e=t.get("EVENT_SYS_ID");e&&(this.event_sys_id=e,localStorage.setItem("selectedEventSysId",e))},mapLuckyDrawType:function(t){var e={"Live Draw":"LIVE","Pre Live Draw":"PRE_LIVE","Pre Draw":"PRE_DRAW"};return e[t]||t},getEventDetails:function(){var t=this;if(this.event_sys_id){this.eventLoading=!0;var e={ITEM:"SPECIFIC",EVENT_SYS_ID:this.event_sys_id};this.$apiCall.get(this.$apiBus.api_get_specific_event_info,{params:e}).then((function(e){var a,i;"true"===e.status&&null!==(a=e.response)&&void 0!==a&&null!==(i=a[0])&&void 0!==i&&i.EVENT_NAME&&(t.eventName=e.response[0].EVENT_NAME)})).finally((function(){return t.eventLoading=!1}))}},getWinnerDetailsInfo:function(){var t=this;D.a.start(),this.isLoading=!0;var e={ITEM:"VIEW_ALL",EVENT_SYS_ID:this.event_sys_id};this.$apiCall.get(this.$apiBus.api_get_winner_info,{params:e}).then((function(e){if("true"===e.status&&Array.isArray(e.response)){var a=e.response;"LUCKY_DRAW"===t.drawType&&t.luckyDrawSubType&&(a=a.filter((function(e){return t.mapLuckyDrawType(e.LUCKY_DRAW_TYPE)===t.luckyDrawSubType}))),t.prizeData=a.map((function(e){var a;return{position:t.formatPosition(e.PRIZE_POSITION),description:e.PRIZE_WON||"N/A",luckyNumber:(null===(a=e.LUCKY_DRAW_NO)||void 0===a?void 0:a.toString())||"N/A",winnerName:e.PARTICIPANT_NAME||"N/A",prizePositionValue:e.PRIZE_POSITION||0}})).sort((function(t,e){return t.prizePositionValue-e.prizePositionValue}))}else t.prizeData=[]})).finally((function(){t.isLoading=!1,D.a.done()}))},formatPosition:function(t){var e=parseInt(t);if(isNaN(e))return"N/A";var a=["th","st","nd","rd"],i=e%100;return e+(a[(i-20)%10]||a[i]||a[0])+" Place"},handleNext:function(){var t=this;!this.isAnimating&&this.prizeData.length&&(this.isAnimating=!0,this.animated=!1,setTimeout((function(){t.currentIndex=(t.currentIndex+1)%t.prizeData.length,t.animated=!0,setTimeout((function(){return t.isAnimating=!1}),600)}),300))},handlePrev:function(){var t=this;!this.isAnimating&&this.prizeData.length&&(this.isAnimating=!0,this.animated=!1,setTimeout((function(){t.currentIndex=(t.currentIndex-1+t.prizeData.length)%t.prizeData.length,t.animated=!0,setTimeout((function(){return t.isAnimating=!1}),600)}),300))}}}),T=A,g=(a("344e"),a("2877")),R=Object(g["a"])(T,C,N,!1,null,"84827f00",null),y=R.exports,S={components:{eventResultView:y},name:"LuckyDrawFlipper",data:function(){return{luckydrawbg:w.a,drawOrder:"BOTTOM_TO_TOP",isDrawing:!1,showResultPopup:!1,availableNumbers:[],animationTimers:[],mainDisplayDigits:[],winningDisplayDigits:[],currentPrizePosition:19,prizeDescription:"---",winnerName:"---",fromNumber:0,toNumber:0,eventId:null,luckyDrawSubType:"",participants:[],existingWinners:[],channel:null,startChannel:null,prizes:[]}},computed:{authUser:function(){var t=JSON.parse(localStorage.getItem("userInfo"));return t||{UserId:1}},apiLuckyDrawType:function(){if(!this.luckyDrawSubType)return"";var t=this.luckyDrawSubType.toUpperCase();switch(t){case"LIVE":return"Live Draw";case"PRE_LIVE":case"PRE_LIVE_DRAW":return"Pre Live Draw";case"PRE_DRAW":return"Pre Draw";default:return this.luckyDrawSubType}}},created:function(){var t=this.$route.query,e=t.drawOrder,a=t.fromNumber,i=t.toNumber,r=t.eventId,n=t.luckyDrawSubType;r&&(this.eventId=parseInt(r)),n&&(this.luckyDrawSubType=n),e&&(this.drawOrder=e.toUpperCase().replace("-","_")),a&&i&&(this.fromNumber=parseInt(a),this.toNumber=parseInt(i));for(var s=0;s<4;s++)this.mainDisplayDigits.push({current:"0",next:"0",isFlipping:!1}),this.winningDisplayDigits.push({current:"0",next:"0",isFlipping:!1})},mounted:function(){var t=this;this.channel=new BroadcastChannel("vue-global-events"),this.channel.onmessage=function(e){if("start"===e.data.action)t.prizeDescription=e.data.prizeName,t.requestDraw();else if("stop"===e.data.action){var a=e.data.winner.luckyNumber,i=e.data.winner.name;t.winnerName=i,t.stopCasinoAnimation(a)}else"refresh"===e.data.action&&(t.initializeDrawState(),t.winnerName=null,t.stopCasinoAnimation("0000"))},this.initializeDrawState(),this.$nextTick((function(){t.createConfetti()})),window.addEventListener("click",this.handleGlobalClick)},beforeDestroy:function(){this.animationTimers.forEach((function(t){return clearInterval(t)})),window.removeEventListener("click",this.handleGlobalClick)},methods:{initializeDrawState:function(){var t=this;return Object(_["a"])(Object(p["a"])().mark((function e(){return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getPrizeDetailsInfo();case 2:return e.next=4,t.fetchEligibleParticipants();case 4:return e.next=6,t.fetchExistingWinners();case 6:t.reconcileDrawData();case 7:case"end":return e.stop()}}),e)})))()},getPrizeDetailsInfo:function(){var t=this,e={ITEM:"VIEW_ALL",EVENT_SYS_ID:this.eventId};this.$apiCall.get(this.$apiBus.api_get_prize_info,{params:e}).then((function(e){e.status&&"true"===e.status&&Array.isArray(e.response)?(t.prizes=e.response.sort((function(t,e){return parseInt(t.PRIZE_POSITION,10)-parseInt(e.PRIZE_POSITION,10)})),console.log("this.prizes",t.prizes)):t.prizes=[]})).catch((function(t){console.error("Error fetching prizes:",t),Global.showErrorAlert(!0,"error","Failed to fetch prizes")})).finally((function(){}))},fetchEligibleParticipants:function(){var t=this;return Object(_["a"])(Object(p["a"])().mark((function e(){var a,i;return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.eventId&&t.luckyDrawSubType){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,a={ITEM:"SPECIFIC",ORGANIZATION_SYS_ID:"1",EVENT_SYS_ID:t.eventId,DRAW_TYPE:"Live Draw"},e.next=6,t.$apiCall.get(t.$apiBus.api_post_lucky_draw_participant_list,{params:a});case 6:i=e.sent,"true"===i.status&&Array.isArray(i.response)?t.participants=i.response:t.participants=[],e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](2),console.error("Error fetching eligible participants:",e.t0),t.participants=[];case 14:case"end":return e.stop()}}),e,null,[[2,10]])})))()},fetchExistingWinners:function(){var t=this;return Object(_["a"])(Object(p["a"])().mark((function e(){var a,i;return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.eventId){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,a={ITEM:"VIEW_ALL",EVENT_SYS_ID:t.eventId},e.next=6,t.$apiCall.get(t.$apiBus.api_get_winner_info,{params:a});case 6:i=e.sent,"true"===i.status&&Array.isArray(i.response)?t.existingWinners=i.response.filter((function(e){return e.LUCKY_DRAW_TYPE===t.apiLuckyDrawType})):t.existingWinners=[],e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](2),console.error("Error fetching existing winners:",e.t0),t.existingWinners=[];case 14:case"end":return e.stop()}}),e,null,[[2,10]])})))()},reconcileDrawData:function(){var t=new Set(this.existingWinners.map((function(t){return t.PARTICIPANTS_SYS_ID})));this.availableNumbers=this.participants.filter((function(e){return!t.has(e.PARTICIPANTS_SYS_ID)})),this.calculateNextPosition()},calculateNextPosition:function(){var t=this;if(this.existingWinners.length>0){var e=this.existingWinners.map((function(t){return parseInt(t.PRIZE_POSITION,10)}));"TOP_TO_BOTTOM"===this.drawOrder?this.currentPrizePosition=Math.max.apply(Math,Object(u["a"])(e))+1:this.currentPrizePosition=Math.min.apply(Math,Object(u["a"])(e))-1}else this.currentPrizePosition="TOP_TO_BOTTOM"===this.drawOrder?this.fromNumber:this.toNumber;var a=this.prizes.find((function(e){return e.PRIZE_POSITION==t.currentPrizePosition&&"Live Draw"===e.LUCKY_DRAW_TYPE}));console.log("winnerPrize",a),this.prizeDescription=null===a||void 0===a?void 0:a.PRIZE_NAME},toggleFullScreen:function(){if(document.fullscreenElement)document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen();else{var t=document.documentElement;t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()}},handleGlobalClick:function(t){t.target.closest(".fullscreen-btn, .result-popup")||this.channel.postMessage({action:"start"})},requestDraw:function(){this.isDrawing||(this.isDrawing=!0,this.winnerName="---",this.startCasinoAnimation())},getPrizeForPosition:function(t){return 1===t?"$200,000 Cash":t<=5?"$10,000 Cash":t<=20?"$200 Cash":"Consolation Prize"},getWinnerDetails:function(t){var e=this;return Object(_["a"])(Object(p["a"])().mark((function a(){var i,r;return Object(p["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i={ITEM:"SPECIFIC",WINNER_SYS_ID:t,EVENT_SYS_ID:e.eventId},a.prev=1,a.next=4,e.$apiCall.get(e.$apiBus.api_post_lucky_winner,{params:i});case 4:r=a.sent,"true"===r.status||r.success?e.existingWinners.push({PARTICIPANTS_SYS_ID:participant.PARTICIPANTS_SYS_ID,PRIZE_POSITION:e.currentPrizePosition,LUCKY_DRAW_NO:participant.LUCKY_DRAW_NO,LUCKY_DRAW_TYPE:e.apiLuckyDrawType}):console.error("Failed to save winner:",r),a.next=11;break;case 8:a.prev=8,a.t0=a["catch"](1),console.error("Error saving winner:",a.t0);case 11:case"end":return a.stop()}}),a,null,[[1,8]])})))()},saveWinner:function(t){var e=this;return Object(_["a"])(Object(p["a"])().mark((function a(){var i,r,n;return Object(p["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r={ITEM:"ADD",ORGANIZATION_SYS_ID:"1",PARTICIPANTS_SYS_ID:t.PARTICIPANTS_SYS_ID,EVENT_SYS_ID:e.eventId,LUCKY_DRAW_NO:t.LUCKY_DRAW_NO,LUCKY_DRAW_TYPE:e.apiLuckyDrawType,PRIZE_POSITION:e.currentPrizePosition,CREATED_BY:(null===(i=e.authUser)||void 0===i?void 0:i.UserId)||1},a.prev=1,a.next=4,e.$apiCall.post(e.$apiBus.api_post_lucky_winner,r);case 4:n=a.sent,"true"===n.status||n.success?e.getWinnerDetails(n.WINNER_SYS_ID):(console.error("Failed to save winner:",n),e.availableNumbers.push(t)),a.next=12;break;case 8:a.prev=8,a.t0=a["catch"](1),console.error("Error saving winner:",a.t0),e.availableNumbers.push(t);case 12:case"end":return a.stop()}}),a,null,[[1,8]])})))()},showResultPopupModal:function(t){var e=String(t).padStart(4,"0");this.winningDisplayDigits.forEach((function(t,a){return t.current=e[a]})),this.showResultPopup=!0,this.createCelebrationEffects()},closeResultPopup:function(){this.showResultPopup=!1,this.calculateNextPosition(),this.resetMainDisplay()},resetMainDisplay:function(){this.mainDisplayDigits.forEach((function(t){t.current="0",t.next="0",t.isFlipping=!1}))},getRankLabel:function(t){if(!t||t<=0)return"---";var e=t%10,a=t%100;return 1===e&&11!==a?t+"st Special Prize":2===e&&12!==a?t+"nd Special Prize":3===e&&13!==a?t+"rd Special Prize":t+"th Prize"},flipDigit:function(t,e){var a=String(e);t.current!==a&&(t.isFlipping&&(t.current=t.next),t.next=a,t.isFlipping=!0,setTimeout((function(){t.current=a,t.isFlipping=!1}),600))},startCasinoAnimation:function(){var t=this;this.animationTimers.forEach((function(t){return clearInterval(t)})),this.animationTimers=[];var e=setInterval((function(){if(t.availableNumbers.length>0){var e=Math.floor(Math.random()*t.availableNumbers.length),a=t.availableNumbers[e],i=String(a.LUCKY_DRAW_NO).padStart(4,"0");i.split("").forEach((function(e,a){var i=t.mainDisplayDigits[a];i.current!==e&&(i.current=e)}))}}),100);this.animationTimers.push(e)},stopCasinoAnimation:function(t){var e=this;this.isDrawing=!1,this.animationTimers.forEach((function(t){return clearInterval(t)})),this.animationTimers=[];var a=String(t).padStart(4,"0");a.split("").forEach((function(t,a){setTimeout((function(){e.flipDigit(e.mainDisplayDigits[a],t)}),400*a)}))},createConfetti:function(){},createCelebrationEffects:function(){},getRandomColor:function(){var t=["#FF6B6B","#4ECDC4","#45B7D1","#FFEAA7","#DDA0DD"];return t[Math.floor(Math.random()*t.length)]}}},L=S,O=(a("6be4"),a("2689"),Object(g["a"])(L,P,E,!1,null,"10174dba",null)),k=O.exports,x=function(){var t,e=this,a=e._self._c;return a("div",[a("div",{staticClass:"d-flex mt-3 justify-content-between align-items-center",staticStyle:{gap:"15px"}},[a("div",{staticClass:"search-container"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.participantSearchQuery,expression:"participantSearchQuery"}],staticClass:"search-input",attrs:{type:"text",placeholder:"Search by Name, Lucky Draw Number..."},domProps:{value:e.participantSearchQuery},on:{input:function(t){t.target.composing||(e.participantSearchQuery=t.target.value)}}}),e._m(0)]),a("div",[a("b-dropdown",{staticClass:"mr-2",attrs:{text:"Import",variant:"success",right:""}},[a("b-dropdown-item",{on:{click:e.showImportFromExcel}},[a("i",{staticClass:"fa fa-file-excel mr-2 text-success"}),e._v(" Import from Excel ")]),a("b-dropdown-item",{on:{click:e.importFromAttendees}},[a("i",{staticClass:"fa fa-users mr-2 text-primary"}),e._v(" Import from Attendee List ")])],1),a("button",{staticClass:"btn btn-info mr-2",on:{click:e.exportParticipants}},[a("i",{staticClass:"fa fa-file-export mr-2"}),e._v(" Export ")]),a("b-dropdown",{staticClass:"mr-2",attrs:{text:"Action",variant:"primary",right:"","toggle-class":"d-flex align-items-center"}},[a("b-dropdown-item",{on:{click:e.checkPrepareIncludeList}},[a("i",{staticClass:"fa fa-check-double mr-1 text-success"}),e._v("- Prepare Include List ")]),a("b-dropdown-item",{on:{click:e.checkAllParticipantsIn}},[a("i",{staticClass:"fa fa-check-square mr-1 text-success"}),e._v("- All Checked In ")]),a("b-dropdown-item",{on:{click:function(t){return e.includeAllDrawType("ALL_LIVE")}}},[a("i",{staticClass:"fa fa-bolt mr-1 text-warning"}),e._v("- All Live Draw Checked ")]),a("b-dropdown-item",{on:{click:function(t){return e.includeAllDrawType("ALL_PRE_LIVE")}}},[a("i",{staticClass:"fa fa-play-circle mr-1 text-info"}),e._v("- All Pre Live Checked ")]),a("b-dropdown-item",{on:{click:function(t){return e.includeAllDrawType("ALL_PRE_DRAW")}}},[a("i",{staticClass:"fa fa-random mr-1 text-primary"}),e._v("- All Pre Draw Checked ")])],1)],1)]),a("div",{staticClass:"stats-container sticky-stats"},[a("div",{staticClass:"stats-row d-flex"},e._l(e.statCards,(function(t){return a("div",{key:t.key,staticClass:"stats-card",class:{active:e.selectedFilter===t.key},on:{click:function(a){return e.toggleFilter(t.key)}}},[a("div",{staticClass:"label"},[e._v(e._s(t.label))]),a("div",{staticClass:"count"},[e._v(e._s(t.count))])])})),0)]),a("div",{staticClass:"table-responsive mt-1 fixed-header-table"},[a("b-table",{staticClass:"table-bordered sticky-table",attrs:{"head-variant":"light",bordered:"",hover:"",fields:e.participantFields,items:e.formattedParticipants,"show-empty":"",filter:(null===(t=e.participantSearchQuery)||void 0===t?void 0:t.length)>=3?e.participantSearchQuery:null},scopedSlots:e._u([{key:"cell(INDEX)",fn:function(t){return[a("div",{staticClass:"text-left"},[e._v(e._s(t.index+1))])]}},e._l(["LUCKY_DRAW_NO","PARTICIPANT_NAME","PARTICIPANT_EMAIL","PARTICIPANT_CONTACT_NO","TABLE_NO","STATUS"],(function(t){return{key:"cell(".concat(t,")"),fn:function(i){return[a("div",{staticClass:"text-left"},[e._v(e._s(i.item[t]?i.item[t]:"-"))])]}}})),{key:"cell(CHECKED_IN)",fn:function(t){return[a("b-form-checkbox",{attrs:{checked:1===t.item.CHECKED_IN},on:{change:function(a){t.item.CHECKED_IN=a?1:0,e.updateCheckedIn(t.item)}}})]}},{key:"cell(DRAW_TYPE)",fn:function(t){return[a("div",{staticClass:"d-flex flex-column"},[a("label",{staticClass:"d-flex align-items-center mb-1"},[a("b-form-checkbox",{staticClass:"mr-2",attrs:{checked:1===t.item.LIVE},on:{change:function(a){t.item.LIVE=a?1:0,e.updateDrawType(t.item)}}}),a("span",[e._v("Live")])],1),a("label",{staticClass:"d-flex align-items-center mb-1"},[a("b-form-checkbox",{staticClass:"mr-2",attrs:{checked:1===t.item.PRE_LIVE},on:{change:function(a){t.item.PRE_LIVE=a?1:0,e.updateDrawType(t.item)}}}),a("span",[e._v("Pre-Live")])],1),a("label",{staticClass:"d-flex align-items-center mb-1"},[a("b-form-checkbox",{staticClass:"mr-2",attrs:{checked:1===t.item.PRE_DRAW},on:{change:function(a){t.item.PRE_DRAW=a?1:0,e.updateDrawType(t.item)}}}),a("span",[e._v("Pre-Draw")])],1)])]}},{key:"cell(STATUS)",fn:function(t){var i,r;return[a("span",{staticClass:"status-badge",class:{"status-included":"included"===(null===(i=t.item.STATUS)||void 0===i?void 0:i.toLowerCase()),"status-excluded":"excluded"===(null===(r=t.item.STATUS)||void 0===r?void 0:r.toLowerCase())}},[e._v(" "+e._s(t.item.STATUS)+" ")])]}},{key:"cell(ACTION)",fn:function(t){return[a("div",{staticClass:"justify-content-center"},[t.item.STATUS?["Included"===t.item.STATUS?a("button",{staticClass:"btn btn-danger btn-sm",on:{click:function(a){return e.excludeAllDrawTypes(t.item,!1)}}},[a("i",{staticClass:"fa fa-times mr-1"}),e._v(" Exclude ")]):a("button",{staticClass:"btn btn-success btn-sm",on:{click:function(a){return e.includeAllDrawTypes(t.item,!0)}}},[a("i",{staticClass:"fa fa-plus mr-1"}),e._v(" Include ")])]:[a("button",{staticClass:"btn btn-danger btn-sm",on:{click:function(a){return e.excludeAllDrawTypes(t.item,!1)}}},[a("i",{staticClass:"fa fa-times mr-1"}),e._v(" Exclude ")]),a("button",{staticClass:"btn btn-success btn-sm mt-1",on:{click:function(a){return e.includeAllDrawTypes(t.item,!0)}}},[a("i",{staticClass:"fa fa-plus mr-1"}),e._v(" Include ")])],a("button",{staticClass:"btn btn-outline-danger btn-sm ml-2",on:{click:function(a){return e.confirmDeleteParticipant(t.item)}}},[a("i",{staticClass:"fa fa-trash"})])],2)]}}],null,!0)})],1),a("b-modal",{ref:"participantImportModal",attrs:{size:"xl",title:"Import Participants","hide-footer":"","modal-class":"upload-excel-modal"},model:{value:e.showParticipantImportModal,callback:function(t){e.showParticipantImportModal=t},expression:"showParticipantImportModal"}},[a("div",{staticClass:"d-flex justify-content-between align-items-center mb-3 mt-0"},[a("div",[a("p",{staticClass:"mb-0 font-weight-bold text-muted",staticStyle:{"font-size":"15px"}},[e._v("Import Participants from Excel")]),a("p",{staticClass:"mb-0",staticStyle:{"font-size":"13px"}},[e._v("Upload an Excel file containing participant information")])]),a("div",{staticClass:"d-flex"},[a("b-button",{staticClass:"mr-2",attrs:{size:"sm",variant:"warning"},on:{click:e.triggerParticipantFileInput}},[a("i",{staticClass:"fas fa-upload mr-1"}),e._v(" Upload Excel ")]),e._v("   "),a("b-button",{attrs:{size:"sm",variant:"primary"},on:{click:e.downloadParticipantFormat}},[a("i",{staticClass:"fas fa-download mr-1"}),e._v(" Download Format ")]),a("input",{ref:"participantFileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:".xlsx, .xls"},on:{change:e.handleParticipantFileUpload}})],1)]),a("hr"),e.participantExcelData.length>0?a("div",[a("h6",{staticClass:"mb-2 text-primary"},[e._v(" Preview Uploaded Data ("+e._s(e.participantExcelData.length)+" records) ")]),a("div",{staticClass:"table-responsive"},[a("b-table",{attrs:{items:e.participantExcelData,fields:e.participantTableFields,striped:"",bordered:"",hover:"",responsive:"sm"}})],1),a("div",{staticClass:"mt-3"},[a("b-button",{staticClass:"mr-2 float-left",attrs:{variant:"success",disabled:e.isImportingParticipants},on:{click:e.onHandleImportParticipantData}},[a("i",{staticClass:"fas fa-check mr-1"}),e._v(" "+e._s(e.isImportingParticipants?"Importing...":"Import Data")+" ")]),e._v("   "),a("b-button",{staticClass:"float-right ml-2",staticStyle:{float:"inline-end"},attrs:{variant:"danger"},on:{click:e.cancelParticipantUpload}},[a("i",{staticClass:"fas fa-times mr-1"}),e._v(" Cancel ")])],1)]):a("div",{staticClass:"text-center text-muted py-5"},[a("i",{staticClass:"fas fa-file-excel fa-3x mb-3 text-secondary"}),a("p",{staticClass:"mb-1",staticStyle:{"font-size":"13px"}},[e._v("No Excel file uploaded yet.")]),a("small",{staticStyle:{color:"red"}},[e._v("Please upload an Excel file to preview and import participant data.")]),a("br"),a("br"),a("small",{staticClass:"text-info"},[a("strong",[e._v("Expected format:")]),e._v(" Lucky Draw Number, Participant Name ")])])])],1)},W=[function(){var t=this,e=t._self._c;return e("button",{staticClass:"search-button"},[e("i",{staticClass:"fa fa-search"})])}],M=a("dd9a"),z=a("9eaa"),Y={components:{BDropdown:M["a"],BDropdownItem:z["a"]},data:function(){var t;return t={participants:[],selectedFilter:"ALL",showActionDropdown:!1,isImportingParticipants:!1,participantsDataLoaded:!1,participantSearchQuery:"",showParticipantImportModal:!1,participantFields:[{key:"INDEX",label:"S/N"},{key:"LUCKY_DRAW_NO",label:"Lucky Draw Number"},{key:"PARTICIPANT_NAME",label:"Participant Name"},{key:"PARTICIPANT_EMAIL",label:"Email"},{key:"PARTICIPANT_CONTACT_NO",label:"Contact Number"},{key:"DEPARTMENT",label:"Department"},{key:"TABLE_NO",label:"Table Number"},{key:"CHECKED_IN",label:"Checked In"},{key:"DRAW_TYPE",label:"Draw Type",thStyle:{width:"120px"}},{key:"STATUS",label:"Status"},{key:"ACTION",label:"Action"}],participantTableFields:[{key:"S_NO",label:"S/N"},{key:"LUCKY_DRAW_NO",label:"Lucky Draw Number"},{key:"PARTICIPANT_NAME",label:"Participant Name"},{key:"PARTICIPANT_EMAIL",label:"Email"},{key:"PARTICIPANT_CONTACT_NO",label:"Contact Number"},{key:"TABLE_NO",label:"Table Number"},{key:"DEPARTMENT",label:"Department"},{key:"CHECKED_IN",label:"Checked In"},{key:"LIVE",label:"Live"},{key:"PRE_DRAW",label:"Pre Draw"},{key:"PRE_LIVE",label:"Pre Live"},{key:"INCLUDE_EXCLUDE",label:"Include Exclude"}],participantExcelData:[],isLoading:!1,event_sys_id:null,specific_event_details:{},showBeneficiaryModal:!1},Object(l["a"])(t,"participants",[]),Object(l["a"])(t,"participantsDataLoaded",!1),Object(l["a"])(t,"isImporting",!1),Object(l["a"])(t,"participantSearchQuery",""),t},mounted:function(){this.channel=new BroadcastChannel("vue-global-events"),this.event_sys_id=JSON.parse(localStorage.getItem("selectedEventSysId"))||6;var t=JSON.parse(localStorage.getItem("userInfo"));this.user_sys_id=(null===t||void 0===t?void 0:t.user_id)||1,this.getSpecificEvent(),this.getParticipantDetailsInfo()},computed:Object(l["a"])({_filteredParticipants:function(){if(!this.participantSearchQuery||""===this.participantSearchQuery.trim())return this.participants;var t=this.participantSearchQuery.toLowerCase().trim();return this.participants.filter((function(e){var a=(e.PERSON_NAME||"").toLowerCase(),i=(e.PERSON_EMAIL||"").toLowerCase(),r=(e.PERSON_CONTACT_NO||"").toString().toLowerCase();return a.includes(t)||i.includes(t)||r.includes(t)}))},formattedParticipants:function(){return this.participants.map((function(t){var e,a,i,r,n,s,l,o,c,u,p,_,v,f;return Object(d["a"])(Object(d["a"])({},t),{},{LUCKY_DRAW_NO:null!==(e=t.LUCKY_DRAW_NO)&&void 0!==e?e:"-",PARTICIPANT_NAME:null!==(a=t.PARTICIPANT_NAME)&&void 0!==a?a:"-",PARTICIPANT_EMAIL:null!==(i=t.PARTICIPANT_EMAIL)&&void 0!==i?i:"-",PARTICIPANT_CONTACT_NO:null!==(r=t.PARTICIPANT_CONTACT_NO)&&void 0!==r?r:"-",TABLE_NO:null!==(n=t.TABLE_NO)&&void 0!==n?n:"-",CHECKED_IN:null!==(s=t.CHECKED_IN)&&void 0!==s?s:0,LIVE:null!==(l=t.LIVE)&&void 0!==l?l:0,PRE_LIVE:null!==(o=t.PRE_LIVE)&&void 0!==o?o:0,PRE_DRAW:null!==(c=t.PRE_DRAW)&&void 0!==c?c:0,DOOR_GIFT:null!==(u=t.DOOR_GIFT)&&void 0!==u?u:0,SPINNING_WHEEL:null!==(p=t.SPINNING_WHEEL)&&void 0!==p?p:0,EARLY_BIRD_DRAW:null!==(_=t.EARLY_BIRD_DRAW)&&void 0!==_?_:0,DEPARTMENT:null!==(v=t.DEPARTMENT)&&void 0!==v?v:"-",INCLUDE_EXCLUDE:null!==(f=t.INCLUDE_EXCLUDE)&&void 0!==f?f:"-"})}))},statCards:function(){return[{label:"Total",key:"ALL",count:this.participants.length},{label:"Checked-in",key:"CHECKED_IN",count:this.participants.filter((function(t){return 1==t.CHECKED_IN})).length},{label:"Included",key:"INCLUDED",count:this.participants.filter((function(t){return"Included"===t.STATUS})).length},{label:"Excluded",key:"EXCLUDED",count:this.participants.filter((function(t){return"Excluded"===t.STATUS})).length},{label:"Live",key:"LIVE",count:this.participants.filter((function(t){return 1==t.LIVE})).length},{label:"Pre-Live",key:"PRE_LIVE",count:this.participants.filter((function(t){return 1==t.PRE_LIVE})).length},{label:"Pre-Draw",key:"PRE_DRAW",count:this.participants.filter((function(t){return 1==t.PRE_DRAW})).length}]}},"formattedParticipants",(function(){var t=this;return"ALL"===this.selectedFilter?this.participants:"CHECKED_IN"===this.selectedFilter?this.participants.filter((function(t){return 1==t.CHECKED_IN})):"INCLUDED"===this.selectedFilter?this.participants.filter((function(t){return"Included"===t.STATUS})):"EXCLUDED"===this.selectedFilter?this.participants.filter((function(t){return"Excluded"===t.STATUS})):this.participants.filter((function(e){return 1==e[t.selectedFilter]}))})),methods:(i={toggleFilter:function(t){this.selectedFilter=this.selectedFilter===t?"ALL":t},hasAnyDrawTypeSelected:function(t){return 1==t.LIVE||1==t.PRE_LIVE||1==t.PRE_DRAW},_checkAllParticipantsIn:function(){var t=this;this.formattedParticipants.forEach((function(e){e.CHECKED_IN=!0,t.updateCheckedIn(e)}))}},Object(l["a"])(i,"hasAnyDrawTypeSelected",(function(t){return t.LIVE||t.PRE_LIVE||t.PRE_DRAW||t.DOOR_GIFT})),Object(l["a"])(i,"toggleActionDropdown",(function(){this.showActionDropdown=!this.showActionDropdown})),Object(l["a"])(i,"onDropdownHide",(function(){this.showActionDropdown=!1})),Object(l["a"])(i,"toggleIncludeExclude",(function(t,e){e?(t.LIVE=1,t.PRE_LIVE=1,t.PRE_DRAW=1,t.DOOR_GIFT=1,t.EARLY_BIRD_DRAW=1,t.SPINNING_WHEEL=1):(t.LIVE=0,t.PRE_LIVE=0,t.PRE_DRAW=0,t.DOOR_GIFT=0,t.EARLY_BIRD_DRAW=0,t.SPINNING_WHEEL=0),this.updateDrawType(t)})),Object(l["a"])(i,"getSpecificEvent",(function(){var t=this;D.a.start(),D.a.set(.1),this.isLoading=!0;var e={ITEM:"SPECIFIC",EVENT_SYS_ID:this.event_sys_id};this.$apiCall.get(this.$apiBus.api_get_specific_event_info,{params:e}).then((function(e){"true"==e.status&&(t.specific_event_details=e.response[0])})).finally((function(){t.isLoading=!1,D.a.done()}))})),Object(l["a"])(i,"getParticipantDetailsInfo",(function(){var t=this;D.a.start(),D.a.set(.1),this.isLoading=!0;var e={ITEM:"VIEW_ALL",EVENT_SYS_ID:this.event_sys_id};this.$apiCall.get(this.$apiBus.api_get_participant_info,{params:e}).then((function(e){e.status&&"true"===e.status&&(t.participants=e.response.map((function(t){return Object(d["a"])({},t)})),t.participantsDataLoaded=!0)})).catch((function(t){console.error("Error fetching participants:",t),m["a"].showErrorAlert(!0,"error","Failed to fetch participants")})).finally((function(){t.isLoading=!1,D.a.done()}))})),Object(l["a"])(i,"exportParticipants",(function(){var t=["S/N","Lucky Draw Number","Participant Name","Email","Contact Number","Table Number","Checked In","Live","Pre-Live","Pre-Draw"],e=this.filteredParticipants.map((function(t,e){return{SN:e+1,LUCKY_DRAW_NO:t.LUCKY_DRAW_NO||"",PARTICIPANT_NAME:t.PARTICIPANT_NAME||t.PERSON_NAME||"",EMAIL:t.PARTICIPANT_EMAIL||"",CONTACT_NO:t.PARTICIPANT_CONTACT_NO||"",TABLE_NO:t.TABLE_NO||"",CHECKED_IN:1==t.CHECKED_IN?"Y":"N",LIVE:1==t.LIVE?"Y":"N",PRE_LIVE:1==t.PRE_LIVE?"Y":"N",PRE_DRAW:1==t.PRE_DRAW?"Y":"N"}})),a=["SN","LUCKY_DRAW_NO","PARTICIPANT_NAME","EMAIL","CONTACT_NO","TABLE_NO","CHECKED_IN","LIVE","PRE_LIVE","PRE_DRAW"],i=this.formatJson(a,e),r=this.specific_event_details.EVENT_NAME?"".concat(this.specific_event_details.EVENT_NAME,"_Participants"):"Lucky_Draw_Participants";this.generateXlsx(t,i,r)})),Object(l["a"])(i,"generateXlsx",(function(t,e,a){var i=h["c"].aoa_to_sheet([t].concat(Object(u["a"])(e))),r=h["c"].book_new();h["c"].book_append_sheet(r,i,"Sheet1");var n=a.replace(/[^a-z0-9_-\s]/gi,"_");h["e"](r,"".concat(n,".xlsx"))})),Object(l["a"])(i,"triggerParticipantFileInput",(function(){this.participantExcelData=[],this.$refs.participantFileInput.value="",this.$refs.participantFileInput.click()})),Object(l["a"])(i,"downloadParticipantFormat",(function(){var t=[["Lucky Draw Number","Participant Name","Email","Contact Number","Table Number","Department","Checked In","Live","Pre-Live","Pre-Draw","Include_Exclude"],["8157","John Doe","john.doe@example.com","9876543210","T1","IT","N","Y","Y","Y","Y"],["8158","Jane Smith","jane.smith@example.com","9123456780","T2","Human Resource","N","Y","Y","Y","Y"]],e=h["c"].book_new(),a=h["c"].aoa_to_sheet(t);h["c"].book_append_sheet(e,a,"Participants Format"),h["e"](e,"Participants_Format.xlsx")})),Object(l["a"])(i,"handleParticipantFileUpload",(function(t){var e=this,a=t.target.files[0];if(a){var i=new FileReader;i.onload=function(t){try{var a=new Uint8Array(t.target.result),i=h["b"](a,{type:"array"}),r=i.Sheets[i.SheetNames[0]],n=h["c"].sheet_to_json(r);e.participantExcelData=n.map((function(t,e){var a,i=Object.keys(t).reduce((function(e,a){return e[a.trim().toLowerCase()]=t[a],e}),{});return{S_NO:i["s/n"]||i["no"]||i["sl no"]||i["serial no"]||e+1,LUCKY_DRAW_NO:i["lucky draw number"]||i["luckydrawnumber"]||i["lucky_draw_no"]||i["draw no"]||i["drawnumber"]||"",PARTICIPANT_NAME:i["participant name"]||i["participantname"]||i["participant_name"]||i["name"]||"",PARTICIPANT_EMAIL:i["email"]||i["participant email"]||i["mail id"]||"",PARTICIPANT_CONTACT_NO:i["contact number"]||i["participant contact number"]||i["mobile"]||i["phone"]||"",TABLE_NO:i["table number"]||i["table no"]||i["table"]||"",LUCKY_DRAW_AVAILABILITY:Object.keys(i).find((function(t){return t.includes("lucky")&&t.includes("draw")&&(t.includes("availability")||t.includes("avail")||t.includes("y/n"))}))?i[Object.keys(i).find((function(t){return t.includes("lucky")&&t.includes("draw")&&(t.includes("availability")||t.includes("avail")||t.includes("y/n"))}))]:"",LIVE:null!==(a=i["live"])&&void 0!==a?a:0,DOOR_GIFT:i["door gift"]||i["doorgift"]||0,CHECKED_IN:i["checked in"]||i["checked_in"]||0,SPINNING_WHEEL:i["spinning wheel"]||i["spinning_wheel"]||0,EARLY_BIRD_DRAW:Object.keys(i).find((function(t){return t.includes("early")&&t.includes("bird")}))?i[Object.keys(i).find((function(t){return t.includes("early")&&t.includes("bird")}))]:0,PRE_DRAW:Object.keys(i).find((function(t){return t.includes("pre")&&t.includes("draw")}))?i[Object.keys(i).find((function(t){return t.includes("pre")&&t.includes("draw")}))]:0,PRE_LIVE:Object.keys(i).find((function(t){return t.includes("pre")&&t.includes("live")}))?i[Object.keys(i).find((function(t){return t.includes("pre")&&t.includes("live")}))]:0,DEPARTMENT:Object.keys(i).find((function(t){return t.toLowerCase().includes("depart")&&t.toLowerCase().includes("ment")}))?i[Object.keys(i).find((function(t){return t.toLowerCase().includes("depart")&&t.toLowerCase().includes("ment")}))]:0,INCLUDE_EXCLUDE:Object.keys(i).find((function(t){return t.toLowerCase().includes("include")&&t.toLowerCase().includes("exclude")}))?i[Object.keys(i).find((function(t){return t.toLowerCase().includes("include")&&t.toLowerCase().includes("exclude")}))]:0}})).filter((function(t){var e,a;return(null===(e=t.PARTICIPANT_NAME)||void 0===e?void 0:e.toString().trim())&&(null===(a=t.LUCKY_DRAW_NO)||void 0===a?void 0:a.toString().trim())})),0===e.participantExcelData.length&&m["a"].showErrorAlert(!0,"error","No valid participant data found in Excel file.")}catch(s){console.error("Error processing Excel file:",s),m["a"].showErrorAlert(!0,"error","Error processing Excel file"),e.participantExcelData=[]}},i.readAsArrayBuffer(a)}})),Object(l["a"])(i,"updateCheckedIn",(function(t){var e=this;return Object(_["a"])(Object(p["a"])().mark((function a(){var i,r;return Object(p["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return D.a.start(),D.a.set(.1),a.prev=2,i={ITEM:"UPDATE_CHECKED_IN",PARTICIPANTS_SYS_ID:t.PARTICIPANTS_SYS_ID,CHECKED_IN:t.CHECKED_IN,EVENT_SYS_ID:e.event_sys_id},a.next=6,e.$apiCall.post(e.$apiBus.api_post_lucky_draw_participant,i);case 6:r=a.sent,("true"===r.status||r.success)&&e.getParticipantDetailsInfo(),a.next=14;break;case 10:a.prev=10,a.t0=a["catch"](2),console.error("Error updating CHECKED_IN:",a.t0),m["a"].showErrorAlert(!0,"error","Error during check-in update");case 14:return a.prev=14,D.a.done(),a.finish(14);case 17:case"end":return a.stop()}}),a,null,[[2,10,14,17]])})))()})),Object(l["a"])(i,"updateDrawType",(function(t){var e=this;return Object(_["a"])(Object(p["a"])().mark((function a(){var i,r;return Object(p["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return D.a.start(),D.a.set(.1),a.prev=2,i={ITEM:"UPDATE_DRAW_TYPE",PARTICIPANTS_SYS_ID:t.PARTICIPANTS_SYS_ID,EVENT_SYS_ID:e.event_sys_id,LIVE:t.LIVE,PRE_LIVE:t.PRE_LIVE,PRE_DRAW:t.PRE_DRAW,EARLY_BIRD_DRAW:t.EARLY_BIRD_DRAW,SPINNING_WHEEL:t.SPINNING_WHEEL,DOOR_GIFT:t.DOOR_GIFT},a.next=6,e.$apiCall.post(e.$apiBus.api_post_lucky_draw_participant,i);case 6:r=a.sent,("true"===r.status||r.success)&&e.getParticipantDetailsInfo(),a.next=14;break;case 10:a.prev=10,a.t0=a["catch"](2),console.error("Error updating draw type:",a.t0),m["a"].showErrorAlert(!0,"error","Error during draw type update");case 14:return a.prev=14,D.a.done(),a.finish(14);case 17:case"end":return a.stop()}}),a,null,[[2,10,14,17]])})))()})),Object(l["a"])(i,"convertYN",(function(t){if(!t)return 0;var e=t.toString().trim().toLowerCase();return"y"===e||"yes"===e||"1"===e?1:0})),Object(l["a"])(i,"onHandleImportParticipantData",(function(){var t=this;return Object(_["a"])(Object(p["a"])().mark((function e(){var a,i;return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!==t.participantExcelData.length){e.next=3;break}return m["a"].showErrorAlert(!0,"error","No data to import"),e.abrupt("return");case 3:return t.isImportingParticipants=!0,D.a.start(),D.a.set(.1),e.prev=6,a=t.participantExcelData.map((function(e){var a;return{ITEM:"ADD",PARTICIPANTS_SYS_ID:"0",EVENT_SYS_ID:t.event_sys_id,LUCKY_DRAW_NO:e.LUCKY_DRAW_NO||"",PARTICIPANT_NAME:e.PARTICIPANT_NAME||"",PARTICIPANT_EMAIL:e.PARTICIPANT_EMAIL||"",PARTICIPANT_CONTACT_NO:e.PARTICIPANT_CONTACT_NO||"",TABLE_NO:e.TABLE_NO||"",DEPARTMENT:e.DEPARTMENT||"",LUCKY_DRAW_AVAILABILITY:t.convertYN(e.LUCKY_DRAW_AVAILABILITY),LIVE:t.convertYN(e.LIVE),PRE_DRAW:t.convertYN(e.PRE_DRAW),PRE_LIVE:t.convertYN(e.PRE_LIVE),CHECKED_IN:t.convertYN(e.CHECKED_IN),INCLUDE_EXCLUDE:t.convertYN(e.INCLUDE_EXCLUDE),CREATED_BY:(null===(a=t.getAuthUser)||void 0===a?void 0:a.UserId)||"1",ORGANIZATION_SYS_ID:"1"}})),e.next=10,t.$apiCall.post(t.$apiBus.api_post_lucky_draw_participant,a);case 10:i=e.sent,("true"===i.status||i.success)&&t.getParticipantDetailsInfo(),t.showParticipantImportModal=!1,t.participantExcelData=[],t.$refs.participantFileInput.value="",e.next=21;break;case 17:e.prev=17,e.t0=e["catch"](6),console.error("Import error:",e.t0),m["a"].showErrorAlert(!0,"error","Error importing participant data");case 21:return e.prev=21,t.isImportingParticipants=!1,D.a.done(),e.finish(21);case 25:case"end":return e.stop()}}),e,null,[[6,17,21,25]])})))()})),Object(l["a"])(i,"checkPrepareIncludeList",(function(){var t=this;return Object(_["a"])(Object(p["a"])().mark((function e(){var a,i;return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return D.a.start(),D.a.set(.1),e.prev=2,a={ITEM:"PREPARE_INCLUDED_LIST",EVENT_SYS_ID:t.event_sys_id},e.next=6,t.$apiCall.post(t.$apiBus.api_post_lucky_draw_participant,a);case 6:i=e.sent,("true"===i.status||i.success)&&t.getParticipantDetailsInfo(),e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](2),console.error("Import error:",e.t0),m["a"].showErrorAlert(!0,"error","Error during check-in");case 14:return e.prev=14,D.a.done(),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[2,10,14,17]])})))()})),Object(l["a"])(i,"checkAllParticipantsIn",(function(){var t=this;return Object(_["a"])(Object(p["a"])().mark((function e(){var a,i;return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return D.a.start(),D.a.set(.1),e.prev=2,a={ITEM:"ALL_CHECKED_IN",PARTICIPANTS_SYS_ID:"0",EVENT_SYS_ID:t.event_sys_id},e.next=6,t.$apiCall.post(t.$apiBus.api_post_lucky_draw_participant,a);case 6:i=e.sent,("true"===i.status||i.success)&&t.getParticipantDetailsInfo(),e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](2),console.error("Import error:",e.t0),m["a"].showErrorAlert(!0,"error","Error during check-in");case 14:return e.prev=14,D.a.done(),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[2,10,14,17]])})))()})),Object(l["a"])(i,"importFromAttendees",(function(){var t=this;return Object(_["a"])(Object(p["a"])().mark((function e(){var a,i;return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return D.a.start(),D.a.set(.1),e.prev=2,a={ITEM:"ADD_FROM_ATTENDEES",EVENT_SYS_ID:t.event_sys_id},e.next=6,t.$apiCall.post(t.$apiBus.api_post_lucky_draw_participant,a);case 6:i=e.sent,("true"===i.status||i.success)&&t.getParticipantDetailsInfo(),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](2),console.error("Import error:",e.t0);case 13:return e.prev=13,D.a.done(),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[2,10,13,16]])})))()})),Object(l["a"])(i,"includeAllDrawTypes",(function(t){var e=this;return Object(_["a"])(Object(p["a"])().mark((function a(){var i,r;return Object(p["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return D.a.start(),D.a.set(.1),a.prev=2,i={ITEM:"INCLUDE_ALL_DRAW_TYPE",PARTICIPANTS_SYS_ID:t.PARTICIPANTS_SYS_ID,EVENT_SYS_ID:e.event_sys_id},a.next=6,e.$apiCall.post(e.$apiBus.api_post_lucky_draw_participant,i);case 6:r=a.sent,("true"===r.status||r.success)&&e.getParticipantDetailsInfo(),a.next=14;break;case 10:a.prev=10,a.t0=a["catch"](2),console.error("Include error:",a.t0),m["a"].showErrorAlert(!0,"error","Error while including draw types");case 14:return a.prev=14,D.a.done(),a.finish(14);case 17:case"end":return a.stop()}}),a,null,[[2,10,14,17]])})))()})),Object(l["a"])(i,"confirmDeleteParticipant",(function(t){var e=this;this.$bvModal.msgBoxConfirm("Are you sure you want to delete this participant?",{title:"Confirm Delete",size:"sm",okVariant:"danger",okTitle:"Yes",cancelTitle:"No",footerClass:"p-2",centered:!0}).then((function(a){a&&e.deleteParticipant(t)})).catch((function(t){console.error("Modal error:",t)}))})),Object(l["a"])(i,"deleteParticipant",(function(t){var e=this;return Object(_["a"])(Object(p["a"])().mark((function a(){var i,r;return Object(p["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return D.a.start(),D.a.set(.1),a.prev=2,i={ITEM:"DELETE_PARTICIPANTS",PARTICIPANTS_SYS_ID:t.PARTICIPANTS_SYS_ID,EVENT_SYS_ID:e.event_sys_id},a.next=6,e.$apiCall.post(e.$apiBus.api_post_lucky_draw_participant,i);case 6:r=a.sent,("true"===r.status||r.success)&&e.getParticipantDetailsInfo(),a.next=14;break;case 10:a.prev=10,a.t0=a["catch"](2),console.error("Delete error:",a.t0),m["a"].showErrorAlert(!0,"error","Error while deleting participant");case 14:return a.prev=14,D.a.done(),a.finish(14);case 17:case"end":return a.stop()}}),a,null,[[2,10,14,17]])})))()})),Object(l["a"])(i,"excludeAllDrawTypes",(function(t){var e=this;return Object(_["a"])(Object(p["a"])().mark((function a(){var i,r;return Object(p["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return D.a.start(),D.a.set(.1),a.prev=2,i={ITEM:"EXCLUDE_DRAW_TYPE",PARTICIPANTS_SYS_ID:t.PARTICIPANTS_SYS_ID,EVENT_SYS_ID:e.event_sys_id},a.next=6,e.$apiCall.post(e.$apiBus.api_post_lucky_draw_participant,i);case 6:r=a.sent,("true"===r.status||r.success)&&e.getParticipantDetailsInfo(),a.next=14;break;case 10:a.prev=10,a.t0=a["catch"](2),console.error("Exclude error:",a.t0),m["a"].showErrorAlert(!0,"error","Error while excluding draw types");case 14:return a.prev=14,D.a.done(),a.finish(14);case 17:case"end":return a.stop()}}),a,null,[[2,10,14,17]])})))()})),Object(l["a"])(i,"cancelParticipantUpload",(function(){this.showParticipantImportModal=!1,this.participantExcelData=[],this.$refs.participantFileInput.value=""})),Object(l["a"])(i,"includeAllDrawType",(function(t){var e=this;return Object(_["a"])(Object(p["a"])().mark((function a(){var i,r;return Object(p["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return D.a.start(),D.a.set(.1),a.prev=2,i={ITEM:"INCLUDE_DRAW_TYPE",ACTION:t,EVENT_SYS_ID:e.event_sys_id},a.next=6,e.$apiCall.post(e.$apiBus.api_post_lucky_draw_participant,i);case 6:r=a.sent,("true"===r.status||r.success)&&e.getParticipantDetailsInfo(),a.next=14;break;case 10:a.prev=10,a.t0=a["catch"](2),console.error("Error updating draw type:",a.t0),m["a"].showErrorAlert(!0,"error","Error updating draw type");case 14:return a.prev=14,D.a.done(),a.finish(14);case 17:case"end":return a.stop()}}),a,null,[[2,10,14,17]])})))()})),Object(l["a"])(i,"showImportFromExcel",(function(){this.showParticipantImportModal=!0})),Object(l["a"])(i,"showImportFromAttendee",(function(){this.showAttendeeListModal=!0})),i)},U=Y,F=(a("3c58"),Object(g["a"])(U,x,W,!1,null,null,null)),B=F.exports,j=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"row"},[t._m(0),e("div",{staticClass:"col-md-2"},[e("b-button",{attrs:{variant:"primary",size:"lg"}},[e("i",{staticClass:"fas fa-play mr-2"}),t._v("Start Live Draw ")])],1)]),e("div",{staticClass:"row mt-2"},[e("div",{staticClass:"col-md-12"},[e("div",{staticClass:"prize-ranks-container"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-9"},[t._m(1),e("p",{staticStyle:{color:"#fff","margin-left":"2rem !important"}},[t._v("Total Positions: "+t._s(t.totalPrizePositions))])]),t._m(2)]),e("div",{staticClass:"prize-boxes-grid"},t._l(t.totalPrizePositions,(function(a){return e("div",{key:a,staticClass:"prize-box",class:{"prize-box-filled":t.isRankFilled(a)}},[e("div",{staticClass:"prize-rank-number"},[t._v(t._s(a))]),e("div",{staticClass:"prize-rank-label"},[t._v(t._s(t.getRankLabel(a)))])])})),0)])]),e("div",{staticClass:"col-md-12"})]),e("b-modal",{attrs:{id:"winningModalForLiveDraw","hide-footer":"","hide-header":"",centered:"","content-class":"bg-transparent border-0","body-class":"p-0"},on:{hidden:t.resetWinnerModal}},[e("div",{staticClass:"flipper-display-section"},[e("div",{staticClass:"winner-display-grid"},[e("div",{staticClass:"display-box"},[e("div",{staticClass:"box-content prize-position"},[t._v(" "+t._s(t.getRankLabel(t.currentPrizePosition))+" ")]),e("div",{staticClass:"box-content prize-description"},[t._v(" "+t._s(t.currentWinner&&t.currentWinner.prize?t.currentWinner.prize.PRIZE_NAME:"...")+" ")])]),e("div",{staticClass:"display-box lucky-draw-box"},[e("div",{staticClass:"box-content"},[e("div",{staticClass:"main-flipper-display",class:{disabled:t.isDrawing}},t._l(t.mainDisplayDigits,(function(a,i){return e("div",{key:"main-".concat(i),staticClass:"flip-card"},[e("div",{staticClass:"flipper",class:{flip:a.isFlipping}},[e("div",{staticClass:"card-face front"},[e("div",{staticClass:"flip-card-inner"},[e("div",{staticClass:"flip-card-top"},[e("span",[t._v(t._s(a.current))])]),e("div",{staticClass:"flip-card-bottom"},[e("span",[t._v(t._s(a.current))])]),e("div",{staticClass:"flip-card-divider"})])]),e("div",{staticClass:"card-face back"},[e("div",{staticClass:"flip-card-inner"},[e("div",{staticClass:"flip-card-top"},[e("span",[t._v(t._s(a.next))])]),e("div",{staticClass:"flip-card-bottom"},[e("span",[t._v(t._s(a.next))])]),e("div",{staticClass:"flip-card-divider"})])])])])})),0)])]),e("div",{staticClass:"display-box"},[e("div",{staticClass:"box-content winner-name"},[t._v(" "+t._s(!t.isDrawing&&t.currentWinner&&t.currentWinner.participant?t.currentWinner.participant.PARTICIPANT_NAME:"...")+" ")])]),e("div",{staticClass:"actions-container"},[e("button",{staticClass:"action-btn cancel-btn",on:{click:function(e){return t.$bvModal.hide("winningModalForLiveDraw")}}},[e("i",{staticClass:"fas fa-times"}),t._v(" Cancel")]),e("button",{staticClass:"action-btn confirm-btn",on:{click:t.requestDraw}},[e("i",{staticClass:"fas fa-check"}),t._v(" Start")])])]),t.currentWinner||t.isDrawing?t._e():e("div",{staticClass:"click-instruction"})])])],1)},V=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"col-md-10"},[e("div",{},[e("h4",{staticClass:"mb-1"},[t._v("Lucky Draw - Live Draw")]),e("p",{staticClass:"text-muted"},[t._v("Start the lucky draw flipper session to randomly select winners with animated number flipping.")])])])},function(){var t=this,e=t._self._c;return e("h5",{staticClass:"font-weight-bold"},[e("i",{staticClass:"fas fa-trophy mr-2 text-warning"}),t._v("Prize Ranks ")])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"col-md-3"},[e("div",{staticClass:"prize-legend"},[e("div",{staticClass:"legend-item"},[e("span",{staticClass:"legend-box legend-empty"}),e("span",{staticClass:"legend-text"},[t._v("Available")])]),e("div",{staticClass:"legend-item"},[e("span",{staticClass:"legend-box legend-filled"}),e("span",{staticClass:"legend-text"},[t._v("Winner Selected")])])])])}],$={components:{BIconPencilSquare:v["kt"],BIconTrash:v["Py"],ValidationObserver:f["a"],ValidationProvider:f["b"]},data:function(){return{eventId:null,liveDraw:{enabled:!1,fromNumber:null,toNumber:null,prizePositions:null},winnersList:[]}},computed:{totalPrizePositions:function(){return parseInt(this.liveDraw.toNumber)-parseInt(this.liveDraw.fromNumber)+1}},mounted:function(){this.eventId=JSON.parse(localStorage.getItem("selectedEventSysId")),this.getControlPanelLiveData(),this.getWinnerDetailsInfo()},methods:{isRankFilled:function(t){return this.winnersList.some((function(e){return e.PRIZE_POSITION===t}))},getRankLabel:function(t){if(!t)return"";var e={1:"1st Place",2:"2nd Place",3:"3rd Place"};return e[t]||"".concat(t,"th Place")},getControlPanelLiveData:function(){var t=this;D.a.start(),D.a.set(.1),this.isLoading=!0;var e={ITEM:"VIEW_ALL",EVENT_SYS_ID:this.eventId,LUCKY_DRAW_TYPE:"LIVE"};this.$apiCall.get(this.$apiBus.api_get_control_panel_info,{params:e}).then((function(e){if(e.status&&"true"===e.status&&e.response.length>0){var a=e.response[0],i=function(t){return 1==t};t.liveDraw.enabled=i(a.LIVE_DRAW),t.liveDraw.fromNumber=a.LD_FROM_NUMBER,t.liveDraw.toNumber=a.LD_TO_NUMBER,t.liveDraw.prizePositions=a.LD_NO_OF_PRIZE_POSITION}})).catch((function(t){console.error("Error fetching control panel ".concat(drawType," data:"),t)})).finally((function(){t.isLoading=!1,D.a.done()}))},getWinnerDetailsInfo:function(){var t=this;D.a.start(),D.a.set(.1),this.isLoading=!0;var e={ITEM:"VIEW_ALL",EVENT_SYS_ID:this.eventId};this.$apiCall.get(this.$apiBus.api_get_winner_info,{params:e}).then((function(e){e.status&&"true"===e.status?t.winnersList=e.response.filter((function(t){return"Live Draw"==t.LUCKY_DRAW_TYPE})):t.winnersList=[]})).catch((function(t){m["a"].showErrorAlert(!0,"error","Failed to fetch winners")})).finally((function(){t.isLoading=!1,D.a.done()}))}}},K=$,Z=(a("50e0"),a("1b72"),Object(g["a"])(K,j,V,!1,null,"64edbeb2",null)),G=Z.exports,H=function(){var t=this,e=t._self._c;return e("div",{staticClass:"participant-container"},[t.isLoading?e("div",{staticClass:"loading_overlay"},[e("p",[t._v("Loading...")])]):t._e(),e("div",{staticClass:"d-flex justify-content-between align-items-center flex-wrap mb-3",staticStyle:{gap:"15px"}},[e("div",{staticClass:"d-flex align-items-center flex-wrap",staticStyle:{gap:"15px"}},[e("div",{staticClass:"search-container"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.winnersSearchQuery,expression:"winnersSearchQuery"}],staticClass:"search-input",attrs:{type:"text",placeholder:"Search by Name, Lucky Draw Number..."},domProps:{value:t.winnersSearchQuery},on:{input:[function(e){e.target.composing||(t.winnersSearchQuery=e.target.value)},t.filterWinners]}}),t._m(0)]),e("div",{staticClass:"d-flex align-items-center",staticStyle:{gap:"8px"}},[e("label",{staticClass:"mb-0 text-nowrap",attrs:{for:"winner-filter"}},[t._v("Filter by:")]),e("b-form-select",{staticClass:"form-control",staticStyle:{"min-width":"180px"},attrs:{id:"winner-filter",options:t.drawTypeOptions},on:{change:t.filterWinners},model:{value:t.selectedWinnerDrawType,callback:function(e){t.selectedWinnerDrawType=e},expression:"selectedWinnerDrawType"}})],1)]),e("div",[e("button",{staticClass:"btn btn-success mr-2",on:{click:t.showListSettingsModal}},[e("i",{staticClass:"fa fa-cogs mr-1"}),t._v(" List Settings ")]),e("button",{staticClass:"btn btn-info",on:{click:t.exportWinners}},[e("i",{staticClass:"fa fa-file-export mr-1"}),t._v(" Export ")])])]),e("div",{staticClass:"table-responsive mt-3"},[e("b-table",{attrs:{"head-variant":"light",bordered:"",hover:"",fields:t.visibleWinnerFields,items:t.filteredWinners,"sort-by":t.sortBy,"sort-desc":t.sortDesc,"show-empty":"","empty-text":"No winners found. Please check filters or API response."},on:{"update:sortBy":function(e){t.sortBy=e},"update:sort-by":function(e){t.sortBy=e},"update:sortDesc":function(e){t.sortDesc=e},"update:sort-desc":function(e){t.sortDesc=e}},scopedSlots:t._u([{key:"cell(INDEX)",fn:function(a){return[e("div",{staticClass:"text-center"},[t._v(t._s(a.index+1))])]}},{key:"cell(PRIZE_POSITION)",fn:function(a){return[e("div",{staticClass:"text-left"},[e("span",[t._v(" "+t._s(a.item.PRIZE_POSITION)+" ")])])]}},{key:"cell(REDEEMED)",fn:function(a){return[e("div",{staticClass:"text-center"},["N"===a.item.REDEEMED?[e("b-form-checkbox",{attrs:{checked:!1},on:{change:function(e){return t.markAsRedeemed(a.item)}}})]:[e("span",[t._v(t._s(t.formatDate(a.item.REDEEMED_DATE)))])]],2)]}},{key:"cell(DEPARTMENT)",fn:function(a){return[e("div",{staticClass:"text-left"},[e("span",[t._v(t._s(a.item.DEPARTMENT))])])]}}])})],1),e("b-modal",{attrs:{id:"list-settings-modal",title:"Winners List Settings",centered:"","hide-footer":""}},[e("div",{staticClass:"p-3"},[e("h5",{staticClass:"mb-3"},[t._v("Select columns to display:")]),t._l(t.winnerFieldOptions,(function(a){return e("div",{key:a.key,staticClass:"form-check mb-3"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.visible,expression:"field.visible"}],staticClass:"form-check-input",staticStyle:{transform:"scale(1.2)"},attrs:{type:"checkbox",id:"field-checkbox-"+a.key,disabled:a.disabled},domProps:{checked:Array.isArray(a.visible)?t._i(a.visible,null)>-1:a.visible},on:{change:function(e){var i=a.visible,r=e.target,n=!!r.checked;if(Array.isArray(i)){var s=null,l=t._i(i,s);r.checked?l<0&&t.$set(a,"visible",i.concat([s])):l>-1&&t.$set(a,"visible",i.slice(0,l).concat(i.slice(l+1)))}else t.$set(a,"visible",n)}}}),e("label",{staticClass:"form-check-label ml-2",attrs:{for:"field-checkbox-"+a.key}},[t._v(" "+t._s(a.label)+" ")])])}))],2),e("div",{staticClass:"d-flex justify-content-between p-3",staticStyle:{"background-color":"#f9f9f9","border-top":"1px solid #dee2e6"}},[e("b-button",{staticClass:"px-4",attrs:{variant:"secondary"},on:{click:t.resetWinnerFields}},[t._v("Reset")]),e("b-button",{staticClass:"px-4",attrs:{variant:"success"},on:{click:function(e){return t.$bvModal.hide("list-settings-modal")}}},[t._v("Done")])],1)])],1)},X=[function(){var t=this,e=t._self._c;return e("button",{staticClass:"search-button"},[e("i",{staticClass:"fa fa-search"})])}],J={name:"WinnersComponent",data:function(){return{winners:[],filteredWinners:[],winnersSearchQuery:"",selectedWinnerDrawType:null,winnerFieldOptions:[],sortBy:"PRIZE_POSITION",sortDesc:!1,initialWinnerFieldOptions:[{key:"INDEX",label:"S/N",visible:!0,disabled:!0,sortable:!1,thClass:"text-center",tdClass:"text-center"},{key:"LUCKY_DRAW_TYPE",label:"Draw Type",visible:!0,disabled:!1,sortable:!0,thClass:"text-center",tdClass:"text-left"},{key:"PRIZE_POSITION",label:"Prize Position",visible:!0,disabled:!1,sortable:!0,thClass:"text-center",tdClass:"text-left"},{key:"PRIZE_WON",label:"Prize Won",visible:!0,disabled:!1,sortable:!0,thClass:"text-left",tdClass:"text-left"},{key:"LUCKY_DRAW_NO",label:"Lucky Draw Number",visible:!0,disabled:!1,sortable:!0,thClass:"text-center",tdClass:"text-center"},{key:"PARTICIPANT_NAME",label:"Winner Name",visible:!0,disabled:!1,sortable:!0,thClass:"text-left",tdClass:"text-left"},{key:"DEPARTMENT",label:"Department",visible:!0,disabled:!1,sortable:!0,thClass:"text-left",tdClass:"text-left"},{key:"REDEEMED",label:"Redeemed",visible:!0,disabled:!1,sortable:!1,thClass:"text-center",tdClass:"text-center"}],drawTypeOptions:[{value:null,text:"All Draw Types"},{value:"LIVE",text:"Live Draw"},{value:"PRE_LIVE",text:"Pre-Live Draw"},{value:"PRE_DRAW",text:"Pre-Draw"},{value:"EARLY_BIRD",text:"Early Bird"}],drawTypeApiMap:{LIVE:"Live Draw",PRE_LIVE:"Pre-Live Draw",PRE_DRAW:"Pre-Draw",EARLY_BIRD:"Early Bird"},isLoading:!1,event_sys_id:null,specific_event_details:{EVENT_NAME:"My Awesome Event"}}},mounted:function(){this.event_sys_id=JSON.parse(localStorage.getItem("selectedEventSysId"))||6,this.initializeFieldOptions(),this.getWinnerDetailsInfo()},watch:{winnerFieldOptions:{handler:function(t){localStorage.setItem("winnerFieldOptions",JSON.stringify(t))},deep:!0}},computed:{visibleWinnerFields:function(){return this.winnerFieldOptions.filter((function(t){return t.visible}))}},methods:{initializeFieldOptions:function(){var t=localStorage.getItem("winnerFieldOptions");if(t)try{var e=JSON.parse(t);this.winnerFieldOptions=this.initialWinnerFieldOptions.map((function(t){var a=e.find((function(e){return e.key===t.key}));return Object(d["a"])(Object(d["a"])({},t),{},{visible:a?a.visible:t.visible})}))}catch(a){this.winnerFieldOptions=JSON.parse(JSON.stringify(this.initialWinnerFieldOptions))}else this.winnerFieldOptions=JSON.parse(JSON.stringify(this.initialWinnerFieldOptions))},getWinnerDetailsInfo:function(){var t=this;D.a.start(),this.isLoading=!0;var e={ITEM:"VIEW_ALL",EVENT_SYS_ID:this.event_sys_id};this.$apiCall.get(this.$apiBus.api_get_winner_info,{params:e}).then((function(e){console.log("API Response Received:",e),e&&"true"===e.status&&Array.isArray(e.response)?(console.log("Condition PASSED. Status is '".concat(e.status,"'. Populating table with ").concat(e.response.length," records.")),t.winners=e.response.map((function(t){return{WINNER_SYS_ID:t.WINNER_SYS_ID,LUCKY_DRAW_TYPE:t.LUCKY_DRAW_TYPE||"N/A",PRIZE_POSITION:t.PRIZE_POSITION||0,PRIZE_WON:t.PRIZE_WON||"N/A",LUCKY_DRAW_NO:t.LUCKY_DRAW_NO||"N/A",PARTICIPANT_NAME:t.PARTICIPANT_NAME||"N/A",REDEEMED:t.REDEEMED||"N",REDEEMED_DATE:t.REDEEMED_DATE||null,DEPARTMENT:t.DEPARTMENT||null}}))):(console.warn("Condition FAILED. Status: '".concat(e.status,"', Is response an array? ").concat(Array.isArray(e.response),". Table will be empty.")),t.winners=[]),t.filterWinners()})).catch((function(e){console.error("Error fetching winners:",e),t.winners=[],t.filteredWinners=[],m["a"].showErrorAlert(!0,"error","Failed to fetch winners. See console for details.")})).finally((function(){t.isLoading=!1,D.a.done()}))},filterWinners:function(){var t=this.winnersSearchQuery.trim().toLowerCase(),e=Object(u["a"])(this.winners);if(this.selectedWinnerDrawType){var a=this.drawTypeApiMap[this.selectedWinnerDrawType];e=e.filter((function(t){return t.LUCKY_DRAW_TYPE===a}))}t&&(e=e.filter((function(e){var a=String(e.PARTICIPANT_NAME||"").toLowerCase(),i=String(e.LUCKY_DRAW_NO||"").toLowerCase();return a.includes(t)||i.includes(t)}))),this.filteredWinners=e,console.log("Table updated. Displaying ".concat(this.filteredWinners.length," filtered winners."))},markAsRedeemed:function(t){var e=this;D.a.start(),D.a.set(.1),this.isLoading=!0;var a=[{ITEM:"REDEEMED",WINNER_SYS_ID:t.WINNER_SYS_ID,REDEEMED:"Y"}];this.$apiCall.post(this.$apiBus.api_post_lucky_winner,a).then((function(t){t.status,e.getWinnerDetailsInfo()})).catch((function(t){console.error("Error ",t),m["a"].showErrorAlert(!0,"error","Failed to update winners"),e.getWinnerDetailsInfo()})).finally((function(){e.isLoading=!1,D.a.done()}))},exportWinners:function(){var t=this;if(0!==this.filteredWinners.length){var e=Object(u["a"])(this.filteredWinners).sort((function(e,a){var i=e[t.sortBy],r=a[t.sortBy],n=0;return i>r?n=1:i<r&&(n=-1),t.sortDesc?-n:n})),a=["S/N","Draw Type","Prize Position","Prize Won","Lucky Draw Number","Name","Redeemed On"],i=["INDEX","LUCKY_DRAW_TYPE","PRIZE_POSITION","PRIZE_WON","LUCKY_DRAW_NO","PARTICIPANT_NAME","REDEEMED_DATE"],r=e.map((function(e,a){return{INDEX:a+1,LUCKY_DRAW_TYPE:e.LUCKY_DRAW_TYPE,PRIZE_POSITION:e.PRIZE_POSITION,PRIZE_WON:e.PRIZE_WON,LUCKY_DRAW_NO:e.LUCKY_DRAW_NO,PARTICIPANT_NAME:e.PARTICIPANT_NAME,REDEEMED_DATE:"Y"===e.REDEEMED?t.formatDate(e.REDEEMED_DATE):"Not Redeemed"}})),n=this.formatJson(i,r),s=this.specific_event_details.EVENT_NAME||"Event",l="".concat(s,"_Winners_List");this.generateXlsx(a,n,l)}else m["a"].showInfoAlert(!0,"info","There are no winners to export.")},showListSettingsModal:function(){this.$bvModal.show("list-settings-modal")},resetWinnerFields:function(){this.winnerFieldOptions=JSON.parse(JSON.stringify(this.initialWinnerFieldOptions)),localStorage.removeItem("winnerFieldOptions"),m["a"].showSuccessAlert(!0,"success","Field settings reset to default!")},formatDate:function(t){if(!t)return"Redeemed";try{var e={day:"2-digit",month:"short",year:"numeric"};return new Date(t).toLocaleDateString("en-GB",e)}catch(a){return t}},formatJson:function(t,e){return e.map((function(e){return t.map((function(t){var a;return null!==(a=e[t])&&void 0!==a?a:""}))}))},generateXlsx:function(t,e,a){var i=h["c"].aoa_to_sheet([t].concat(Object(u["a"])(e))),r=h["c"].book_new();h["c"].book_append_sheet(r,i,"Winners");var n=a.replace(/[^a-z0-9_-\s]/gi,"_");h["e"](r,"".concat(n,".xlsx"))}}},q=J,Q=(a("4f40"),Object(g["a"])(q,H,X,!1,null,"7b6d35da",null)),tt=Q.exports,et=function(){var t,e,a,i=this,r=i._self._c;return r("div",[r("div",{staticClass:"row mt-3"},[r("div",{staticClass:"col-md-6"},[r("h4",{staticClass:"mb-3"},[i._v("Lucky Draw - Pre-Live")]),r("p",{staticClass:"text-muted"},[i._v(" Start the lucky draw flipper session to randomly select winners with animated number flipping. ")]),r("div",{staticClass:"mt-3"},[r("label",{staticClass:"font-weight-bold"},[i._v("Select Draw Order")]),r("p",{staticClass:"text-muted small"},[i._v(" Before starting the event, please confirm the desired drawing approach with the customer. ")]),r("div",{staticClass:"row",on:{change:function(t){return i.handleDrawOrderChange(t)}}},[r("div",{staticClass:"col-md-12"},[r("label",[r("input",{directives:[{name:"model",rawName:"v-model",value:i.drawOrderValue,expression:"drawOrderValue"}],staticClass:"mr-1",attrs:{type:"radio",value:"top-to-bottom"},domProps:{checked:i._q(i.drawOrderValue,"top-to-bottom")},on:{change:function(t){i.drawOrderValue="top-to-bottom"}}}),i._v(" Top to Bottom (e.g., 1st, 2nd, 3rd...) ")])]),r("div",{staticClass:"col-md-12"},[r("label",[r("input",{directives:[{name:"model",rawName:"v-model",value:i.drawOrderValue,expression:"drawOrderValue"}],staticClass:"mr-1",attrs:{type:"radio",value:"bottom-to-top"},domProps:{checked:i._q(i.drawOrderValue,"bottom-to-top")},on:{change:function(t){i.drawOrderValue="bottom-to-top"}}}),i._v(" Bottom to Top (e.g., 10th, 9th, 8th...) ")])])])]),r("div",{staticClass:"mt-3"},[r("b-button",{staticClass:"start-prelive-btn",attrs:{size:"lg",variant:"success",disabled:!i.drawOrderValue},on:{click:i.openPreLiveModal}},[r("i",{staticClass:"fas fa-play mr-2"}),i._v("Start Pre-Live ")])],1)]),r("div",{staticClass:"col-md-6"},[r("div",{staticClass:"prize-ranks-container"},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-md-6"},[i._m(0),r("p",{staticStyle:{color:"#fff","margin-left":"2rem !important"}},[i._v(" Total Positions: "+i._s(i.totalPrizePositions)+" ")])]),i._m(1)]),r("div",{staticClass:"prize-boxes-grid"},i._l(i.prizeRanks,(function(t){return r("div",{key:t,staticClass:"prize-box",class:{"prize-box-filled":i.isRankFilled(t)},on:{contextmenu:function(e){return e.preventDefault(),i.openActionOptionModal(t)}}},[r("div",{staticClass:"prize-rank-number"},[i._v(i._s(t))]),r("div",{staticClass:"prize-rank-label"},[i._v(i._s(i.getRankLabel(t)))])])})),0)])])]),r("b-modal",{attrs:{id:"preLiveModal","hide-header":"",size:"xl","hide-footer":"",centered:"","body-class":"pre-live-modal"},model:{value:i.showPreLiveModal,callback:function(t){i.showPreLiveModal=t},expression:"showPreLiveModal"}},[r("div",{staticClass:"text-center mb-2"},[r("h2",{staticClass:"modal-title"},[i._v("🎯 Lucky Draw – Pre-Live")]),r("p",{staticClass:"modal-subtitle"},[i._v(" "+i._s(i.modalSubtitleText)+" ")])]),r("div",{staticClass:"d-flex flex-wrap justify-content-center"},i._l(i.currentDrawBatch,(function(t){var e,a,n,s,l,o;return r("div",{key:"modal-rank-"+t,staticClass:"flick-box m-2 text-center"},[r("div",{staticClass:"flick-rank"},[i._v(i._s(i.getRankLabel(t)))]),r("div",{staticClass:"flick-prize mb-2 text-white"},[i._v(" "+i._s(i.getPrizeDescription(t))+" ")]),r("div",{staticClass:"flick-number"},[i._v(" "+i._s((null===(e=i.flickResults[t])||void 0===e?void 0:e.LUCKY_DRAW_NO)||(null===(a=i.getExistingWinner(t))||void 0===a?void 0:a.LUCKY_DRAW_NO)||"0000")+" ")]),r("div",{staticClass:"flick-name"},[i._v(" "+i._s((null===(n=i.flickResults[t])||void 0===n?void 0:n.PARTICIPANT_NAME)||(null===(s=i.getExistingWinner(t))||void 0===s?void 0:s.PARTICIPANT_NAME)||"---")+" ")]),r("div",{staticClass:"flick-department"},[i._v(" "+i._s((null===(l=i.flickResults[t])||void 0===l?void 0:l.DEPARTMENT)||(null===(o=i.getExistingWinner(t))||void 0===o?void 0:o.DEPARTMENT)||"---")+" ")])])})),0),r("div",{staticClass:"text-center mt-4"},[r("b-button",{staticClass:"mx-2 px-4 py-2 start-btn",attrs:{variant:"success",size:"lg",disabled:i.isFlicking||!i.currentDrawBatch.length},on:{click:i.startFlicking}},[r("i",{staticClass:"fas fa-play mr-2"}),i._v(" "+i._s(i.isPreLiveWinnerDeclare?"Redraw Batch":"Start Draw")+" ")]),!i.isPreLiveWinnerDeclare&&i.hasNextBatch?r("b-button",{staticClass:"mx-2 px-4 py-2",attrs:{variant:"info",size:"lg",disabled:i.isFlicking},on:{click:i.skipToNextBatch}},[r("i",{staticClass:"fas fa-forward mr-2"}),i._v(" Next Batch ")]):i._e(),i.isPreLiveWinnerDeclare?r("b-button",{staticClass:"mx-2 px-4 py-2",attrs:{variant:"primary",size:"lg"},on:{click:i.confirmAndProceed}},[r("i",{staticClass:"fas",class:i.hasNextBatch?"fa-forward":"fa-check"}),i._v(" "+i._s(i.hasNextBatch?"Save & Next":"Save & Finish")+" ")]):i._e(),r("b-button",{staticClass:"mx-2 px-4 py-2 close-btn",attrs:{variant:"outline-light",size:"lg"},on:{click:function(t){i.showPreLiveModal=!1}}},[r("i",{staticClass:"fas fa-times mr-2"}),i._v(" Close ")])],1)]),r("b-modal",{attrs:{id:"actionOptionModal","hide-header":"","hide-footer":"",centered:"",size:"sm","body-class":"action-modal-body"}},[r("div",{staticClass:"text-center p-3"},[r("h5",{staticClass:"font-weight-bold mb-4"},[i._v("Select Action")]),r("p",{staticClass:"text-muted mb-4"},[i._v("How would you like to handle this position?")]),r("b-button",{staticClass:"mb-3",attrs:{variant:"primary",block:""},on:{click:function(t){return i.handleActionSelection("new")}}},[r("i",{staticClass:"fas fa-random mr-2"}),i._v(" Redraw (New Winner) ")]),r("b-button",{attrs:{variant:"info",block:""},on:{click:function(t){return i.handleActionSelection("same")}}},[r("i",{staticClass:"fas fa-redo mr-2"}),i._v(" Draw Again (Show Same Winner) ")]),r("div",{staticClass:"mt-3 text-center"},[r("b-button",{staticClass:"text-muted",attrs:{variant:"link"},on:{click:function(t){return i.$bvModal.hide("actionOptionModal")}}},[i._v("Cancel")])],1)],1)]),r("b-modal",{attrs:{id:"preLiveReDrawModal","hide-header":"",size:"lg","hide-footer":"",centered:"","modal-class":"custom-redraw-modal","body-class":"redraw-modal"}},[r("div",{staticClass:"text-center mb-2"},[r("h2",{staticClass:"modal-title"},[i._v("🎯 "+i._s("new"===i.redrawMode?"Redraw Winner":"Draw Again"))]),r("p",{staticClass:"modal-subtitle"},[i._v(" "+i._s("new"===i.redrawMode?"Redraw positions to select a new winner!":"Re-revealing the existing winner with animation.")+" ")])]),r("div",{staticClass:"d-flex flex-wrap justify-content-center"},[r("div",{key:"'modal-rank-' + selectedReDrawPosition",staticClass:"flick-box m-2 text-center"},[r("div",{staticClass:"flick-rank"},[i._v(i._s(i.getRankLabel(i.selectedReDrawPosition)))]),r("div",{staticClass:"flick-prize mb-2 text-white"},[i._v(" "+i._s(i.getPrizeDescription(i.selectedReDrawPosition))+" ")]),r("div",{staticClass:"flick-number"},[i._v(" "+i._s((null===(t=i.reDrawFlickResults[i.selectedReDrawPosition])||void 0===t?void 0:t.LUCKY_DRAW_NO)||"0000")+" ")]),r("div",{staticClass:"flick-name"},[i._v(" "+i._s((null===(e=i.reDrawFlickResults[i.selectedReDrawPosition])||void 0===e?void 0:e.PARTICIPANT_NAME)||"---")+" ")]),r("div",{staticClass:"flick-department"},[i._v(" "+i._s((null===(a=i.reDrawFlickResults[i.selectedReDrawPosition])||void 0===a?void 0:a.DEPARTMENT)||"---")+" ")])])]),r("div",{staticClass:"text-center mt-4"},[r("b-button",{staticClass:"mx-2 px-4 py-2 start-btn",attrs:{variant:"success",size:"lg",disabled:i.isReDrawFlicking},on:{click:i.startReDrawFlicking}},[r("i",{staticClass:"fas fa-play mr-2"}),i._v(" "+i._s(i.isReDrawFlicking?"Drawing...":"Start")+" ")]),i.isReDrawWinnerDeclare&&"new"===i.redrawMode?r("b-button",{staticClass:"mx-2 px-4 py-2",attrs:{variant:"success",size:"lg"},on:{click:i.updateReDrawWinnerDetails}},[r("i",{staticClass:"fas fa-save mr-2"}),i._v(" Confirm New Winner ")]):i._e(),r("b-button",{staticClass:"mx-2 px-4 py-2 close-btn",attrs:{variant:"outline-light",size:"lg"},on:{click:function(t){return i.$bvModal.hide("preLiveReDrawModal")}}},[r("i",{staticClass:"fas fa-times mr-2"}),i._v(" Close ")])],1)])],1)},at=[function(){var t=this,e=t._self._c;return e("h5",{staticClass:"font-weight-bold"},[e("i",{staticClass:"fas fa-trophy mr-2 text-warning"}),t._v("Prize Ranks ")])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"col-md-6"},[e("div",{staticClass:"prize-legend"},[e("div",{staticClass:"legend-item"},[e("span",{staticClass:"legend-box legend-empty"}),e("span",{staticClass:"legend-text"},[t._v("Available")])]),e("div",{staticClass:"legend-item"},[e("span",{staticClass:"legend-box legend-filled"}),e("span",{staticClass:"legend-text"},[t._v("Winner Selected")])])])])}],it=(a("a630"),a("07ac"),{data:function(){return{drawSettingData:null,eventSysId:null,winnersList:[],preLiveParticipantsList:[],drawOrderValue:null,showPreLiveModal:!1,isFlicking:!1,flickResults:{},prizeListData:[],isPreLiveWinnerDeclare:!1,selectedReDrawPosition:null,reDrawFlickResults:{},isReDrawWinnerDeclare:!1,isReDrawFlicking:!1,currentDrawBatch:[],channel:null,redrawMode:"new",batchOffset:0}},computed:{totalPrizePositions:function(){var t,e;return this.drawSettingData?parseInt((null===(t=this.drawSettingData)||void 0===t?void 0:t.LPD_TO_NUMBER)||0)-parseInt((null===(e=this.drawSettingData)||void 0===e?void 0:e.LPD_FROM_NUMBER)||0)+1:0},prizeRanks:function(){var t,e;if(!this.drawSettingData)return[];var a=parseInt((null===(t=this.drawSettingData)||void 0===t?void 0:t.LPD_FROM_NUMBER)||0),i=parseInt((null===(e=this.drawSettingData)||void 0===e?void 0:e.LPD_TO_NUMBER)||0);return i<a?[]:Array.from({length:i-a+1},(function(t,e){return a+e}))},modalSubtitleText:function(){return this.currentDrawBatch.length>0?"Drawing positions ".concat(this.currentDrawBatch[0]," to ").concat(this.currentDrawBatch[this.currentDrawBatch.length-1]):this.preLiveParticipantsList.length?"All prize positions have been drawn.":"There are no participants to draw from."},hasNextBatch:function(){var t,e=parseInt(null===(t=this.drawSettingData)||void 0===t?void 0:t.LPD_NO_OF_PRIZE_POSITION)||this.prizeRanks.length;return this.batchOffset+e<this.prizeRanks.length}},mounted:function(){this.eventSysId=JSON.parse(localStorage.getItem("selectedEventSysId")),this.fetchDrawSettingsData(),this.fetchPreLiveWinnersListData(),this.fetchPreLivePrizeListData(),this.channel=new BroadcastChannel("vue-global-events")},beforeDestroy:function(){this.channel&&this.channel.close()},methods:{handleDrawOrderChange:function(t){var e=t.target.value;e&&(this.drawOrderValue=e,this.updateDrawOrderPreference(e))},updateDrawOrderPreference:function(t){var e=this;return Object(_["a"])(Object(p["a"])().mark((function a(){var i;return Object(p["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i={ITEM:"UPDATE_PRE_LIVE_ORDER",EVENT_SYS_ID:e.eventSysId,LPD_TOP_TO_BUTTON_ORDER:"top-to-bottom"===t?"1":"0",LPD_BUTTON_TO_TOP_ORDER:"bottom-to-top"===t?"1":"0"},a.prev=1,a.next=4,e.$apiCall.post(e.$apiBus.api_post_lucky_draw,i);case 4:a.next=9;break;case 6:a.prev=6,a.t0=a["catch"](1),console.error("Failed to update draw order preference:",a.t0);case 9:case"end":return a.stop()}}),a,null,[[1,6]])})))()},openActionOptionModal:function(t){this.isRankFilled(t)&&(this.selectedReDrawPosition=t,this.$bvModal.show("actionOptionModal"))},handleActionSelection:function(t){var e=this;this.redrawMode=t,this.$bvModal.hide("actionOptionModal"),setTimeout((function(){e.openReDrawModal(e.selectedReDrawPosition)}),200)},openReDrawModal:function(t){this.fetchPreLiveParticipantsListData(),this.isReDrawWinnerDeclare=!1,this.reDrawFlickResults={},this.$bvModal.show("preLiveReDrawModal")},prepareNextBatch:function(){var t;this.flickResults={},this.isPreLiveWinnerDeclare=!1;var e=parseInt(null===(t=this.drawSettingData)||void 0===t?void 0:t.LPD_NO_OF_PRIZE_POSITION)||this.prizeRanks.length,a=Object(u["a"])(this.prizeRanks);"top-to-bottom"===this.drawOrderValue?a.sort((function(t,e){return t-e})):a.sort((function(t,e){return e-t})),this.currentDrawBatch=a.slice(this.batchOffset,this.batchOffset+e)},getExistingWinner:function(t){var e=this.winnersList.find((function(e){return e.PRIZE_POSITION==t}));return e?{LUCKY_DRAW_NO:e.LUCKY_DRAW_NO,PARTICIPANT_NAME:e.PARTICIPANT_NAME||e.NAME,DEPARTMENT:e.DEPARTMENT||"---"}:null},openPreLiveModal:function(){var t=this;return Object(_["a"])(Object(p["a"])().mark((function e(){var a;return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.fetchPreLiveParticipantsListData();case 2:t.batchOffset=0,t.prepareNextBatch(),a=t.currentDrawBatch.map((function(e){return{rank:e,name:t.getPrizeDescription(e)}})),t.channel.postMessage({action:"display-setup",prizeRanks:t.currentDrawBatch,prizes:a}),t.showPreLiveModal=!0;case 7:case"end":return e.stop()}}),e)})))()},startFlicking:function(){var t=this;this.isFlicking=!0,this.isPreLiveWinnerDeclare=!1,this.flickResults={},this.channel.postMessage({action:"start-prelive",prizeRanks:this.currentDrawBatch});var e=new Set(this.winnersList.map((function(t){return t.PARTICIPANTS_SYS_ID}))),a=new Set;this.currentDrawBatch.forEach((function(i,r){var n=t.winnersList.find((function(t){return t.PRIZE_POSITION==i})),s=setInterval((function(){var e=t.randomNumber();t.$set(t.flickResults,i,{LUCKY_DRAW_NO:e,PARTICIPANT_NAME:"",PRIZE_NAME:"",DEPARTMENT:""}),t.channel.postMessage({action:"flipping-prelive",rank:i,data:{LUCKY_DRAW_NO:e}})}),100);setTimeout((function(){clearInterval(s);var r=null;if(n)r={LUCKY_DRAW_NO:n.LUCKY_DRAW_NO,PARTICIPANT_NAME:n.PARTICIPANT_NAME||n.NAME,DEPARTMENT:n.DEPARTMENT||"---",PRIZE_NAME:"".concat(t.getPrizeDescription(i)),PRIZE_POSITION:i,PARTICIPANTS_SYS_ID:n.PARTICIPANTS_SYS_ID};else{var l=t.preLiveParticipantsList.filter((function(t){return!e.has(t.PARTICIPANTS_SYS_ID)&&!a.has(t.PARTICIPANTS_SYS_ID)})),o=l.length>0?l:t.preLiveParticipantsList.filter((function(t){return!a.has(t.PARTICIPANTS_SYS_ID)}));if(0===o.length)r={LUCKY_DRAW_NO:"N/A",PARTICIPANT_NAME:"No Participants",PRIZE_NAME:"".concat(t.getPrizeDescription(i)),PRIZE_POSITION:i,PARTICIPANTS_SYS_ID:null,DEPARTMENT:"---"};else{var c=Math.floor(Math.random()*o.length),u=o[c];null!==u&&void 0!==u&&u.PARTICIPANTS_SYS_ID&&a.add(u.PARTICIPANTS_SYS_ID),r={LUCKY_DRAW_NO:(null===u||void 0===u?void 0:u.LUCKY_DRAW_NO)||"0000",PARTICIPANT_NAME:(null===u||void 0===u?void 0:u.PARTICIPANT_NAME)||"---",DEPARTMENT:(null===u||void 0===u?void 0:u.DEPARTMENT)||"---",PRIZE_NAME:"".concat(t.getPrizeDescription(i)),PRIZE_POSITION:i,PARTICIPANTS_SYS_ID:null===u||void 0===u?void 0:u.PARTICIPANTS_SYS_ID}}}t.$set(t.flickResults,i,Object(d["a"])(Object(d["a"])({},r),{},{PARTICIPANT_NAME:"",DEPARTMENT:""})),setTimeout((function(){t.$set(t.flickResults,i,r),t.channel.postMessage({action:"stop-prelive",rank:i,winner:r})}),500)}),8500+50*r)}));var i=8500+50*this.currentDrawBatch.length+1e3;setTimeout((function(){t.isPreLiveWinnerDeclare=!0,t.isFlicking=!1,t.channel.postMessage({action:"complete-prelive"})}),i)},saveCurrentBatchWinners:function(){var t=this;return Object(_["a"])(Object(p["a"])().mark((function e(){var a,i;return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=Object.values(t.flickResults).filter((function(t){return t.PARTICIPANTS_SYS_ID})).filter((function(e){return!t.winnersList.some((function(t){return t.PRIZE_POSITION==e.PRIZE_POSITION}))})).map((function(e){return{ITEM:"ADD",ORGANIZATION_SYS_ID:"1",PARTICIPANTS_SYS_ID:e.PARTICIPANTS_SYS_ID,EVENT_SYS_ID:t.eventSysId,LUCKY_DRAW_NO:e.LUCKY_DRAW_NO,LUCKY_DRAW_TYPE:"Pre-Live Draw",PRIZE_POSITION:e.PRIZE_POSITION.toString(),CREATED_BY:"1"}})),0!==a.length){e.next=3;break}return e.abrupt("return",!0);case 3:return e.prev=3,e.next=6,t.$apiCall.post(t.$apiBus.api_post_lucky_winner,a);case 6:return i=e.sent,e.abrupt("return","true"===i.status);case 10:return e.prev=10,e.t0=e["catch"](3),console.error("API error while saving winners:",e.t0),e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,null,[[3,10]])})))()},confirmAndProceed:function(){var t=this;return Object(_["a"])(Object(p["a"])().mark((function e(){var a,i,r,n;return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.saveCurrentBatchWinners();case 2:if(a=e.sent,!a){e.next=9;break}return e.next=6,t.fetchPreLiveWinnersListData();case 6:t.hasNextBatch?(r=parseInt(null===(i=t.drawSettingData)||void 0===i?void 0:i.LPD_NO_OF_PRIZE_POSITION)||t.prizeRanks.length,t.batchOffset+=r,t.prepareNextBatch(),n=t.currentDrawBatch.map((function(e){return{rank:e,name:t.getPrizeDescription(e)}})),t.channel.postMessage({action:"display-setup",prizeRanks:t.currentDrawBatch,prizes:n})):t.showPreLiveModal=!1,e.next=10;break;case 9:alert("There was an error saving the winners. Please try again.");case 10:case"end":return e.stop()}}),e)})))()},skipToNextBatch:function(){var t=this;if(this.hasNextBatch){var e,a=parseInt(null===(e=this.drawSettingData)||void 0===e?void 0:e.LPD_NO_OF_PRIZE_POSITION)||this.prizeRanks.length;this.batchOffset+=a,this.prepareNextBatch();var i=this.currentDrawBatch.map((function(e){return{rank:e,name:t.getPrizeDescription(e)}}));this.channel.postMessage({action:"display-setup",prizeRanks:this.currentDrawBatch,prizes:i})}},startReDrawFlicking:function(){var t=this;this.isReDrawFlicking=!0,this.isReDrawWinnerDeclare=!1;var e=this.selectedReDrawPosition;this.$set(this.reDrawFlickResults,e,{LUCKY_DRAW_NO:"0000",PARTICIPANT_NAME:"---",DEPARTMENT:"---",PRIZE_POSITION:e}),this.channel.postMessage({action:"start-prelive",prizeRanks:[e]});var a=setInterval((function(){var a=t.randomNumber();t.$set(t.reDrawFlickResults,e,{LUCKY_DRAW_NO:a,PARTICIPANT_NAME:"",DEPARTMENT:"",PRIZE_NAME:"",PRIZE_POSITION:e,PARTICIPANTS_SYS_ID:null}),t.channel.postMessage({action:"flipping-prelive",rank:e,data:{LUCKY_DRAW_NO:a}})}),100);setTimeout((function(){var i,r,n,s;clearInterval(a);var l=null;if("same"===t.redrawMode){var o=t.winnersList.find((function(t){return Number(t.PRIZE_POSITION)===Number(e)}));l=o?{LUCKY_DRAW_NO:o.LUCKY_DRAW_NO,PARTICIPANT_NAME:o.PARTICIPANT_NAME||o.NAME,DEPARTMENT:o.DEPARTMENT||"---",PARTICIPANTS_SYS_ID:o.PARTICIPANTS_SYS_ID}:{LUCKY_DRAW_NO:"Error",PARTICIPANT_NAME:"Not Found",DEPARTMENT:""}}else{var c=new Set(t.winnersList.filter((function(t){return parseInt(t.PRIZE_POSITION)!==e})).map((function(t){return t.PARTICIPANTS_SYS_ID}))),u=t.preLiveParticipantsList.filter((function(t){return!c.has(t.PARTICIPANTS_SYS_ID)})),p=u.length>0?u:t.preLiveParticipantsList,_=Math.floor(Math.random()*p.length),v=p[_];l={LUCKY_DRAW_NO:(null===v||void 0===v?void 0:v.LUCKY_DRAW_NO)||"0000",PARTICIPANT_NAME:(null===v||void 0===v?void 0:v.PARTICIPANT_NAME)||"---",DEPARTMENT:(null===v||void 0===v?void 0:v.DEPARTMENT)||"---",PARTICIPANTS_SYS_ID:null===v||void 0===v?void 0:v.PARTICIPANTS_SYS_ID}}var f={LUCKY_DRAW_NO:(null===(i=l)||void 0===i?void 0:i.LUCKY_DRAW_NO)||"0000",PARTICIPANT_NAME:(null===(r=l)||void 0===r?void 0:r.PARTICIPANT_NAME)||"---",PRIZE_NAME:"".concat(t.getPrizeDescription(e)),PRIZE_POSITION:e,PARTICIPANTS_SYS_ID:null===(n=l)||void 0===n?void 0:n.PARTICIPANTS_SYS_ID,DEPARTMENT:(null===(s=l)||void 0===s?void 0:s.DEPARTMENT)||"---"};t.$set(t.reDrawFlickResults,e,Object(d["a"])(Object(d["a"])({},f),{},{PARTICIPANT_NAME:"",DEPARTMENT:""})),setTimeout((function(){t.$set(t.reDrawFlickResults,e,f),t.channel.postMessage({action:"stop-prelive",rank:e,winner:f})}),500),t.isReDrawFlicking=!1,t.isReDrawWinnerDeclare=!0}),5e3)},getPrizeDescription:function(t){var e,a=null===(e=this.prizeListData)||void 0===e?void 0:e.find((function(e){return Number(e.PRIZE_POSITION)==Number(t)}));return(null===a||void 0===a?void 0:a.PRIZE_NAME)||"---"},randomNumber:function(){return Math.floor(1e3+9e3*Math.random()).toString()},fetchDrawSettingsData:function(){var t=this;return Object(_["a"])(Object(p["a"])().mark((function e(){var a,i;return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={ITEM:"VIEW_ALL",EVENT_SYS_ID:t.eventSysId,LUCKY_DRAW_TYPE:"PRE_LIVE"},e.prev=1,e.next=4,t.$apiCall.get(t.$apiBus.api_get_control_panel_info,{params:a});case 4:i=e.sent,"true"===i.status&&i.response.length>0&&(t.drawSettingData=i.response[0],"1"===t.drawSettingData.LPD_TOP_TO_BUTTON_ORDER?t.drawOrderValue="top-to-bottom":"1"===t.drawSettingData.LPD_BUTTON_TO_TOP_ORDER?t.drawOrderValue="bottom-to-top":t.drawOrderValue=null),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),console.error("Failed to fetch draw settings:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})))()},fetchPreLiveWinnersListData:function(){var t=this;return Object(_["a"])(Object(p["a"])().mark((function e(){var a,i;return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={ITEM:"VIEW_ALL",EVENT_SYS_ID:t.eventSysId},e.prev=1,e.next=4,t.$apiCall.get(t.$apiBus.api_get_winner_info,{params:a});case 4:i=e.sent,"true"===i.status?t.winnersList=i.response.filter((function(t){return"Pre-Live Draw"===t.LUCKY_DRAW_TYPE})):t.winnersList=[],e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](1),console.error("Failed to fetch winners list:",e.t0),t.winnersList=[];case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))()},fetchPreLivePrizeListData:function(){var t=this;return Object(_["a"])(Object(p["a"])().mark((function e(){var a,i;return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={ITEM:"VIEW_ALL",EVENT_SYS_ID:t.eventSysId,LUCKY_DRAW_TYPE:"PRE_LIVE"},e.prev=1,e.next=4,t.$apiCall.get(t.$apiBus.api_get_prize_info,{params:a});case 4:i=e.sent,t.prizeListData="true"===i.status?i.response:[],e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](1),console.error("Failed to fetch prize list:",e.t0),t.prizeListData=[];case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))()},fetchPreLiveParticipantsListData:function(){var t=this;return Object(_["a"])(Object(p["a"])().mark((function e(){var a,i;return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={ITEM:"SPECIFIC",ORGANIZATION_SYS_ID:"1",EVENT_SYS_ID:t.eventSysId,DRAW_TYPE:"Pre-Live"},e.prev=1,e.next=4,t.$apiCall.get(t.$apiBus.api_post_lucky_draw_participant_list,{params:a});case 4:i=e.sent,t.preLiveParticipantsList="true"===i.status?i.response:[],e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](1),console.error("Failed to fetch participants list:",e.t0),t.preLiveParticipantsList=[];case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))()},isRankFilled:function(t){var e;return null===(e=this.winnersList)||void 0===e?void 0:e.some((function(e){return e.PRIZE_POSITION==t}))},getRankLabel:function(t){var e=parseInt(t);if(isNaN(e))return"";if(e%100>=11&&e%100<=13)return"".concat(e,"th Position");switch(e%10){case 1:return"".concat(e,"st Position");case 2:return"".concat(e,"nd Position");case 3:return"".concat(e,"rd Position");default:return"".concat(e,"th Position")}},updateReDrawWinnerDetails:function(){var t=this;return Object(_["a"])(Object(p["a"])().mark((function e(){var a,i,r;return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("new"===t.redrawMode){e.next=2;break}return e.abrupt("return");case 2:if(a=t.reDrawFlickResults[t.selectedReDrawPosition],a&&a.PARTICIPANTS_SYS_ID){e.next=5;break}return e.abrupt("return");case 5:return i={ITEM:"RE_DRAW",ORGANIZATION_SYS_ID:"1",PARTICIPANTS_SYS_ID:a.PARTICIPANTS_SYS_ID,EVENT_SYS_ID:t.eventSysId,LUCKY_DRAW_NO:a.LUCKY_DRAW_NO,LUCKY_DRAW_TYPE:"Pre-Live Draw",PRIZE_POSITION:a.PRIZE_POSITION.toString(),CREATED_BY:"1"},e.prev=6,e.next=9,t.$apiCall.post(t.$apiBus.api_post_lucky_winner,i);case 9:if(r=e.sent,"true"!==r.status){e.next=14;break}return t.$bvModal.hide("preLiveReDrawModal"),e.next=14,t.fetchPreLiveWinnersListData();case 14:e.next=19;break;case 16:e.prev=16,e.t0=e["catch"](6),console.error("API error while updating re-draw winner:",e.t0);case 19:case"end":return e.stop()}}),e,null,[[6,16]])})))()}}}),rt=it,nt=(a("cb04"),a("9e79"),Object(g["a"])(rt,et,at,!1,null,"5d00fd02",null)),st=nt.exports,lt=function(){var t,e,a,i=this,r=i._self._c;return r("div",[r("div",{staticClass:"row mt-3"},[r("div",{staticClass:"col-md-6"},[r("h4",{staticClass:"mb-3"},[i._v("Lucky Draw - Pre-Draw")]),r("p",{staticClass:"text-muted"},[i._v(" Start the lucky draw flipper session to randomly select winners with animated number flipping. ")]),r("div",{staticClass:"mt-3"},[r("label",{staticClass:"font-weight-bold"},[i._v("Select Draw Order")]),r("p",{staticClass:"text-muted small"},[i._v(" Before starting the event, please confirm the desired drawing approach with the customer. ")]),r("div",{staticClass:"row"},[r("div",{staticClass:"col-md-12"},[r("label",[r("input",{directives:[{name:"model",rawName:"v-model",value:i.drawOrderValue,expression:"drawOrderValue"}],staticClass:"mr-1",attrs:{type:"radio",value:"top-to-bottom"},domProps:{checked:i._q(i.drawOrderValue,"top-to-bottom")},on:{change:function(t){i.drawOrderValue="top-to-bottom"}}}),i._v(" Top to Bottom (e.g., 1st, 2nd, 3rd...) ")])]),r("div",{staticClass:"col-md-12"},[r("label",[r("input",{directives:[{name:"model",rawName:"v-model",value:i.drawOrderValue,expression:"drawOrderValue"}],staticClass:"mr-1",attrs:{type:"radio",value:"bottom-to-top"},domProps:{checked:i._q(i.drawOrderValue,"bottom-to-top")},on:{change:function(t){i.drawOrderValue="bottom-to-top"}}}),i._v(" Bottom to Top (e.g., 10th, 9th, 8th...) ")])])])]),r("div",{staticClass:"mt-3"},[i.isDrawComplete?i._e():r("b-button",{attrs:{variant:"primary",size:"lg"},on:{click:i.openPreDrawModal}},[r("i",{staticClass:"fas fa-play mr-2"}),i._v("Start Pre-Draw ")]),i.isDrawComplete?r("b-button",{attrs:{variant:"info",size:"lg"},on:{click:i.openPreDrawDisplayControlModal}},[i._v(" Show Pre-Draw Display ")]):i._e()],1)]),r("div",{staticClass:"col-md-6"},[r("div",{staticClass:"prize-ranks-container"},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-md-6"},[i._m(0),r("p",{staticStyle:{color:"#fff","margin-left":"2rem !important"}},[i._v(" Total Positions: "+i._s(i.totalPrizePositions)+" ")])]),i._m(1)]),r("div",{staticClass:"prize-boxes-grid"},i._l(i.prizeRanks,(function(t){return r("div",{key:t,staticClass:"prize-box",class:{"prize-box-filled":i.isRankFilled(t)},on:{contextmenu:function(e){return e.preventDefault(),i.openReDrawModal(t)}}},[r("div",{staticClass:"prize-rank-number"},[i._v(i._s(t))]),r("div",{staticClass:"prize-rank-label"},[i._v(i._s(i.getRankLabel(t)))])])})),0)])])]),r("b-modal",{attrs:{id:"preDrawModal","hide-header":"",size:"xl","hide-footer":"",centered:"","body-class":"pre-draw-modal"},model:{value:i.showPreDrawModal,callback:function(t){i.showPreDrawModal=t},expression:"showPreDrawModal"}},[r("div",{staticClass:"text-center mb-2"},[r("h2",{staticClass:"modal-title"},[i._v("🎯 Lucky Draw – Pre-Draw")]),r("p",{staticClass:"modal-subtitle"},[i._v(" All prize positions will flick simultaneously to reveal winners! ")])]),r("div",{staticClass:"d-flex flex-wrap justify-content-center"},i._l(i.prizeRanks,(function(t){var e,a,n,s,l,o;return r("div",{key:"modal-rank-"+t,staticClass:"flick-box m-2 text-center"},[r("div",{staticClass:"flick-rank"},[i._v(i._s(i.getRankLabel(t)))]),r("div",{staticClass:"flick-prize mb-2 text-white"},[i._v(" "+i._s(i.getPrizeDescription(t))+" ")]),r("div",{staticClass:"flick-number"},[i._v(" "+i._s((null===(e=i.flickResults[t])||void 0===e?void 0:e.LUCKY_DRAW_NO)||(null===(a=i.getExistingWinner(t))||void 0===a?void 0:a.LUCKY_DRAW_NO)||"0000")+" ")]),r("div",{staticClass:"flick-name"},[i._v(" "+i._s((null===(n=i.flickResults[t])||void 0===n?void 0:n.PARTICIPANT_NAME)||(null===(s=i.getExistingWinner(t))||void 0===s?void 0:s.PARTICIPANT_NAME)||"---")+" ")]),r("div",{staticClass:"flick-department mb-2 text-white"},[i._v(" "+i._s((null===(l=i.flickResults[t])||void 0===l?void 0:l.DEPARTMENT)||(null===(o=i.getExistingWinner(t))||void 0===o?void 0:o.DEPARTMENT)||"---")+" ")])])})),0),r("div",{staticClass:"text-center mt-4"},[r("b-button",{staticClass:"mx-2 px-4 py-2 start-btn",attrs:{variant:"outline-light",size:"lg",disabled:i.isFlicking},on:{click:i.startFlicking}},[r("i",{staticClass:"fas fa-play mr-2"}),i._v(" "+i._s(i.isPreDrawWinnerDeclare?"Draw Again":"Start Draw")+" ")]),i.isPreDrawWinnerDeclare?r("b-button",{staticClass:"mx-2 px-4 py-2 confirm-btn",attrs:{variant:"success",size:"lg"},on:{click:i.savePreDrawWinnerDetails}},[r("i",{staticClass:"fas fa-save mr-2"}),i._v(" Save & Confirm ")]):i._e(),r("b-button",{staticClass:"mx-2 px-4 py-2 close-btn",attrs:{variant:"outline-light",size:"lg"},on:{click:function(t){i.showPreDrawModal=!1}}},[r("i",{staticClass:"fas fa-times mr-2"}),i._v(" Close ")])],1)]),r("b-modal",{attrs:{id:"preDrawReDrawModal","hide-header":"",size:"lg","hide-footer":"",centered:"","modal-class":"custom-redraw-modal","body-class":"redraw-modal"}},[r("div",{staticClass:"text-center mb-2"},[r("h2",{staticClass:"modal-title"},[i._v("🎯 Lucky Draw – Redraw")]),r("p",{staticClass:"modal-subtitle"},[i._v(" Redraw "+i._s(i.getRankLabel(i.selectedReDrawPosition))+" positions to reveal a NEW winner! ")])]),r("div",{staticClass:"d-flex flex-wrap justify-content-center"},[r("div",{key:"'modal-rank-' + selectedReDrawPosition",staticClass:"flick-box m-2 text-center"},[r("div",{staticClass:"flick-rank"},[i._v(i._s(i.getRankLabel(i.selectedReDrawPosition)))]),r("div",{staticClass:"flick-prize mb-2 text-white"},[i._v(" "+i._s(i.getPrizeDescription(i.selectedReDrawPosition))+" ")]),r("div",{staticClass:"flick-number"},[i._v(" "+i._s((null===(t=i.reDrawFlickResults[i.selectedReDrawPosition])||void 0===t?void 0:t.LUCKY_DRAW_NO)||"0000")+" ")]),r("div",{staticClass:"flick-name"},[i._v(" "+i._s((null===(e=i.reDrawFlickResults[i.selectedReDrawPosition])||void 0===e?void 0:e.PARTICIPANT_NAME)||"---")+" ")]),r("div",{staticClass:"flick-department mb-2 text-white"},[i._v(" "+i._s((null===(a=i.reDrawFlickResults[i.selectedReDrawPosition])||void 0===a?void 0:a.DEPARTMENT)||"---")+" ")])])]),r("div",{staticClass:"text-center mt-4"},[r("b-button",{staticClass:"mx-2 px-4 py-2 start-btn",attrs:{variant:"success",size:"lg",disabled:i.isReDrawFlicking},on:{click:i.startReDrawFlicking}},[r("i",{staticClass:"fas fa-play mr-2"}),i._v(" Redraw ")]),i.isReDrawWinnerDeclare?r("b-button",{staticClass:"mx-2 px-4 py-2",attrs:{variant:"success",size:"lg"},on:{click:i.updateReDrawWinnerDetails}},[r("i",{staticClass:"fas fa-save mr-2"}),i._v(" Confirm New Winner ")]):i._e(),r("b-button",{staticClass:"mx-2 px-4 py-2 close-btn",attrs:{variant:"outline-light",size:"lg"},on:{click:function(t){return i.$bvModal.hide("preDrawReDrawModal")}}},[r("i",{staticClass:"fas fa-times mr-2"}),i._v(" Close ")])],1)]),r("b-modal",{attrs:{id:"preDrawDisplayControlModal","hide-header":"",size:"xl","hide-footer":"",centered:"","body-class":"pre-draw-modal"}},[r("div",{staticClass:"text-center mb-0"},[r("h2",{staticClass:"modal-title"},[i._v("🎯 Pre-Draw Winner List")])]),r("div",{staticClass:"d-flex flex-wrap justify-content-center"},i._l(i.getPreDrawWinnerData[i.currentSlideIndex],(function(t){return r("div",{key:"modal-rank-"+t.PRIZE_POSITION,staticClass:"flick-box m-2 text-center"},[r("div",{staticClass:"flick-rank"},[i._v(i._s(i.getRankLabel(t.PRIZE_POSITION)))]),r("div",{staticClass:"flick-prize mb-2 text-white"},[i._v(i._s(t.PRIZE_WON||t.PRIZE_NAME))]),r("div",{staticClass:"flick-number"},[i._v(i._s((null===t||void 0===t?void 0:t.LUCKY_DRAW_NO)||"0000"))]),r("div",{staticClass:"flick-name"},[i._v(i._s((null===t||void 0===t?void 0:t.PARTICIPANT_NAME)||(null===t||void 0===t?void 0:t.NAME)||"---"))]),r("div",{staticClass:"flick-department text-white"},[i._v(i._s(t.DEPARTMENT))])])})),0),r("div",{staticClass:"text-center mt-3"},[r("b-button",{staticClass:"mx-2",attrs:{variant:"outline-light",size:"lg",disabled:0===i.currentSlideIndex},on:{click:i.goToPrevSlide}},[r("i",{staticClass:"fas fa-arrow-left mr-2"}),i._v(" Prev ")]),r("span",{staticClass:"text-white mx-3 h5"},[i._v(" Page "+i._s(i.currentSlideIndex+1)+" / "+i._s(i.getPreDrawWinnerData.length)+" ")]),r("b-button",{staticClass:"mx-2",attrs:{variant:"outline-light",size:"lg",disabled:i.currentSlideIndex===i.getPreDrawWinnerData.length-1},on:{click:i.goToNextSlide}},[i._v(" Next "),r("i",{staticClass:"fas fa-arrow-right ml-2"})]),r("b-button",{staticClass:"mx-2 px-4 py-2 close-btn",attrs:{variant:"outline-light",size:"lg"},on:{click:function(t){return i.$bvModal.hide("preDrawDisplayControlModal")}}},[r("i",{staticClass:"fas fa-times mr-2"}),i._v(" Close ")])],1)])],1)},ot=[function(){var t=this,e=t._self._c;return e("h5",{staticClass:"font-weight-bold"},[e("i",{staticClass:"fas fa-trophy mr-2 text-warning"}),t._v("Prize Ranks ")])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"col-md-6"},[e("div",{staticClass:"prize-legend"},[e("div",{staticClass:"legend-item"},[e("span",{staticClass:"legend-box legend-empty"}),e("span",{staticClass:"legend-text"},[t._v("Available")])]),e("div",{staticClass:"legend-item"},[e("span",{staticClass:"legend-box legend-filled"}),e("span",{staticClass:"legend-text"},[t._v("Winner Selected")])])])])}],ct={data:function(){return{drawSettingData:null,eventSysId:null,winnersList:[],allEventWinners:[],preDrawParticipantsList:[],drawOrderValue:"bottom-to-top",showPreDrawModal:!1,isFlicking:!1,flickResults:{},prizeListData:[],isPreDrawWinnerDeclare:!1,selectedReDrawPosition:null,reDrawFlickResults:{},isReDrawWinnerDeclare:!1,isReDrawFlicking:!1,currentSlideIndex:0,channel:null}},computed:{totalPrizePositions:function(){var t,e;return this.drawSettingData?parseInt((null===(t=this.drawSettingData)||void 0===t?void 0:t.PD_TO_NUMBER)||0)-parseInt((null===(e=this.drawSettingData)||void 0===e?void 0:e.PD_FROM_NUMBER)||0)+1:0},isDrawComplete:function(){var t;return!!this.totalPrizePositions&&((null===(t=this.allEventWinners)||void 0===t?void 0:t.length)||0)>=this.totalPrizePositions},prizeRanks:function(){var t,e;if(!this.drawSettingData)return[];var a=parseInt((null===(t=this.drawSettingData)||void 0===t?void 0:t.PD_FROM_NUMBER)||0),i=parseInt((null===(e=this.drawSettingData)||void 0===e?void 0:e.PD_TO_NUMBER)||0);return i<a?[]:Array.from({length:i-a+1},(function(t,e){return a+e}))},getPreDrawWinnerData:function(){var t,e;if(null===(t=this.winnersList)||void 0===t||!t.length)return[];var a=this.drawOrderValue||"bottom-to-top",i=(null===(e=this.drawSettingData)||void 0===e?void 0:e.PD_NO_OF_PRIZE_POSITION)||5,r=Object(u["a"])(this.winnersList);r.sort((function(t,e){return"bottom-to-top"===a?e.PRIZE_POSITION-t.PRIZE_POSITION:t.PRIZE_POSITION-e.PRIZE_POSITION}));for(var n=[],s=0;s<r.length;s+=i)n.push(r.slice(s,s+i));return n}},mounted:function(){this.channel=new BroadcastChannel("vue-global-events"),this.eventSysId=JSON.parse(localStorage.getItem("selectedEventSysId")),this.fetchDrawSettingsData(),this.fetchPreDrawWinnersListData(),this.fetchPreDrawPrizeListData()},beforeDestroy:function(){this.channel&&this.channel.close()},methods:{broadcastCurrentSlide:function(){var t=this.getPreDrawWinnerData[this.currentSlideIndex]||[],e=t.map((function(t){return{PRIZE_POSITION:t.PRIZE_POSITION,PRIZE_WON:t.PRIZE_WON||t.PRIZE_NAME||"---",LUCKY_DRAW_NO:t.LUCKY_DRAW_NO||"0000",PARTICIPANT_NAME:t.PARTICIPANT_NAME||t.NAME||"---",DEPARTMENT:t.DEPARTMENT||"---"}}));this.channel.postMessage({action:"Update-Pre-Draw-Display",winners:e})},goToNextSlide:function(){this.currentSlideIndex<this.getPreDrawWinnerData.length-1&&(this.currentSlideIndex++,this.broadcastCurrentSlide())},goToPrevSlide:function(){this.currentSlideIndex>0&&(this.currentSlideIndex--,this.broadcastCurrentSlide())},openPreDrawDisplayControlModal:function(){var t=this;this.fetchPreDrawWinnersListData(),this.currentSlideIndex=0,setTimeout((function(){t.broadcastCurrentSlide(),t.$bvModal.show("preDrawDisplayControlModal")}),300)},openReDrawModal:function(t){this.fetchPreDrawParticipantsListData(),this.isReDrawWinnerDeclare=!1,this.selectedReDrawPosition=t,this.reDrawFlickResults={},this.$bvModal.show("preDrawReDrawModal")},openPreDrawModal:function(){this.fetchPreDrawParticipantsListData(),this.flickResults={},this.isPreDrawWinnerDeclare=!1,this.showPreDrawModal=!0},getExistingWinner:function(t){var e=this.allEventWinners.find((function(e){return Number(e.PRIZE_POSITION)===Number(t)}));return e?{LUCKY_DRAW_NO:e.LUCKY_DRAW_NO,PARTICIPANT_NAME:e.PARTICIPANT_NAME||e.NAME,DEPARTMENT:e.DEPARTMENT||"---"}:null},startFlicking:function(){var t=this;this.isFlicking=!0,this.isPreDrawWinnerDeclare=!1,this.flickResults={};var e=new Set(this.allEventWinners.map((function(t){return t.PARTICIPANTS_SYS_ID}))),a=new Set;this.prizeRanks.forEach((function(i,r){var n=t.allEventWinners.find((function(t){return Number(t.PRIZE_POSITION)===Number(i)})),s=setInterval((function(){t.$set(t.flickResults,i,{LUCKY_DRAW_NO:t.randomNumber(),PARTICIPANT_NAME:"",PRIZE_NAME:"",DEPARTMENT:""})}),100);setTimeout((function(){clearInterval(s);var r=null;if(n)r={LUCKY_DRAW_NO:n.LUCKY_DRAW_NO,PARTICIPANT_NAME:n.PARTICIPANT_NAME||n.NAME,DEPARTMENT:n.DEPARTMENT||"---",PRIZE_NAME:"".concat(t.getPrizeDescription(i)),PRIZE_POSITION:i,PARTICIPANTS_SYS_ID:n.PARTICIPANTS_SYS_ID};else{var l=t.preDrawParticipantsList.filter((function(t){return!e.has(t.PARTICIPANTS_SYS_ID)&&!a.has(t.PARTICIPANTS_SYS_ID)})),o=l.length>0?l:t.preDrawParticipantsList.filter((function(t){return!a.has(t.PARTICIPANTS_SYS_ID)}));if(0===o.length)r={LUCKY_DRAW_NO:"N/A",PARTICIPANT_NAME:"No Participants",DEPARTMENT:"---",PRIZE_POSITION:i};else{var c=Math.floor(Math.random()*o.length),u=o[c];null!==u&&void 0!==u&&u.PARTICIPANTS_SYS_ID&&a.add(u.PARTICIPANTS_SYS_ID),r={LUCKY_DRAW_NO:(null===u||void 0===u?void 0:u.LUCKY_DRAW_NO)||"0000",PARTICIPANT_NAME:(null===u||void 0===u?void 0:u.PARTICIPANT_NAME)||"---",DEPARTMENT:(null===u||void 0===u?void 0:u.DEPARTMENT)||"---",PRIZE_NAME:"".concat(t.getPrizeDescription(i)),PRIZE_POSITION:i,PARTICIPANTS_SYS_ID:null===u||void 0===u?void 0:u.PARTICIPANTS_SYS_ID}}}t.$set(t.flickResults,i,r)}),3e3+50*r)})),setTimeout((function(){t.isPreDrawWinnerDeclare=!0,t.isFlicking=!1}),4e3+50*this.prizeRanks.length)},startReDrawFlicking:function(){var t=this;this.isReDrawFlicking=!0,this.isReDrawWinnerDeclare=!1;var e=this.selectedReDrawPosition;this.reDrawFlickResults=Object(l["a"])({},e,{});var a=setInterval((function(){t.$set(t.reDrawFlickResults,e,{LUCKY_DRAW_NO:t.randomNumber(),PARTICIPANT_NAME:"",PRIZE_NAME:"",DEPARTMENT:"---"})}),100);setTimeout((function(){clearInterval(a);var i=new Set(t.allEventWinners.map((function(t){return t.PARTICIPANTS_SYS_ID}))),r=t.preDrawParticipantsList.filter((function(t){return!i.has(t.PARTICIPANTS_SYS_ID)})),n=r.length>0?r:t.preDrawParticipantsList,s=Math.floor(Math.random()*n.length),l=n[s];t.$set(t.reDrawFlickResults,e,{LUCKY_DRAW_NO:(null===l||void 0===l?void 0:l.LUCKY_DRAW_NO)||"0000",PARTICIPANT_NAME:(null===l||void 0===l?void 0:l.PARTICIPANT_NAME)||"---",PRIZE_NAME:"".concat(t.getPrizeDescription(e)),PRIZE_POSITION:e,PARTICIPANTS_SYS_ID:null===l||void 0===l?void 0:l.PARTICIPANTS_SYS_ID,DEPARTMENT:(null===l||void 0===l?void 0:l.DEPARTMENT)||"---"}),t.isReDrawFlicking=!1,t.isReDrawWinnerDeclare=!0}),3e3)},getPrizeDescription:function(t){var e,a=null===(e=this.prizeListData)||void 0===e?void 0:e.find((function(e){return Number(e.PRIZE_POSITION)==Number(t)}));return(null===a||void 0===a?void 0:a.PRIZE_NAME)||"---"},randomNumber:function(){return Math.floor(1e3+9e3*Math.random()).toString()},fetchDrawSettingsData:function(){var t=this,e={ITEM:"VIEW_ALL",EVENT_SYS_ID:this.eventSysId,LUCKY_DRAW_TYPE:"PRE_DRAW"};this.$apiCall.get(this.$apiBus.api_get_control_panel_info,{params:e}).then((function(e){"true"===e.status&&e.response.length>0&&(t.drawSettingData=e.response[0])}))},fetchPreDrawWinnersListData:function(){var t=this,e={ITEM:"VIEW_ALL",EVENT_SYS_ID:this.eventSysId};this.$apiCall.get(this.$apiBus.api_get_winner_info,{params:e}).then((function(e){"true"===e.status?(t.allEventWinners=e.response,t.winnersList=e.response.filter((function(t){return"Pre-Draw"===t.LUCKY_DRAW_TYPE}))):(t.winnersList=[],t.allEventWinners=[])}))},fetchPreDrawPrizeListData:function(){var t=this,e={ITEM:"VIEW_ALL",EVENT_SYS_ID:this.eventSysId};this.$apiCall.get(this.$apiBus.api_get_prize_info,{params:e}).then((function(e){"true"===e.status?t.prizeListData=e.response.filter((function(t){return"Pre-Draw"===t.LUCKY_DRAW_TYPE})):t.prizeListData=[]}))},fetchPreDrawParticipantsListData:function(){var t=this,e={ITEM:"SPECIFIC",ORGANIZATION_SYS_ID:"1",EVENT_SYS_ID:this.eventSysId,DRAW_TYPE:"Pre-Draw"};this.$apiCall.get(this.$apiBus.api_post_lucky_draw_participant_list,{params:e}).then((function(e){t.preDrawParticipantsList="true"===e.status?e.response:[]}))},isRankFilled:function(t){var e;return null===(e=this.allEventWinners)||void 0===e?void 0:e.some((function(e){return Number(e.PRIZE_POSITION)===Number(t)}))},getRankLabel:function(t){var e=parseInt(t);if(isNaN(e))return"";if(e%100>=11&&e%100<=13)return"".concat(e,"th Place");switch(e%10){case 1:return"".concat(e,"st Position");case 2:return"".concat(e,"nd Position");case 3:return"".concat(e,"rd Position");default:return"".concat(e,"th Position")}},savePreDrawWinnerDetails:function(){var t=this;return Object(_["a"])(Object(p["a"])().mark((function e(){var a,i;return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.eventSysId){e.next=2;break}return e.abrupt("return");case 2:if(a=Object.values(t.flickResults).filter((function(t){return t.PARTICIPANTS_SYS_ID})).filter((function(e){return!t.allEventWinners.some((function(t){return Number(t.PRIZE_POSITION)===Number(e.PRIZE_POSITION)}))})).map((function(e){return{ITEM:"ADD",ORGANIZATION_SYS_ID:"1",PARTICIPANTS_SYS_ID:String(e.PARTICIPANTS_SYS_ID),EVENT_SYS_ID:String(t.eventSysId),LUCKY_DRAW_NO:String(e.LUCKY_DRAW_NO),LUCKY_DRAW_TYPE:"Pre-Draw",PRIZE_POSITION:String(e.PRIZE_POSITION),CREATED_BY:"1"}})),0!==a.length){e.next=8;break}return t.$bvModal.hide("preDrawModal"),t.showPreDrawModal=!1,t.fetchPreDrawWinnersListData(),e.abrupt("return");case 8:return e.prev=8,e.next=11,t.$apiCall.post(t.$apiBus.api_post_lucky_winner,a);case 11:i=e.sent,"true"===i.status?(t.$bvModal.hide("preDrawModal"),t.showPreDrawModal=!1,t.fetchPreDrawWinnersListData()):console.error("API returned error:",i),e.next=18;break;case 15:e.prev=15,e.t0=e["catch"](8),console.error("Save API failed:",e.t0);case 18:case"end":return e.stop()}}),e,null,[[8,15]])})))()},updateReDrawWinnerDetails:function(){var t=this;return Object(_["a"])(Object(p["a"])().mark((function e(){var a,i,r;return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.eventSysId){e.next=2;break}return e.abrupt("return");case 2:if(a=t.reDrawFlickResults[t.selectedReDrawPosition],a&&a.PARTICIPANTS_SYS_ID){e.next=5;break}return e.abrupt("return");case 5:return i={ITEM:"RE_DRAW",ORGANIZATION_SYS_ID:"1",PARTICIPANTS_SYS_ID:String(a.PARTICIPANTS_SYS_ID),EVENT_SYS_ID:String(t.eventSysId),LUCKY_DRAW_NO:String(a.LUCKY_DRAW_NO),LUCKY_DRAW_TYPE:"Pre-Draw",PRIZE_POSITION:String(a.PRIZE_POSITION),CREATED_BY:"1"},e.prev=6,e.next=9,t.$apiCall.post(t.$apiBus.api_post_lucky_winner,i);case 9:r=e.sent,"true"===r.status&&(t.isReDrawWinnerDeclare=!1,t.selectedReDrawPosition=null,t.reDrawFlickResults={},t.$bvModal.hide("preDrawReDrawModal"),t.fetchPreDrawWinnersListData()),e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](6),console.error(e.t0);case 16:case"end":return e.stop()}}),e,null,[[6,13]])})))()}}},ut=ct,dt=(a("34fd"),a("c228"),Object(g["a"])(ut,lt,ot,!1,null,"4da408bc",null)),pt=dt.exports,_t=a("20b2"),vt={components:{eventLuckyDrawParticipentNewVue:B,eventLuckyDrawWinner:tt,BIconPencilSquare:v["kt"],BIconTrash:v["Py"],ValidationObserver:f["a"],ValidationProvider:f["b"],eventLuckydrawnew:k,eventLiveDraw:G,PreliveEvent:st,PreDrawEvent:pt,CreateBackdrop:_t["default"]},data:function(){return{winners:[],filteredWinners:[],winnersSearchQuery:"",selectedWinnerDrawType:null,showParticipantImportModalOld:!1,showParticipantImportModal:!1,participantExcelData:[],participantTableFields:[{key:"S_NO",label:"S/N"},{key:"LUCKY_DRAW_NO",label:"Lucky Draw Number"},{key:"PARTICIPANT_NAME",label:"Participant Name"}],isImportingParticipants:!1,tableLoaded:!1,Table_list_details:[],formData:{EMP_ID:"",PERSON_NAME:"",PERSON_EMAIL:"",PERSON_CONTACT_NO:"",DESIGNATION:"",COMPANY_NAME:"",TICKET_ID:"",TABLE_NO:"",CHECKED_IN_FLAG:"",HOW_HEARD:""},filter:"",selectedPrizeDrawType:null,isLoading:!1,event_sys_id:null,controlPanelLiveParticipants:[],controlPanelPreDrawParticipants:[],controlPanelPreLiveParticipants:[],specific_event_details:{},showBeneficiaryModal:!1,activeControlPanelTab:"LIVE",excelData:[],tableFields:[{key:"S_NO",label:"S/N"},{key:"PERSON_NAME",label:"Name"},{key:"PERSON_EMAIL",label:"Email"},{key:"PERSON_CONTACT_NO",label:"Phone"},{key:"COMPANY_NAME",label:"Company"},{key:"DESIGNATION",label:"Designation"},{key:"HOW_HEARD",label:"How Heard"}],liveDraw:{enabled:!1,fromNumber:null,toNumber:null,prizePositions:null},preLiveDraw:{enabled:!1,fromNumber:null,toNumber:null,prizePositions:null},preDraw:{enabled:!1,fromNumber:null,toNumber:null,prizePositions:null},earlyBird:{enabled:!1,fromNumber:null,toNumber:null,prizePositions:null},spinningWheel:{enabled:!1,fromNumber:null,toNumber:null,prizePositions:null},doorGift:{enabled:!1,fromNumber:null,toNumber:null,prizePositions:null},liveParticipantFields:[{key:"TICKET_ID",label:"Ticket ID"},{key:"PERSON_NAME",label:"Participant Name"},{key:"PERSON_EMAIL",label:"Email"},{key:"PERSON_CONTACT_NO",label:"Contact Number"},{key:"TABLE_NO",label:"Table No",thClass:"text-left"}],preDrawParticipantFields:[{key:"TICKET_ID",label:"Ticket ID"},{key:"PERSON_NAME",label:"Participant Name"},{key:"PERSON_EMAIL",label:"Email"},{key:"PERSON_CONTACT_NO",label:"Contact Number"},{key:"TABLE_NO",label:"Table No",thClass:"text-left"}],preLiveParticipantFields:[{key:"TICKET_ID",label:"Ticket ID"},{key:"PERSON_NAME",label:"Participant Name"},{key:"PERSON_EMAIL",label:"Email"},{key:"PERSON_CONTACT_NO",label:"Contact Number"},{key:"TABLE_NO",label:"Table No",thClass:"text-left"}],participantFields:[{key:"INDEX",label:"S/N"},{key:"LUCKY_DRAW_NO",label:"Lucky Draw Number"},{key:"PARTICIPANT_NAME",label:"Participant Name"}],winnerFieldOptions:[],initialWinnerFieldOptions:[{key:"INDEX",label:"S/N",visible:!0,disabled:!0},{key:"LUCKY_DRAW_NO",label:"Lucky Draw Number",visible:!0,disabled:!1},{key:"PARTICIPANT_NAME",label:"Name",visible:!0,disabled:!1},{key:"PRIZE_WON",label:"Prize Won",visible:!0,disabled:!1},{key:"LUCKY_DRAW_TYPE",label:"Lucky Draw Type",visible:!0,disabled:!1},{key:"PRIZE_POSITION",label:"Prize Position",visible:!0,disabled:!1},{key:"REDEEMED",label:"Redeemed",visible:!0,disabled:!1}],prizeFields:[{key:"index",label:"S/N"},{key:"PRIZE_NAME",label:"Prize Name"},{key:"PRIZE_POSITION",label:"Prize Position"},{key:"LUCKY_DRAW_TYPE",label:"Draw Type"}],showPrizeImportModal:!1,prizeExcelData:[],prizeTableFields:[{key:"S_NO",label:"S/N"},{key:"PRIZE_NAME",label:"Prize Name"},{key:"PRIZE_POSITION",label:"Prize Position"},{key:"LUCKY_DRAW_TYPE",label:"Draw Type"},{key:"LUCKY_DRAW_NO",label:"Lucky Draw Number"}],isImportingPrizes:!1,newPrize:{draw:"",name:"",position:"",description:""},updatePrizeData:null,prizes:[],participants:[],participantsDataLoaded:!1,isImporting:!1,participantSearchQuery:"",selectedLiveDrawType:"LUCKY_DRAW",selectedLuckyDrawSubType:null,drawOrder:null,drawTypeOptions:[{value:null,text:"All Draw Types"},{value:"LIVE",text:"Live Draw"},{value:"PRE_LIVE",text:"Pre-Live Draw"},{value:"PRE_DRAW",text:"Pre-Draw"},{value:"EARLY_BIRD",text:"Early Bird"},{value:"SPINNING_WHEEL",text:"Spinning Wheel"},{value:"DOOR_GIFT",text:"Door Gift"}],drawTypeApiMap:{LIVE:"Live Draw",PRE_LIVE:"Pre-Live Draw",PRE_DRAW:"Pre-Draw",EARLY_BIRD:"Early Bird",SPINNING_WHEEL:"Spinning Wheel",DOOR_GIFT:"Door Gift"},channel:null,luckydrawbg:w.a,isDrawing:!1,availableNumbers:[],animationTimers:[],mainDisplayDigits:[],currentPrizePosition:0,fromNumber:0,toNumber:0,existingWinners:[],currentWinner:null,winnerFound:!1,isSavingWinner:!1,isProgrammaticUpdate:!1,displayWinnerBy:"",displayWinnerPrizeBy:"",currentDrawIndex:null}},mounted:function(){this.channel=new BroadcastChannel("vue-global-events"),this.event_sys_id=JSON.parse(localStorage.getItem("selectedEventSysId"))||6;var t=JSON.parse(localStorage.getItem("userInfo"));this.user_sys_id=(null===t||void 0===t?void 0:t.user_id)||1;var e=localStorage.getItem("winnerFieldOptions");this.winnerFieldOptions=e?JSON.parse(e):JSON.parse(JSON.stringify(this.initialWinnerFieldOptions)),this.getControlPanelLiveData("LIVE"),this.getParticipantDetailsInfo(),this.getSpecificEvent(),this.getEventSeatingArrangement(),this.getPrizeDetailsInfo();for(var a=0;a<4;a++)this.mainDisplayDigits.push({current:"0",next:"0",isFlipping:!1})},beforeDestroy:function(){this.animationTimers.forEach((function(t){return clearInterval(t)}))},watch:{winnerFieldOptions:{handler:function(t){localStorage.setItem("winnerFieldOptions",JSON.stringify(t))},deep:!0}},computed:{filteredParticipants:function(){if(!this.participantSearchQuery||""===this.participantSearchQuery.trim())return this.participants;var t=this.participantSearchQuery.toLowerCase().trim();return this.participants.filter((function(e){var a=(e.PERSON_NAME||"").toLowerCase(),i=(e.PERSON_EMAIL||"").toLowerCase(),r=(e.PERSON_CONTACT_NO||"").toString().toLowerCase();return a.includes(t)||i.includes(t)||r.includes(t)}))},visibleWinnerFields:function(){return this.winnerFieldOptions.filter((function(t){return t.visible}))},tableOptions:function(){return this.Table_list_details.map((function(t){return{value:t.TABLE_NO,text:t.TABLE_NO.toString()}}))},getAuthUser:function(){var t=JSON.parse(localStorage.getItem("userInfo"));return t||{UserId:1}},getLiveDrawTitle:function(){var t={LUCKY_DRAW:"Lucky Draw".concat(this.selectedLuckyDrawSubType?" - ".concat(this.selectedLuckyDrawSubType.replace("_"," ")):""),SPINNING_WHEEL:"Spinning Wheel",EARLY_BIRD:"Early Bird Draw",DOOR_GIFT:"Door Gift Draw"};return t[this.selectedLiveDrawType]||"Live Draw"},getLiveDrawDescription:function(){var t={LUCKY_DRAW:"Start the lucky draw flipper session to randomly select winners with animated number flipping.",SPINNING_WHEEL:"Launch the spinning wheel to randomly select winners in an interactive wheel format.",EARLY_BIRD:"Conduct early bird draw for participants who registered or arrived early.",DOOR_GIFT:"Distribute door gifts to all registered participants."};return t[this.selectedLiveDrawType]||"Select a draw type to proceed"},getDrawSettings:function(){if("LUCKY_DRAW"===this.selectedLiveDrawType&&this.selectedLuckyDrawSubType){var t={LIVE:this.liveDraw,PRE_LIVE:this.preLiveDraw,PRE_DRAW:this.preDraw};return t[this.selectedLuckyDrawSubType]||{enabled:!1,fromNumber:null,toNumber:null}}var e={EARLY_BIRD:this.earlyBird,SPINNING_WHEEL:{enabled:!0,fromNumber:1,toNumber:100},DOOR_GIFT:{enabled:!0,fromNumber:null,toNumber:null}};return e[this.selectedLiveDrawType]||{enabled:!1,fromNumber:null,toNumber:null}},canStartDraw:function(){return"LUCKY_DRAW"===this.selectedLiveDrawType?this.selectedLuckyDrawSubType&&this.getDrawSettings.enabled:null!==this.selectedLiveDrawType},showPrizeBoxes:function(){if("LUCKY_DRAW"===this.selectedLiveDrawType&&this.selectedLuckyDrawSubType){var t=this.getDrawSettings;return t.enabled&&t.fromNumber&&t.toNumber}return"EARLY_BIRD"===this.selectedLiveDrawType?this.earlyBird.enabled&&this.earlyBird.fromNumber&&this.earlyBird.toNumber:"SPINNING_WHEEL"===this.selectedLiveDrawType},totalPrizePositions:function(){if("LUCKY_DRAW"===this.selectedLiveDrawType&&this.selectedLuckyDrawSubType){var t=this.getDrawSettings;return t.fromNumber&&t.toNumber?parseInt(t.toNumber)-parseInt(t.fromNumber)+1:0}return"EARLY_BIRD"===this.selectedLiveDrawType?this.earlyBird.fromNumber&&this.earlyBird.toNumber?parseInt(this.earlyBird.toNumber)-parseInt(this.earlyBird.fromNumber)+1:0:"SPINNING_WHEEL"===this.selectedLiveDrawType?10:0},filteredPrizes:function(){var t=this.prizes;if(this.selectedPrizeDrawType){var e=this.drawTypeApiMap[this.selectedPrizeDrawType];t=t.filter((function(t){return t.LUCKY_DRAW_TYPE===e}))}if(this.filter&&""!==this.filter.trim()){var a=this.filter.toLowerCase().trim();t=t.filter((function(t){var e=(t.PRIZE_NAME||"").toLowerCase(),i=(t.LUCKY_DRAW_TYPE||"").toLowerCase(),r=(t.PRIZE_DESCRIPTION||"").toLowerCase();return e.includes(a)||i.includes(a)||r.includes(a)}))}return t},apiLuckyDrawType:function(){if(!this.selectedLuckyDrawSubType)return"";var t=this.selectedLuckyDrawSubType.toUpperCase();switch(t){case"LIVE":return"Live Draw";case"PRE_LIVE":case"PRE_LIVE_DRAW":return"Pre Live Draw";case"PRE_DRAW":return"Pre Draw";default:return this.selectedLuckyDrawSubType}}},methods:(r={selectLuckyType:function(t){this.selectedLuckyDrawSubType=t,this.onLuckyDrawSubTypeChange(t)},formatDate:function(t){if(!t)return"";var e=new Date(t);return e.toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})},runVisualAnimationOnly:function(){var t=this;if(!this.isDrawing){var e=this.prizes.find((function(e){return e.PRIZE_POSITION==t.currentPrizePosition&&e.LUCKY_DRAW_TYPE===t.apiLuckyDrawType}));this.channel.postMessage({action:"start",prizeName:null===e||void 0===e?void 0:e.PRIZE_NAME,prizePosition:this.currentPrizePosition}),this.isDrawing=!0,this.startCasinoAnimation(),setTimeout((function(){var e=Math.floor(Math.random()*t.availableNumbers.length),a=t.availableNumbers[e],i=a?a.LUCKY_DRAW_NO:"0000";t.stopCasinoAnimation(i)}),8e3)}},saveDrawOrder:function(){var t=this;return Object(_["a"])(Object(p["a"])().mark((function e(){var a,i;return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.drawOrder){e.next=2;break}return e.abrupt("return");case 2:return D.a.start(),a={ITEM:"UPDATE_LUCKY_DRAW_ORDER",EVENT_SYS_ID:t.event_sys_id.toString(),LD_TOP_TO_BUTTON_ORDER:"top-to-bottom"===t.drawOrder?"1":"0",LD_BUTTON_TO_TOP_ORDER:"bottom-to-top"===t.drawOrder?"1":"0"},e.prev=4,e.next=7,t.$apiCall.post(t.$apiBus.api_post_lucky_draw,a);case 7:i=e.sent,"true"!==i.status?m["a"].showErrorAlert(!0,"error",i.response||"Failed to save draw order."):console.log("Draw order saved successfully."),e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](4),console.error("Error saving draw order:",e.t0),m["a"].showErrorAlert(!0,"error","An unexpected error occurred while saving the draw order.");case 15:return e.prev=15,D.a.done(),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[4,11,15,18]])})))()},filterWinners:function(){var t=this.winnersSearchQuery.trim().toLowerCase(),e=this.winners;if(this.selectedWinnerDrawType){var a=this.drawTypeApiMap[this.selectedWinnerDrawType];e=e.filter((function(t){return t.LUCKY_DRAW_TYPE===a}))}this.filteredWinners=t?e.filter((function(e){var a=e.PARTICIPANT_NAME?e.PARTICIPANT_NAME.toLowerCase():"",i=e.LUCKY_DRAW_NO?e.LUCKY_DRAW_NO.toString().toLowerCase():"";return a.includes(t)||i.includes(t)})):e},markAsRedeemed:function(t){var e=this;D.a.start(),D.a.set(.1),this.isLoading=!0;var a=[{ITEM:"REDEEMED",WINNER_SYS_ID:t.WINNER_SYS_ID,REDEEMED:"Y"}];this.$apiCall.post(this.$apiBus.api_post_lucky_winner,a).then((function(t){t.status,e.getWinnerDetailsInfo()})).catch((function(t){console.error("Error ",t),m["a"].showErrorAlert(!0,"error","Failed to update winners"),e.getWinnerDetailsInfo()})).finally((function(){e.isLoading=!1,D.a.done()}))},applyWinnerFilter:function(){this.filterWinners()},triggerParticipantFileInput:function(){this.participantExcelData=[],this.$refs.participantFileInput.value="",this.$refs.participantFileInput.click()},fetchEligibleParticipants:function(){var t=this;return Object(_["a"])(Object(p["a"])().mark((function e(){var a,i;return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return D.a.start(),t.isLoading=!0,e.prev=2,a={ITEM:"SPECIFIC",ORGANIZATION_SYS_ID:"1",EVENT_SYS_ID:t.event_sys_id,DRAW_TYPE:"Live Draw"},e.next=6,t.$apiCall.get(t.$apiBus.api_post_lucky_draw_participant_list,{params:a});case 6:i=e.sent,"true"===i.status&&Array.isArray(i.response)?t.participants=i.response:t.participants=[],e.next=15;break;case 10:e.prev=10,e.t0=e["catch"](2),console.error("Error fetching eligible participants:",e.t0),t.participants=[],m["a"].showErrorAlert(!0,"error","An error occurred while fetching participants.");case 15:return e.prev=15,t.isLoading=!1,D.a.done(),e.finish(15);case 19:case"end":return e.stop()}}),e,null,[[2,10,15,19]])})))()},handleParticipantFileUpload:function(t){var e=this,a=t.target.files[0];if(a){var i=new FileReader;i.onload=function(t){try{var a=new Uint8Array(t.target.result),i=h["b"](a,{type:"array"}),r=i.Sheets[i.SheetNames[0]],n=h["c"].sheet_to_json(r);e.participantExcelData=n.map((function(t,e){var a=Object.keys(t).reduce((function(e,a){return e[a.trim().toLowerCase()]=t[a],e}),{});return{S_NO:a["s/n"]||a["no"]||a["sl no"]||a["serial no"]||e+1,LUCKY_DRAW_NO:a["lucky draw number"]||a["luckydrawnumber"]||a["lucky_draw_no"]||a["draw no"]||a["drawnumber"]||"",PARTICIPANT_NAME:a["participant name"]||a["participantname"]||a["participant_name"]||a["name"]||""}})).filter((function(t){var e,a;return(null===(e=t.PARTICIPANT_NAME)||void 0===e?void 0:e.toString().trim())&&(null===(a=t.LUCKY_DRAW_NO)||void 0===a?void 0:a.toString().trim())})),0===e.participantExcelData.length&&m["a"].showErrorAlert(!0,"error","No valid participant data found in Excel file.")}catch(s){console.error("Error processing Excel file:",s),m["a"].showErrorAlert(!0,"error","Error processing Excel file"),e.participantExcelData=[]}},i.readAsArrayBuffer(a)}},onHandleImportParticipantData:function(){var t=this;return Object(_["a"])(Object(p["a"])().mark((function e(){var a,i;return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!==t.participantExcelData.length){e.next=3;break}return m["a"].showErrorAlert(!0,"error","No data to import"),e.abrupt("return");case 3:return t.isImportingParticipants=!0,D.a.start(),D.a.set(.1),e.prev=6,a=t.participantExcelData.map((function(e){var a;return{ITEM:"ADD",PARTICIPANTS_SYS_ID:"0",EVENT_SYS_ID:t.event_sys_id,LUCKY_DRAW_NO:e.LUCKY_DRAW_NO||"",PARTICIPANT_NAME:e.PARTICIPANT_NAME||e.NAME||"",CREATED_BY:(null===(a=t.getAuthUser)||void 0===a?void 0:a.UserId)||"1",ORGANIZATION_SYS_ID:"1"}})),e.next=10,t.$apiCall.post(t.$apiBus.api_post_lucky_draw_participant,a);case 10:i=e.sent,"true"===i.status||i.success?t.getParticipantDetailsInfo():m["a"].showErrorAlert(!0,"error","Failed to import participants"),t.showParticipantImportModal=!1,t.participantExcelData=[],t.$refs.participantFileInput.value="",e.next=21;break;case 17:e.prev=17,e.t0=e["catch"](6),console.error("Import error:",e.t0),m["a"].showErrorAlert(!0,"error","Error importing participant data");case 21:return e.prev=21,t.isImportingParticipants=!1,D.a.done(),e.finish(21);case 25:case"end":return e.stop()}}),e,null,[[6,17,21,25]])})))()},cancelParticipantUpload:function(){this.showParticipantImportModal=!1,this.participantExcelData=[],this.$refs.participantFileInput.value=""},downloadParticipantFormat:function(){var t=[["Lucky Draw Number","Participant Name"],["12345","John Doe"],["67890","Jane Smith"]],e=h["c"].book_new(),a=h["c"].aoa_to_sheet(t);h["c"].book_append_sheet(e,a,"Participants Format"),h["e"](e,"Participants_Format.xlsx")},showListSettingsModal:function(){this.$bvModal.show("list-settings-modal")},resetWinnerFields:function(){this.winnerFieldOptions=this.winnerFieldOptions.map((function(t){return t.disabled?Object(d["a"])(Object(d["a"])({},t),{},{visible:!0}):Object(d["a"])(Object(d["a"])({},t),{},{visible:!1})}))},getValidationState:function(t){var e=t.dirty,a=t.validated,i=t.valid,r=void 0===i?null:i;return e||a?r:null},getRankLabel:function(t){if(!t)return"";var e=parseInt(t,10);if(isNaN(e))return"";if(e%100>=11&&e%100<=13)return"".concat(e,"th Position");switch(e%10){case 1:return"".concat(e,"st Position");case 2:return"".concat(e,"nd Position");case 3:return"".concat(e,"rd Position");default:return"".concat(e,"th Position")}},isRankFilled:function(t){return this.winners.some((function(e){return e.PRIZE_POSITION===t}))},getSpecificEvent:function(){var t=this;D.a.start(),D.a.set(.1),this.isLoading=!0;var e={ITEM:"SPECIFIC",EVENT_SYS_ID:this.event_sys_id};this.$apiCall.get(this.$apiBus.api_get_specific_event_info,{params:e}).then((function(e){"true"==e.status&&(t.specific_event_details=e.response[0])})).finally((function(){t.isLoading=!1,D.a.done()}))},onPrizesTabClick:function(){this.getPrizeDetailsInfo()},onWinnersTabClick:function(){this.getWinnerDetailsInfo()},onParticipantsTabClick:function(){this.getParticipantDetailsInfo()},triggerFileInput:function(){this.excelData=[],this.$refs.fileInput.value="",this.$refs.fileInput.click()},handleFileUpload:function(t){var e=this,a=t.target.files[0];if(a){var i=new FileReader;i.onload=function(t){try{var a=new Uint8Array(t.target.result),i=h["b"](a,{type:"array"}),r=i.Sheets[i.SheetNames[0]],n=h["c"].sheet_to_json(r);e.excelData=n.map((function(t,e){return{S_NO:t["S/N"]||t["S_NO"]||e+1,PERSON_NAME:t["Name"]||t["PERSON_NAME"]||"",PERSON_EMAIL:t["Email"]||t["PERSON_EMAIL"]||"",PERSON_CONTACT_NO:t["Phone"]||t["Mobile No"]||t["PERSON_CONTACT_NO"]||"",COMPANY_NAME:t["Company"]||t["COMPANY_NAME"]||"",DESIGNATION:t["Designation"]||t["DESIGNATION"]||"",HOW_HEARD:t["How Heard About Us"]||t["HOW_HEARD"]||""}})).filter((function(t){return t.PERSON_NAME||t.PERSON_EMAIL}))}catch(s){console.error("Error processing Excel file:",s),e.$bvToast.toast("Error processing Excel file. Please check the file format.",{title:"Error",variant:"danger",solid:!0}),e.excelData=[]}},i.readAsArrayBuffer(a)}},downloadFormat:function(){var t=[["Name","Email","Phone","Company","Designation","How Heard About Us"]],e=h["c"].aoa_to_sheet(t),a=h["c"].book_new();h["c"].book_append_sheet(a,e,"Attendees Data"),h["e"](a,"Attendees_Format.xlsx")},onHandleImportBeneficiaryData:function(){var t=this;return Object(_["a"])(Object(p["a"])().mark((function e(){var a,i;return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!==t.excelData.length){e.next=3;break}return t.$bvToast.toast("No data to import",{title:"Error",variant:"danger",solid:!0}),e.abrupt("return");case 3:return t.isImporting=!0,D.a.start(),e.prev=5,a=t.excelData.map((function(e){return Object(d["a"])(Object(d["a"])({},e),{},{ITEM:"ADD",EVENT_SYS_ID:t.event_sys_id,CREATED_BY:t.user_sys_id,PARTICIPANTS_SYS_ID:0,EXCLUDE_LIVE:"N",EXCLUDE_PRE_LIVE:"N",EXCLUDE_PRE_DRAW:"N",EXCLUDE_EARLY_BIRD_DRAW:"N",EXCLUDE:"N"})})),e.next=9,t.$apiCall.post(t.$apiBus.api_post_lucky_draw_participant,a);case 9:i=e.sent,"true"===i.status?(t.$bvToast.toast("Data imported successfully! ".concat(a.length," records added."),{title:"Success",variant:"success",solid:!0}),t.getParticipantDetailsInfo(),t.showBeneficiaryModal=!1,t.excelData=[],t.$refs.fileInput.value=""):t.$bvToast.toast(i.response||"Failed to import data",{title:"Error",variant:"danger",solid:!0}),e.next=17;break;case 13:e.prev=13,e.t0=e["catch"](5),console.error("Import error:",e.t0),t.$bvToast.toast("Error importing data. Please try again.",{title:"Error",variant:"danger",solid:!0});case 17:return e.prev=17,t.isImporting=!1,D.a.done(),e.finish(17);case 21:case"end":return e.stop()}}),e,null,[[5,13,17,21]])})))()},cancelUpload:function(){this.excelData=[],this.showBeneficiaryModal=!1,this.$refs.fileInput.value=""},getControlPanelLiveData:function(t){var e=this;this.activeControlPanelTab=t,D.a.start(),D.a.set(.1),this.isLoading=!0;var a={ITEM:"VIEW_ALL",EVENT_SYS_ID:this.event_sys_id,LUCKY_DRAW_TYPE:t};this.$apiCall.get(this.$apiBus.api_get_control_panel_info,{params:a}).then((function(t){if(t.status&&"true"===t.status&&t.response.length>0){var a=t.response[0],i=function(t){return 1==t};e.liveDraw.enabled=i(a.LIVE_DRAW),e.liveDraw.fromNumber=a.LD_FROM_NUMBER,e.liveDraw.toNumber=a.LD_TO_NUMBER,e.liveDraw.prizePositions=a.LD_NO_OF_PRIZE_POSITION,e.preLiveDraw.enabled=i(a.LIVE_PRE_DRAW),e.preLiveDraw.fromNumber=a.LPD_FROM_NUMBER,e.preLiveDraw.toNumber=a.LPD_TO_NUMBER,e.preLiveDraw.prizePositions=a.LPD_NO_OF_PRIZE_POSITION,e.preDraw.enabled=i(a.PRE_DRAW),e.preDraw.fromNumber=a.PD_FROM_NUMBER,e.preDraw.toNumber=a.PD_TO_NUMBER,e.preDraw.prizePositions=a.PD_NO_OF_PRIZE_POSITION,e.earlyBird.enabled=i(a.EARLY_BIRD_DRAW),e.earlyBird.fromNumber=a.EBD_FROM_NUMBER,e.earlyBird.toNumber=a.EBD_TO_NUMBER,e.earlyBird.prizePositions=a.EBD_NO_OF_PRIZE_POSITION,e.spinningWheel.enabled=i(a.SPINNING_WHEEL),e.spinningWheel.fromNumber=a.SW_FROM_NUMBER,e.spinningWheel.toNumber=a.SW_TO_NUMBER,e.spinningWheel.prizePositions=a.SW_NO_OF_PRIZE_POSITION,e.doorGift.enabled=i(a.DOOR_GIFT),e.doorGift.fromNumber=a.DG_FROM_NUMBER,e.doorGift.toNumber=a.DG_TO_NUMBER,e.doorGift.prizePositions=a.DG_NO_OF_PRIZE_POSITION}})).catch((function(e){console.error("Error fetching control panel ".concat(t," data:"),e)})).finally((function(){e.isLoading=!1,D.a.done()}))},getParticipantDetailsInfo:function(){var t=this;D.a.start(),D.a.set(.1),this.isLoading=!0;var e={ITEM:"VIEW_ALL",EVENT_SYS_ID:this.event_sys_id};this.$apiCall.get(this.$apiBus.api_get_participant_info,{params:e}).then((function(e){e.status&&"true"===e.status&&(t.participants=e.response.map((function(t){return Object(d["a"])(Object(d["a"])({},t),{},{EXCLUDE_LIVE:"N"===t.EXCLUDE_LIVE,EXCLUDE_PRE_LIVE:"N"===t.EXCLUDE_PRE_LIVE,EXCLUDE_PRE_DRAW:"N"===t.EXCLUDE_PRE_DRAW,EXCLUDE_EARLY_BIRD_DRAW:"N"===t.EXCLUDE_EARLY_BIRD_DRAW})})),t.participantsDataLoaded=!0)})).catch((function(t){console.error("Error fetching participants:",t),m["a"].showErrorAlert(!0,"error","Failed to fetch participants")})).finally((function(){t.isLoading=!1,D.a.done()}))},updateParticipantDrawSettings:function(t){var e,a=this;D.a.start(),D.a.set(.1),this.isLoading=!0;var i=[{ITEM:"ADD",EVENT_SYS_ID:this.event_sys_id,PARTICIPANTS_SYS_ID:t.PARTICIPANTS_SYS_ID,EXCLUDE_LIVE:t.EXCLUDE_LIVE?"N":"Y",EXCLUDE_PRE_DRAW:t.EXCLUDE_PRE_DRAW?"N":"Y",EXCLUDE_PRE_LIVE:t.EXCLUDE_PRE_LIVE?"N":"Y",EXCLUDE_EARLY_BIRD_DRAW:t.EXCLUDE_EARLY_BIRD_DRAW?"N":"Y",CREATED_BY:(null===(e=this.getAuthUser)||void 0===e?void 0:e.UserId)||1}];this.$apiCall.post(this.$apiBus.api_post_lucky_draw_participant,i).then((function(e){"true"==e.status?(console.log("Updated settings for ".concat(t.PERSON_NAME)),a.getControlPanelLiveData(a.activeControlPanelTab)):a.getParticipantDetailsInfo()})).catch((function(t){console.error("Error updating participant settings:",t),m["a"].showErrorAlert(!0,"error","Failed to update participant settings"),a.getParticipantDetailsInfo()})).finally((function(){a.isLoading=!1,D.a.done()}))},includeParticipant:function(t){t.EXCLUDE_LIVE=!0,t.EXCLUDE_PRE_DRAW=!0,t.EXCLUDE_PRE_LIVE=!0,t.EXCLUDE_EARLY_BIRD_DRAW=!0,this.updateParticipantDrawSettings(t)},excludeParticipant:function(t){t.EXCLUDE_LIVE=!1,t.EXCLUDE_PRE_DRAW=!1,t.EXCLUDE_PRE_LIVE=!1,t.EXCLUDE_EARLY_BIRD_DRAW=!1,this.updateParticipantDrawSettings(t)},saveControlPanelSettings:function(){var t;if(!this.isProgrammaticUpdate){D.a.start(),D.a.set(.1);var e={ITEM:"ADD_PRE_LUCKY_DRAW_SETUP",EVENT_SYS_ID:this.event_sys_id,LIVE_DRAW:this.liveDraw.enabled?"1":"0",LD_FROM_NUMBER:this.liveDraw.enabled?this.liveDraw.fromNumber:"",LD_TO_NUMBER:this.liveDraw.enabled?this.liveDraw.toNumber:"",LD_NO_OF_PRIZE_POSITION:this.liveDraw.enabled?this.liveDraw.prizePositions:"",LIVE_PRE_DRAW:this.preLiveDraw.enabled?"1":"0",LPD_FROM_NUMBER:this.preLiveDraw.enabled?this.preLiveDraw.fromNumber:"",LPD_TO_NUMBER:this.preLiveDraw.enabled?this.preLiveDraw.toNumber:"",LPD_NO_OF_PRIZE_POSITION:this.preLiveDraw.enabled?this.preLiveDraw.prizePositions:"",PRE_DRAW:this.preDraw.enabled?"1":"0",PD_FROM_NUMBER:this.preDraw.enabled?this.preDraw.fromNumber:"",PD_TO_NUMBER:this.preDraw.enabled?this.preDraw.toNumber:"",PD_NO_OF_PRIZE_POSITION:this.preDraw.enabled?this.preDraw.prizePositions:"",EARLY_BIRD_DRAW:this.earlyBird.enabled?"1":"0",EBD_FROM_NUMBER:this.earlyBird.enabled?this.earlyBird.fromNumber:"",EBD_TO_NUMBER:this.earlyBird.enabled?this.earlyBird.toNumber:"",EBD_NO_OF_PRIZE_POSITION:this.earlyBird.enabled?this.earlyBird.prizePositions:"",SPINNING_WHEEL:this.spinningWheel.enabled?"1":"0",SW_FROM_NUMBER:this.spinningWheel.enabled?this.spinningWheel.fromNumber:"",SW_TO_NUMBER:this.spinningWheel.enabled?this.spinningWheel.toNumber:"",SW_NO_OF_PRIZE_POSITION:this.spinningWheel.enabled?this.spinningWheel.prizePositions:"",DOOR_GIFT:this.doorGift.enabled?"1":"0",DG_FROM_NUMBER:this.doorGift.enabled?this.doorGift.fromNumber:"",DG_TO_NUMBER:this.doorGift.enabled?this.doorGift.toNumber:"",DG_NO_OF_PRIZE_POSITION:this.doorGift.enabled?this.doorGift.prizePositions:"",CREATED_BY:(null===(t=this.getAuthUser)||void 0===t?void 0:t.UserId)||1};this.$apiCall.post(this.$apiBus.api_post_lucky_draw,e).then((function(t){t.status&&"true"===t.status?console.log("Control panel settings saved successfully!"):m["a"].showErrorAlert(!0,"error",t.response||"Failed to save settings")})).catch((function(t){console.error("Error saving control panel settings:",t),m["a"].showErrorAlert(!0,"error","Failed to save control panel settings")})).finally((function(){D.a.done()}))}},getWinnerDetailsInfo:function(){var t=this;D.a.start(),D.a.set(.1),this.isLoading=!0;var e={ITEM:"VIEW_ALL",EVENT_SYS_ID:this.event_sys_id};this.$apiCall.get(this.$apiBus.api_get_winner_info,{params:e}).then((function(e){e.status&&"true"===e.status?(t.winners=e.response,t.filterWinners()):(t.winners=[],t.filteredWinners=[])})).catch((function(t){console.error("Error fetching winners:",t),m["a"].showErrorAlert(!0,"error","Failed to fetch winners")})).finally((function(){t.isLoading=!1,D.a.done()}))},exportParticipants:function(){var t=["S/N","Lucky Draw Number","Participant Name"],e=this.filteredParticipants.map((function(t,e){return{SN:e+1,LUCKY_DRAW_NO:t.LUCKY_DRAW_NO||"",PARTICIPANT_NAME:t.PARTICIPANT_NAME||t.PERSON_NAME||""}})),a=["SN","LUCKY_DRAW_NO","PARTICIPANT_NAME"],i=this.formatJson(a,e),r=this.specific_event_details.EVENT_NAME?"".concat(this.specific_event_details.EVENT_NAME,"_Participants"):"Lucky_Draw_Participants";this.generateXlsx(t,i,r)},exportWinners:function(){var t=["No","Lucky Draw Number","Name","Lucky Draw Availability (Y/N)","Table Number","Prize Won","Lucky Draw Type","Prize Position","Redeemed"],e=["INDEX","LUCKY_DRAW_NUMBER","NAME","LUCKY_DRAW_AVAILABILITY","TABLE_NUMBER","PRIZE_WON","LUCKY_DRAW_TYPE","PRIZE_POSITION","REDEEMED"],a=[],i=JSON.parse(JSON.stringify(this.winners));i.forEach((function(t,e){t["INDEX"]=e+1,a.push(t)}));var r=this.formatJson(e,a),n=this.specific_event_details.EVENT_NAME?"".concat(this.specific_event_details.EVENT_NAME,"_Winners"):"Winners_List";this.generateXlsx(t,r,n)},formatJson:function(t,e){return e.map((function(e){return t.map((function(t){var a;return null!==(a=e[t])&&void 0!==a?a:""}))}))},generateXlsx:function(t,e,a){var i=h["c"].aoa_to_sheet([t].concat(Object(u["a"])(e))),r=h["c"].book_new();h["c"].book_append_sheet(r,i,"Sheet1");var n=a.replace(/[^a-z0-9_-\s]/gi,"_");h["e"](r,"".concat(n,".xlsx"))},getPrizeDetailsInfo:function(){var t=this;D.a.start(),D.a.set(.1),this.isLoading=!0;var e={ITEM:"VIEW_ALL",EVENT_SYS_ID:this.event_sys_id};this.$apiCall.get(this.$apiBus.api_get_prize_info,{params:e}).then((function(e){e.status&&"true"===e.status&&Array.isArray(e.response)?t.prizes=e.response.sort((function(t,e){return parseInt(t.PRIZE_POSITION,10)-parseInt(e.PRIZE_POSITION,10)})):t.prizes=[]})).catch((function(t){console.error("Error fetching prizes:",t),m["a"].showErrorAlert(!0,"error","Failed to fetch prizes")})).finally((function(){t.isLoading=!1,D.a.done()}))},openAddPrizeModal:function(){this.newPrize={draw:"",name:"",position:"",description:""},this.$bvModal.show("add-prize-modal")},openPrizeUpdateModal:function(t){this.updatePrizeData=Object(d["a"])(Object(d["a"])({},t),{},{draw:t.LUCKY_DRAW_TYPE}),this.$bvModal.show("update-prize-modal")},addPrizeDetails:function(){var t,e=this;D.a.start(),D.a.set(.1),this.isLoading=!0;var a={ITEM:"ADD_UPDATE",PRIZE_SYS_ID:"0",EVENT_SYS_ID:this.event_sys_id,LUCKY_DRAW_TYPE:this.newPrize.draw,PRIZE_NAME:this.newPrize.name,PRIZE_POSITION:this.newPrize.position,CREATED_BY:(null===(t=this.getAuthUser)||void 0===t?void 0:t.UserId)||1};this.$apiCall.post(this.$apiBus.api_post_add_update_prize,a).then((function(t){"true"==t.status?(e.$bvModal.hide("add-prize-modal"),m["a"].showSuccessAlert(!0,"success",t.response),e.getPrizeDetailsInfo()):m["a"].showErrorAlert(!0,"error",t.response)})).catch((function(t){console.error("Error adding prize:",t),m["a"].showErrorAlert(!0,"error","Failed to add prize")})).finally((function(){e.isLoading=!1,D.a.done()}))},updatePrizeDetails:function(){var t,e=this;D.a.start(),D.a.set(.1),this.isLoading=!0;var a={ITEM:"ADD_UPDATE",PRIZE_SYS_ID:this.updatePrizeData.PRIZE_SYS_ID,EVENT_SYS_ID:this.event_sys_id,LUCKY_DRAW_TYPE:this.updatePrizeData.draw,PRIZE_NAME:this.updatePrizeData.PRIZE_NAME,PRIZE_POSITION:this.updatePrizeData.PRIZE_POSITION,PRIZE_DESCRIPTION:this.updatePrizeData.PRIZE_DESCRIPTION,CREATED_BY:(null===(t=this.getAuthUser)||void 0===t?void 0:t.UserId)||1};this.$apiCall.post(this.$apiBus.api_post_add_update_prize,a).then((function(t){"true"==t.status?(e.$bvModal.hide("update-prize-modal"),m["a"].showSuccessAlert(!0,"success",t.response),e.getPrizeDetailsInfo()):m["a"].showErrorAlert(!0,"error",t.response)})).catch((function(t){console.error("Error updating prize:",t),m["a"].showErrorAlert(!0,"error","Failed to update prize")})).finally((function(){e.isLoading=!1,D.a.done()}))},deletePrize:function(t){var e=this;return Object(_["a"])(Object(p["a"])().mark((function a(){var i,r,n;return Object(p["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,m["a"].showConfirmationAlert("Are you sure?","You want to delete this prize!","warning");case 2:i=a.sent,i.isConfirmed?(D.a.start(),D.a.set(.1),e.isLoading=!0,n={ITEM:"DELETE",PRIZE_SYS_ID:t.PRIZE_SYS_ID,EVENT_SYS_ID:e.event_sys_id,CREATED_BY:(null===(r=e.getAuthUser)||void 0===r?void 0:r.UserId)||1},e.$apiCall.post(e.$apiBus.api_post_add_update_prize,n).then((function(t){"true"==t.status?(e.$bvModal.hide("update-prize-modal"),m["a"].showSuccessAlert(!0,"success",t.response),e.getPrizeDetailsInfo()):m["a"].showErrorAlert(!0,"error",t.response)})).catch((function(t){console.error("Error deleting prize:",t),m["a"].showErrorAlert(!0,"error","Failed to delete prize")})).finally((function(){e.isLoading=!1,D.a.done()}))):(e.isLoading=!1,D.a.done());case 4:case"end":return a.stop()}}),a)})))()},triggerPrizeFileInput:function(){this.prizeExcelData=[],this.$refs.prizeFileInput.value="",this.$refs.prizeFileInput.click()},_handlePrizeFileUpload:function(t){var e=this,a=t.target.files[0];if(a){var i=new FileReader;i.onload=function(t){try{var a=new Uint8Array(t.target.result),i=h["b"](a,{type:"array"}),r=i.Sheets[i.SheetNames[0]],n=h["c"].sheet_to_json(r);e.prizeExcelData=n.map((function(t,e){var a={};for(var i in t)a[i.toLowerCase().trim()]=t[i];var r=a["name"]||a["prize name"]||a["prize_name"]||"",n=a["position"]||a["prize position"]||a["prize_position"]||"",s=a["type"]||a["draw type"]||a["lucky_draw_type"]||"",l=a["description"]||a["prize description"]||a["prize_description"]||"",o=a["lucky draw number"]||a["Lucky Draw Number"]||a["lucky drawnumber"]||a["lucky_draw_number"];return{S_NO:t["S/N"]||t["S_NO"]||e+1,PRIZE_NAME:r,PRIZE_POSITION:n,LUCKY_DRAW_TYPE:s,PRIZE_DESCRIPTION:l,LUCKY_DRAW_NO:o}})).filter((function(t){return t.PRIZE_NAME}))}catch(s){console.error("Error processing Excel file:",s),m["a"].showErrorAlert(!0,"error","Error processing Excel file"),e.prizeExcelData=[]}},i.readAsArrayBuffer(a)}},handlePrizeFileUpload:function(t){var e=this,a=t.target.files[0];if(a){var i=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return String(t).toLowerCase().normalize("NFKD").replace(/[\u0300-\u036f]/g,"").replace(/[\r\n]+/g," ").replace(/[^\w\s#]+/g," ").replace(/[_\-\.]+/g," ").replace(/\s+/g," ").trim()},r=function(t){if(!t||"object"!==Object(c["a"])(t))return"";var e=Object.keys(t).map((function(e){return{origKey:e,norm:i(e),value:t[e]}}));console.debug("Prize file header normalization:",e.map((function(t){return{orig:t.origKey,norm:t.norm}})));var a,r=["lucky draw number","lucky draw no","lucky draw #","lucky number","lucky no","lucky_draw_number","lucky_draw_no","draw number","draw_no","draw no","drawnumber","lucky_no","lucky number (no)","lucky drawnumber"].map(i),n=Object(o["a"])(r);try{var s=function(){var t=a.value,i=e.find((function(e){return e.norm===t}));if(i&&void 0!==i.value&&null!==i.value&&""!==String(i.value).trim())return{v:i.value}};for(n.s();!(a=n.n()).done;){var l=s();if("object"===Object(c["a"])(l))return l.v}}catch(P){n.e(P)}finally{n.f()}var u,d=/(lucky.*?(draw|no|number|#|num))|((draw).*(no|number|#|num))|((lucky).*(no|number|#|num))/,p=Object(o["a"])(e);try{for(p.s();!(u=p.n()).done;){var _=u.value;if(d.test(_.norm)&&void 0!==_.value&&null!==_.value&&""!==String(_.value).trim())return _.value}}catch(P){p.e(P)}finally{p.f()}var v,f=Object(o["a"])(e);try{for(f.s();!(v=f.n()).done;){var h=v.value;if(h.norm.includes("draw")&&!/date|type|time|status/.test(h.norm)&&void 0!==h.value&&null!==h.value&&""!==String(h.value).trim())return h.value}}catch(P){f.e(P)}finally{f.f()}var m,b=Object(o["a"])(e);try{for(b.s();!(m=b.n()).done;){var D=m.value;if(/(\bno\b|\bnumber\b|#\b|\bnum\b)/.test(D.norm)&&!/phone|contact|invoice|order|serial|s no|s\/n|sno/.test(D.norm)&&void 0!==D.value&&null!==D.value&&""!==String(D.value).trim())return D.value}}catch(P){b.e(P)}finally{b.f()}return""},n=new FileReader;n.onload=function(t){try{var a=new Uint8Array(t.target.result),n=h["b"](a,{type:"array"}),s=n.Sheets[n.SheetNames[0]],l=h["c"].sheet_to_json(s,{defval:""});e.prizeExcelData=l.map((function(t,e){var a={};for(var n in t)a[i(n)]=t[n];var s=function(t){var e,r=Object(o["a"])(t);try{for(r.s();!(e=r.n()).done;){var n=e.value,s=i(n);if(Object.prototype.hasOwnProperty.call(a,s)&&""!==a[s])return a[s]}}catch(l){r.e(l)}finally{r.f()}return""},l=s(["name","prize name","prize_name","prize"]),c=s(["position","prize position","place","prize_position"]),u=s(["type","draw type","lucky draw type","prize type"]),d=s(["description","prize description","desc","prize_description"]),p=r(t),_=""===p||Number.isNaN(Number(p))?""!==p?String(p).trim():"":Number(p),v=s(["s/n","s no","s_no","s.no","sno","sl no","sl_no","sr no","sr_no"]),f=v||e+1;return{S_NO:f,PRIZE_NAME:l,PRIZE_POSITION:c,LUCKY_DRAW_TYPE:u,PRIZE_DESCRIPTION:d,LUCKY_DRAW_NO:_}})).filter((function(t){return t.PRIZE_NAME||t.PRIZE_POSITION}));var c=e.prizeExcelData.some((function(t){return""!==t.LUCKY_DRAW_NO&&"undefined"!==typeof t.LUCKY_DRAW_NO}));c||console.debug("[PrizeUpload] No LUCKY_DRAW_NO values detected. Check console mapping above to see normalized headers and adjust file headers or mapping heuristics.")}catch(u){console.error("Error processing Excel file:",u),m["a"].showErrorAlert(!0,"error","Error processing Excel file"),e.prizeExcelData=[]}},n.readAsArrayBuffer(a)}},downloadPrizeFormat:function(){var t=[["Prize Name","Prize Position","Draw Type","Lucky Draw Number"],["Samsung Galaxy Watch8","1","Live Draw","8001"],["iPhone 17 Pro (512 GB)","2","Pre-Live Draw","8002"],["Samsung Ultra S25 (512 GB)","3","Live Draw","8003"]],e=h["c"].book_new(),a=h["c"].aoa_to_sheet(t);h["c"].book_append_sheet(e,a,"Prizes Format"),h["e"](e,"Prizes_Format.xlsx")},onHandleImportPrizeData:function(){var t=this;return Object(_["a"])(Object(p["a"])().mark((function e(){var a,i;return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!==t.prizeExcelData.length){e.next=3;break}return m["a"].showErrorAlert(!0,"error","No data to import"),e.abrupt("return");case 3:return t.isImportingPrizes=!0,D.a.start(),D.a.set(.1),e.prev=6,a=t.prizeExcelData.map((function(e){var a,i={ITEM:"ADD_UPDATE",PRIZE_SYS_ID:"0",EVENT_SYS_ID:t.event_sys_id,LUCKY_DRAW_TYPE:e.LUCKY_DRAW_TYPE,PRIZE_NAME:e.PRIZE_NAME,PRIZE_POSITION:e.PRIZE_POSITION,PRIZE_DESCRIPTION:e.PRIZE_DESCRIPTION,LUCKY_DRAW_NO:e.LUCKY_DRAW_NO,CREATED_BY:(null===(a=t.getAuthUser)||void 0===a?void 0:a.UserId)||1,ORGANIZATION_SYS_ID:"1"};return i})),e.next=10,t.$apiCall.post(t.$apiBus.api_post_add_update_prize,a);case 10:i=e.sent,console.log("results",i),"true"===i.status?(m["a"].showSuccessAlert(!0,"success",i.response),t.getPrizeDetailsInfo()):m["a"].showErrorAlert(!0,"error",i.response),t.showPrizeImportModal=!1,t.prizeExcelData=[],t.$refs.prizeFileInput.value="",e.next=22;break;case 18:e.prev=18,e.t0=e["catch"](6),console.error("Import error:",e.t0),m["a"].showErrorAlert(!0,"error","Error importing data. Please try again.");case 22:return e.prev=22,t.isImportingPrizes=!1,D.a.done(),e.finish(22);case 26:case"end":return e.stop()}}),e,null,[[6,18,22,26]])})))()},cancelPrizeUpload:function(){this.prizeExcelData=[],this.showPrizeImportModal=!1,this.$refs.prizeFileInput.value=""},getEventSeatingArrangement:function(){var t=this;return Object(_["a"])(Object(p["a"])().mark((function e(){var a;return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return D.a.start(),e.prev=1,e.next=4,t.$apiCall.get(t.$apiBus.api_get_view_seating_arrangement,{params:{ITEM:"VIEW_ALL",EVENT_SYS_ID:t.event_sys_id}});case 4:a=e.sent,a.status&&"true"===a.status&&(t.Table_list_details=a.response,t.tableLoaded=!0),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),console.error(e.t0);case 11:D.a.done();case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))()},loadTables:function(){this.tableLoaded&&this.Table_list_details.length},onHandleAddParticipants:function(){var t=this;return Object(_["a"])(Object(p["a"])().mark((function e(){var a,i;return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return D.a.start(),e.prev=1,a=[Object(d["a"])({ITEM:"ADD",EVENT_SYS_ID:t.event_sys_id,CREATED_BY:t.user_sys_id,PARTICIPANTS_SYS_ID:0,EXCLUDE_LIVE:"N",EXCLUDE_PRE_LIVE:"N",EXCLUDE_PRE_DRAW:"N",EXCLUDE_EARLY_BIRD_DRAW:"N",EXCLUDE:"N"},t.formData)],e.next=5,t.$apiCall.post(t.$apiBus.api_post_lucky_draw_participant,a);case 5:i=e.sent,"true"===i.status?(t.$bvToast.toast("Data imported successfully! ".concat(a.length," records added."),{title:"Success",variant:"success",solid:!0}),t.getParticipantDetailsInfo()):t.$bvToast.toast(i.response||"Failed to import data",{title:"Error",variant:"danger",solid:!0});case 7:return e.prev=7,t.$bvModal.hide("modal-1"),D.a.done(),e.finish(7);case 11:case"end":return e.stop()}}),e,null,[[1,,7,11]])})))()},onLiveDrawTypeChange:function(){console.log("Selected draw type:",this.selectedLiveDrawType),this.selectedLuckyDrawSubType=null},onLuckyDrawSubTypeChange:function(){console.log("Selected lucky draw sub-type:",this.selectedLuckyDrawSubType)},openWinnerModalForPosition:function(t){var e=this;if(!this.isDrawing&&!this.isLoading){console.log("Right-clicked on position: ".concat(t)),this.channel.postMessage({action:"refresh"}),this.currentDrawIndex=parseInt(t);var a=this.getDrawSettings;this.fromNumber=parseInt(a.fromNumber),this.toNumber=parseInt(a.toNumber),this.initializeDrawState().then((function(){e.$bvModal.show("winningModalForLiveDraw")}))}},startLiveDraw:function(){if("LUCKY_DRAW"!==this.selectedLiveDrawType||this.selectedLuckyDrawSubType)if(this.selectedLiveDrawType)if("LUCKY_DRAW"!==this.selectedLiveDrawType||this.getDrawSettings.enabled)if("LUCKY_DRAW"===this.selectedLiveDrawType){var t="/event/event-luckydrawdisplay",e={drawType:this.selectedLiveDrawType,eventId:this.event_sys_id,drawOrder:this.drawOrder,luckyDrawSubType:this.selectedLuckyDrawSubType};this.getDrawSettings.fromNumber&&(e.fromNumber=this.getDrawSettings.fromNumber),this.getDrawSettings.toNumber&&(e.toNumber=this.getDrawSettings.toNumber),this.getDrawSettings.prizePositions&&(e.prizePositions=this.getDrawSettings.prizePositions);var a=this.$router.resolve({path:t,query:e});window.open(a.href,"_blank")}else console.log("Start button clicked for ".concat(this.selectedLiveDrawType,", but no navigation action is configured."));else this.$bvToast.toast("This draw type is not enabled. Please enable it in the Control Panel first.",{title:"Warning",variant:"warning",solid:!0});else this.$bvToast.toast("Please select a draw type first",{title:"Warning",variant:"warning",solid:!0});else this.$bvToast.toast("Please select a Lucky Draw sub-type (Live, Pre-Live, or Pre-Draw)",{title:"Warning",variant:"warning",solid:!0})},startLiveDrawForWinnerAnnounced:function(){this.channel.postMessage({action:"refresh"});var t=this.getDrawSettings;this.fromNumber=parseInt(t.fromNumber),this.toNumber=parseInt(t.toNumber),"top-to-bottom"===this.drawOrder?this.currentDrawIndex=this.fromNumber:this.currentDrawIndex=this.toNumber,this.initializeDrawState(),this.$bvModal.show("winningModalForLiveDraw")},initializeDrawState:function(){var t=this;return Object(_["a"])(Object(p["a"])().mark((function e(){return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.next=3,t.fetchEligibleParticipants();case 3:return e.next=5,t.fetchExistingWinners();case 5:t.reconcileDrawData(),t.isLoading=!1;case 7:case"end":return e.stop()}}),e)})))()}},Object(l["a"])(r,"initializeDrawState",(function(){var t=this;return Object(_["a"])(Object(p["a"])().mark((function e(){return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.next=3,t.fetchEligibleParticipants();case 3:return e.next=5,t.fetchExistingWinners();case 5:t.reconcileDrawData(),t.isLoading=!1;case 7:case"end":return e.stop()}}),e)})))()})),Object(l["a"])(r,"resetWinnerModal",(function(){this.isDrawing=!1,this.currentWinner=null,this.winnerFound=!1,this.isSavingWinner=!1,this.resetMainDisplay()})),Object(l["a"])(r,"fetchExistingWinners",(function(){var t=this;return Object(_["a"])(Object(p["a"])().mark((function e(){var a,i;return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.event_sys_id){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,a={ITEM:"VIEW_ALL",EVENT_SYS_ID:t.event_sys_id},e.next=6,t.$apiCall.get(t.$apiBus.api_get_winner_info,{params:a});case 6:i=e.sent,"true"===i.status&&Array.isArray(i.response)?t.existingWinners=i.response.filter((function(e){return e.LUCKY_DRAW_TYPE===t.apiLuckyDrawType})):t.existingWinners=[],e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](2),console.error("Error fetching existing winners:",e.t0),t.existingWinners=[];case 14:case"end":return e.stop()}}),e,null,[[2,10]])})))()})),Object(l["a"])(r,"reconcileDrawData",(function(){var t=new Set(this.existingWinners.map((function(t){return t.PARTICIPANTS_SYS_ID})));this.availableNumbers=this.participants.filter((function(e){return!t.has(e.PARTICIPANTS_SYS_ID)})).map((function(t){return{LUCKY_DRAW_NO:t.LUCKY_DRAW_NO,PARTICIPANTS_SYS_ID:t.PARTICIPANTS_SYS_ID}})),this.calculateNextPosition()})),Object(l["a"])(r,"calculateNextPosition",(function(){var t=this,e=this.currentDrawIndex,a=Math.min(this.fromNumber,this.toNumber),i=Math.max(this.fromNumber,this.toNumber);if(null===e||e<a||e>i)return this.$bvModal.hide("winningModalForLiveDraw"),void m["a"].showInfoAlert(!0,"info","End of prize list reached!");this.currentPrizePosition=e;var r=this.prizes.find((function(e){return e.PRIZE_POSITION==t.currentPrizePosition&&e.LUCKY_DRAW_TYPE===t.apiLuckyDrawType})),n=this.existingWinners.find((function(e){return parseInt(e.PRIZE_POSITION)===t.currentPrizePosition}));n?(this.winnerFound=!0,this.currentWinner={prize:r,participant:{PARTICIPANT_NAME:n.PARTICIPANT_NAME||n.NAME,LUCKY_DRAW_NO:n.LUCKY_DRAW_NO,DEPARTMENT:n.DEPARTMENT,PARTICIPANTS_SYS_ID:n.PARTICIPANTS_SYS_ID}},this.stopCasinoAnimation(this.currentWinner.participant.LUCKY_DRAW_NO)):(this.winnerFound=!1,this.currentWinner={prize:r,participant:null},this.resetMainDisplay()),this.channel.postMessage({action:"display-setup",data:{prizeName:(null===r||void 0===r?void 0:r.PRIZE_NAME)||"---",prizePosition:this.currentPrizePosition}})})),Object(l["a"])(r,"drawAgain",(function(){var t,e=this;this.currentWinner&&this.currentWinner.participant?(this.channel.postMessage({action:"start",prizeName:null===(t=this.currentWinner.prize)||void 0===t?void 0:t.PRIZE_NAME,prizePosition:this.currentPrizePosition}),this.isDrawing=!0,this.startCasinoAnimation(),setTimeout((function(){var t;if(!e.currentWinner||!e.currentWinner.participant)return e.stopCasinoAnimation("0000"),void(e.isDrawing=!1);var a=e.currentWinner.participant.LUCKY_DRAW_NO;e.stopCasinoAnimation(a),e.channel.postMessage({action:"stop",winner:{luckyNumber:a,name:e.currentWinner.participant.PARTICIPANT_NAME,prize:(null===(t=e.currentWinner.prize)||void 0===t?void 0:t.PRIZE_NAME)||"N/A",position:e.currentPrizePosition,winnerDepartment:e.currentWinner.participant.DEPARTMENT}})}),8e3)):m["a"].showErrorAlert(!0,"error","No winner loaded to re-draw.")})),Object(l["a"])(r,"requestDraw",(function(){var t=this;if(!this.isDrawing)if("top-to-bottom"===this.drawOrder&&this.currentPrizePosition>this.toNumber||"bottom-to-top"===this.drawOrder&&this.currentPrizePosition<this.fromNumber)this.$bvModal.hide("winningModalForLiveDraw");else if(this.availableNumbers&&0!==this.availableNumbers.length){var e=this.prizes.find((function(e){return e.PRIZE_POSITION==t.currentPrizePosition&&e.LUCKY_DRAW_TYPE===t.apiLuckyDrawType}));this.channel.postMessage({action:"start",prizeName:null===e||void 0===e?void 0:e.PRIZE_NAME,prizePosition:this.currentPrizePosition}),this.isDrawing=!0,this.startCasinoAnimation(),setTimeout((function(){try{if(0===t.availableNumbers.length)throw new Error("No participants available.");var a=Math.floor(Math.random()*t.availableNumbers.length),i=t.availableNumbers.splice(a,1)[0];if(!i)throw new Error("Failed to pick participant.");var r=t.participants.find((function(t){return t.PARTICIPANTS_SYS_ID===i.PARTICIPANTS_SYS_ID}));if(!r)throw new Error("Participant details not found.");t.currentWinner={participant:r,prize:e},t.stopCasinoAnimation(t.currentWinner.participant.LUCKY_DRAW_NO),t.winnerFound=!0,null!==r&&void 0!==r&&r.PARTICIPANTS_SYS_ID&&t.saveWinner(t.currentWinner.participant)}catch(n){console.error("Draw Error:",n),t.stopCasinoAnimation("0000"),t.isDrawing=!1,t.$bvToast.toast("An error occurred during selection.",{title:"Draw Error",variant:"danger",solid:!0})}}),8e3)}else this.$bvToast.toast("No eligible participants found for this draw!",{title:"Error",variant:"danger",solid:!0})})),Object(l["a"])(r,"saveWinner",(function(t){var e=this;return Object(_["a"])(Object(p["a"])().mark((function a(){var i,r,n,s;return Object(p["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.currentWinner){a.next=2;break}return a.abrupt("return");case 2:return e.isSavingWinner=!0,r=[{ITEM:"ADD",ORGANIZATION_SYS_ID:"1",PARTICIPANTS_SYS_ID:t.PARTICIPANTS_SYS_ID,EVENT_SYS_ID:e.event_sys_id,LUCKY_DRAW_NO:t.LUCKY_DRAW_NO,LUCKY_DRAW_TYPE:"Live Draw",PRIZE_POSITION:e.currentPrizePosition,CREATED_BY:(null===(i=e.getAuthUser)||void 0===i?void 0:i.UserId)||1}],a.prev=4,a.next=7,e.$apiCall.post(e.$apiBus.api_post_lucky_winner,r);case 7:if(n=a.sent,"true"!==n.status&&!n.success){a.next=15;break}return e.channel.postMessage({action:"stop",winner:{luckyNumber:e.currentWinner.participant.LUCKY_DRAW_NO,name:e.currentWinner.participant.PARTICIPANT_NAME,prize:(null===(s=e.currentWinner.prize)||void 0===s?void 0:s.PRIZE_NAME)||"N/A",position:e.currentPrizePosition,winnerDepartment:e.currentWinner.participant.DEPARTMENT}}),a.next=12,e.fetchExistingWinners();case 12:e.getWinnerDetailsInfo(),a.next=16;break;case 15:e.availableNumbers.push(t);case 16:a.next=21;break;case 18:a.prev=18,a.t0=a["catch"](4),e.availableNumbers.push(t);case 21:return a.prev=21,e.isSavingWinner=!1,a.finish(21);case 24:case"end":return a.stop()}}),a,null,[[4,18,21,24]])})))()})),Object(l["a"])(r,"redrawCurrentWinnerOld",(function(){var t=this;return Object(_["a"])(Object(p["a"])().mark((function e(){var a,i;return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.currentWinner&&t.currentWinner.participant){e.next=3;break}return m["a"].showErrorAlert(!0,"error","No current winner to redraw."),e.abrupt("return");case 3:return e.next=5,m["a"].showConfirmationAlert("Are you sure you want to redraw?","This will invalidate the current winner and draw a new one.","warning");case 5:if(a=e.sent,!a.isConfirmed){e.next=19;break}return i={PARTICIPANTSSYSID:t.currentWinner.participant.PARTICIPANTSSYSID,LUCKYDRAWNO:t.currentWinner.participant.LUCKYDRAWNO,prize:t.currentWinner.prize},e.next=10,t.fetchEligibleParticipants();case 10:return e.next=12,t.fetchExistingWinners();case 12:t.getWinnerDetailsInfo(),t.winnerFound=!1,t.isDrawing=!0,t.currentWinner={participant:null,prize:i.prize},t.resetMainDisplay(),t.startCasinoAnimation(),setTimeout(Object(_["a"])(Object(p["a"])().mark((function e(){var a,r,n,s,l,o,c,u,d,_;return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=Math.floor(Math.random()*t.availableNumbers.length),r=t.availableNumbers.splice(a,1)[0],n=t.participants.find((function(t){return t.PARTICIPANTSSYSID===r.PARTICIPANTSSYSID})),t.currentWinner={participant:n,prize:i.prize},t.stopCasinoAnimation(t.currentWinner.participant.LUCKYDRAWNO),t.winnerFound=!0,t.isSavingWinner=!0,e.prev=7,l={ITEM:"REDRAW",PARTICIPANTSSYSID:i.PARTICIPANTSSYSID,EVENTSYSID:t.eventsysid,LUCKYDRAWNO:i.LUCKYDRAWNO,PRIZEPOSITION:t.currentPrizePosition,LUCKYDRAWTYPE:t.apiLuckyDrawType,CREATEDBY:(null===(s=t.getAuthUser)||void 0===s?void 0:s.UserId)||1},e.next=11,t.apiCall.post(t.apiBus.apipostluckywinner,l);case 11:if(o=e.sent,!0!==o.status){e.next=28;break}return u={ITEM:"ADD",ORGANIZATIONSYSID:1,PARTICIPANTSSYSID:n.PARTICIPANTSSYSID,EVENTSYSID:t.eventsysid,LUCKYDRAWNO:n.LUCKYDRAWNO,LUCKYDRAWTYPE:t.apiLuckyDrawType,PRIZEPOSITION:t.currentPrizePosition,CREATEDBY:(null===(c=t.getAuthUser)||void 0===c?void 0:c.UserId)||1},e.next=16,t.apiCall.post(t.apiBus.apipostluckywinner,u);case 16:if(d=e.sent,!0!==d.status){e.next=24;break}return e.next=20,t.fetchExistingWinners();case 20:t.getWinnerDetailsInfo(),t.channel.postMessage({action:"stop",winner:{luckyNumber:t.currentWinner.participant.LUCKYDRAWNO,name:t.currentWinner.participant.PARTICIPANTNAME,prize:(null===(_=t.currentWinner.prize)||void 0===_?void 0:_.PRIZENAME)||"NA",position:t.currentPrizePosition}}),e.next=26;break;case 24:t.availableNumbers.push(r),m["a"].showErrorAlert(!0,"error",d.response||"Failed to save new winner.");case 26:e.next=29;break;case 28:m["a"].showErrorAlert(!0,"error",o.response||"Failed to invalidate old winner.");case 29:e.next=35;break;case 31:e.prev=31,e.t0=e["catch"](7),console.error("Error during redraw process:",e.t0),m["a"].showErrorAlert(!0,"error","An unexpected error occurred during redraw.");case 35:return e.prev=35,t.isSavingWinner=!1,e.finish(35);case 38:case"end":return e.stop()}}),e,null,[[7,31,35,38]])}))),8e3);case 19:case"end":return e.stop()}}),e)})))()})),Object(l["a"])(r,"redrawCurrentWinner",(function(){var t=this;return Object(_["a"])(Object(p["a"])().mark((function e(){var a,i;return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,m["a"].showConfirmationAlert("Are you sure you want to redraw?","This will invalidate the current winner and draw a new one.","warning");case 2:if(a=e.sent,!a.isConfirmed){e.next=16;break}return e.next=6,t.fetchEligibleParticipants();case 6:return e.next=8,t.fetchExistingWinners();case 8:t.getWinnerDetailsInfo(),t.winnerFound=!1,t.isDrawing=!0,t.resetMainDisplay(),i=t.prizes.find((function(e){return e.PRIZE_POSITION==t.currentPrizePosition&&e.LUCKY_DRAW_TYPE===t.apiLuckyDrawType})),t.channel.postMessage({action:"start",prizeName:null===i||void 0===i?void 0:i.PRIZE_NAME,prizePosition:t.currentPrizePosition}),t.startCasinoAnimation(),setTimeout(Object(_["a"])(Object(p["a"])().mark((function e(){var a,r,n,s,l,o,c;return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.availableNumbers&&0!==t.availableNumbers.length){e.next=5;break}return t.stopCasinoAnimation("0000"),t.isDrawing=!1,m["a"].showErrorAlert(!0,"error","No available participants to redraw from."),e.abrupt("return");case 5:return a=Math.floor(Math.random()*t.availableNumbers.length),r=t.availableNumbers.splice(a,1)[0],n=t.participants.find((function(t){return t.PARTICIPANTS_SYS_ID===r.PARTICIPANTS_SYS_ID})),t.currentWinner={participant:n,prize:i},t.stopCasinoAnimation(t.currentWinner.participant.LUCKY_DRAW_NO),t.winnerFound=!0,t.isSavingWinner=!0,e.prev=12,l={ITEM:"RE_DRAW",ORGANIZATION_SYS_ID:"1",PARTICIPANTS_SYS_ID:n.PARTICIPANTS_SYS_ID,EVENT_SYS_ID:t.event_sys_id,LUCKY_DRAW_NO:n.LUCKY_DRAW_NO,LUCKY_DRAW_TYPE:"Live Draw",PRIZE_POSITION:t.currentPrizePosition,CREATED_BY:(null===(s=t.getAuthUser)||void 0===s?void 0:s.UserId)||1},e.next=16,t.$apiCall.post(t.$apiBus.api_post_lucky_winner,l);case 16:if(o=e.sent,"true"!==o.status){e.next=24;break}return t.channel.postMessage({action:"stop",winner:{luckyNumber:t.currentWinner.participant.LUCKY_DRAW_NO,name:t.currentWinner.participant.PARTICIPANT_NAME,prize:null===(c=t.currentWinner.prize)||void 0===c?void 0:c.PRIZE_NAME,position:t.currentPrizePosition,winnerDepartment:t.currentWinner.participant.DEPARTMENT}}),e.next=21,t.fetchExistingWinners();case 21:t.getWinnerDetailsInfo(),e.next=25;break;case 24:m["a"].showErrorAlert(!0,"error",o.response||"Failed to invalidate old winner.");case 25:e.next=31;break;case 27:e.prev=27,e.t0=e["catch"](12),console.error("Error during redraw process:",e.t0),m["a"].showErrorAlert(!0,"error","An unexpected error occurred during redraw.");case 31:return e.prev=31,t.isSavingWinner=!1,e.finish(31);case 34:case"end":return e.stop()}}),e,null,[[12,27,31,34]])}))),8e3);case 16:case"end":return e.stop()}}),e)})))()})),Object(l["a"])(r,"prepareNextDraw",(function(){this.resetWinnerModal(),"top-to-bottom"===this.drawOrder?this.currentDrawIndex++:this.currentDrawIndex--,this.reconcileDrawData()})),Object(l["a"])(r,"resetMainDisplay",(function(){this.mainDisplayDigits.forEach((function(t){t.current="0",t.next="0",t.isFlipping=!1}))})),Object(l["a"])(r,"flipDigit",(function(t,e){var a=String(e);t.current!==a&&(t.isFlipping&&(t.current=t.next),t.next=a,t.isFlipping=!0,setTimeout((function(){t.current=a,t.isFlipping=!1}),600))})),Object(l["a"])(r,"startCasinoAnimation",(function(){var t=this;this.animationTimers.forEach((function(t){return clearInterval(t)})),this.animationTimers=[];var e=setInterval((function(){if(t.availableNumbers.length>0){var e=Math.floor(Math.random()*t.availableNumbers.length),a=t.availableNumbers[e],i=String(a.LUCKY_DRAW_NO).padStart(4,"0");i.split("").forEach((function(e,a){var i=t.mainDisplayDigits[a];i.current!==e&&(i.current=e)}))}}),100);this.animationTimers.push(e)})),Object(l["a"])(r,"stopCasinoAnimation",(function(t){var e=this;this.animationTimers.forEach((function(t){return clearInterval(t)})),this.animationTimers=[];var a=String(t).padStart(4,"0");a.split("").forEach((function(t,a){setTimeout((function(){e.flipDigit(e.mainDisplayDigits[a],t)}),200*a)}));var i=200*a.length+600;setTimeout((function(){e.isDrawing=!1}),i)})),r)},ft=vt,ht=(a("d77d"),a("8112"),Object(g["a"])(ft,n,s,!1,null,"e1e8fe70",null));e["default"]=ht.exports},d77d:function(t,e,a){"use strict";a("437a")},db35:function(t,e,a){},ed34:function(t,e,a){t.exports=a.p+"img/luckydrawbg.b061ca9b.jpeg"},f1b8:function(t,e,a){},f354:function(t,e,a){var i=a("d039"),r=a("b622"),n=a("83ab"),s=a("c430"),l=r("iterator");t.exports=!i((function(){var t=new URL("b?a=1&b=2&c=3","http://a"),e=t.searchParams,a="";return t.pathname="c%20d",e.forEach((function(t,i){e["delete"]("b"),a+=i+t})),s&&!t.toJSON||!e.size&&(s||!n)||!e.sort||"http://a/c%20d?a=1&c=3"!==t.href||"3"!==e.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!e[l]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==a||"x"!==new URL("http://x",void 0).host}))},f4e8:function(t,e,a){}}]);