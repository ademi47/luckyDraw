(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e13b16f6"],{"6f7a":function(e,t,a){"use strict";a("9d08")},"95cd":function(e,t,a){e.exports=a.p+"img/loader.85135c1c.gif"},"9d08":function(e,t,a){},ac32:function(e,t,a){"use strict";a.r(t);a("99af");var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"file-upload-page"},[e.loading?t("div",[e._m(0)]):e._e(),t("div",{staticClass:"main-content card mt-3"},[t("div",{staticClass:"card-body"},[t("b-tabs",[t("b-tab",{attrs:{title:"Banner Image"},on:{click:function(t){e.moduleName="BANNER_IMAGE",e.resetAllFiles()}}},[t("div",{staticClass:"row mt-3"},[e._l(e.bannerImages,(function(a,i){return t("div",{key:i,staticClass:"col-md-4 col-12 col-lg-4 col-xl-4 mb-3"},[a.FILE_NAME?t("div",[t("div",{staticClass:"file-input rectangle-container"},[t("label",{staticClass:"upload mt-1 mb-0 image-upload-component rectangle-upload",on:{click:function(t){return e.$bvModal.show("bannerImages")}}},[t("img",{staticClass:"rectangle-image",attrs:{src:"".concat(e.imageUrl,"/").concat(a.FILE_NAME)},on:{error:function(t){return e.handleImageError(t,a.FILE_NAME)}}})])]),t("div",{staticClass:"mt-2 text-center"},[t("input",{ref:"file_upload_img",refInFor:!0,staticStyle:{display:"none"},attrs:{type:"file",id:"inputs".concat(i),accept:"image/png,image/jpeg,image/jpg"},on:{change:function(t){return e.onFileChange(t,a.FILE_SYS_ID)}}}),t("div",{staticClass:"mt-2 text-center"},[t("button",{staticClass:"btn-action",attrs:{type:"button"},on:{click:function(t){return e.$refs.file_upload_img[i].click()}}},[t("b-icon",{staticClass:"edit-icon",attrs:{"font-scale":"1.2",icon:"pencil-square",variant:"primary"}})],1),t("button",{staticClass:"btn-action ml-2",attrs:{type:"button"},on:{click:function(t){return e.removeBannerImage(a.FILE_SYS_ID)}}},[t("b-icon",{staticClass:"delete-icon",attrs:{"font-scale":"1.2",icon:"trash",variant:"danger"}})],1)])])]):e._e()])})),e.bannerImages.length<10?t("div",{staticClass:"col-md-4 col-12 col-lg-4 col-xl-4 mb-3"},[t("div",{staticClass:"file-input d-flex align-items-center justify-content-center rectangle-container upload-new-container"},[t("label",{staticClass:"upload image-upload-component rectangle-upload",attrs:{for:"inputs"}},[t("div",{staticClass:"upload-button"},[t("i",{staticClass:"fa fa-plus fa-2x"}),t("div",{staticClass:"mt-2"},[e._v("Add Banner")])])]),t("input",{ref:"file_upload_img",staticStyle:{display:"none"},attrs:{type:"file",id:"inputs",accept:"image/png,image/jpeg,image/jpg"},on:{change:function(t){return e.onFileChange(t,0)}}})])]):e._e()],2)])],1)],1)]),t("b-modal",{attrs:{id:"bannerImages",title:"Banner Images","hide-footer":"",size:"lg",centered:""}},[t("div",{staticClass:"carousel-container"},[e.bannerImages.length>0?t("b-carousel",{staticClass:"banner-carousel",attrs:{controls:"",indicators:"",interval:0}},e._l(e.bannerImages,(function(a,i){return t("b-carousel-slide",{key:i,scopedSlots:e._u([{key:"img",fn:function(){return[t("img",{staticClass:"carousel-banner-image",attrs:{src:"".concat(e.imageUrl,"/").concat(a.FILE_NAME),alt:"Banner ".concat(i+1)},on:{error:function(t){return e.handleImageError(t,a.FILE_NAME)}}})]},proxy:!0}],null,!0)})})),1):t("div",{staticClass:"text-center p-4"},[t("p",{staticClass:"mb-0"},[e._v("No banner images found")])])],1)]),t("b-modal",{attrs:{title:"Crop Image",centered:"","hide-footer":"","no-close-on-esc":"","no-close-on-backdrop":"","header-close-content":"&times;",id:"crop-image-modal",size:"xl"}},[t("div",{staticClass:"w-100"},[t("div",{staticClass:"crop-container"},[t("vue-cropper",{ref:"cropper",attrs:{src:e.imgSrc,outputType:"png",preview:".preview",alt:"Source Image","img-style":{width:"100%",height:"400px"},cropBoxResizable:!0,toggleDragModeOnDblclick:!1,dragMode:"move",aspectRatio:2,viewMode:1,autoCropArea:.8},on:{ready:e.setCropBoxData}})],1),t("div",{staticClass:"text-right mt-3"},[t("b-button",{staticClass:"btn btn-secondary mr-2",on:{click:function(t){return e.closeCropModal()}}},[e._v(" Close ")]),t("b-button",{staticClass:"btn btn-primary",staticStyle:{"background-color":"#1f1b18 !important",color:"#fff !important"},on:{click:e.cropImage}},[e._v(" Save ")])],1)])])],1)},s=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"preloder loading_main_background",attrs:{id:"upload_loader"}},[t("img",{attrs:{src:a("95cd")}})])}],n=a("c7eb"),r=a("1da1"),o=a("5530"),l=(a("d3b7"),a("159b"),a("caad"),a("2532"),a("ac1f"),a("5319"),a("b0c0"),a("14d9"),a("466d"),a("81b2"),a("0eb6"),a("b7ef"),a("8bd4"),a("ace4"),a("5cc6"),a("907a"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("986a"),a("1d02"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7"),a("1b3b"),a("3d71"),a("c6e3"),a("471e")),c=a("95c3"),d=a.n(c),u=a("323e"),p=a.n(u),g=a("2f62"),f=(a("6107"),{components:{VueCropper:d.a},data:function(){return{bannerImages:[],imgSrc:"",cropImg:"",fileData:null,moduleName:"BANNER_IMAGE",imageUrl:"".concat("https://uat-iideasapi.cssdemo.dev","/routes/uploadedFiles"),adsImages:[],fileSysId:"",event_sys_id:null,user_sys_id:null}},computed:Object(o["a"])({},Object(g["c"])(["loading"])),mounted:function(){this.event_sys_id=JSON.parse(localStorage.getItem("selectedEventSysId")),this.user_sys_id=JSON.parse(localStorage.getItem("userInfo"));var e={page:"",folder:"Banner Upload"};this.$store.commit("addBreadcumb",e),this.getViewUploadedImages()},methods:Object(o["a"])(Object(o["a"])({},Object(g["b"])(["setLoading"])),{},{resetAllFiles:function(){Array.isArray(this.$refs.file_upload_img)&&this.$refs.file_upload_img.forEach((function(e){return e.value=null}))},onFileChange:function(e,t){if(e.target.files[0]){var a=e.target.files[0];if(this.fileData=a,this.fileSysId=t,!a.type.includes("image/"))return void this.$bvToast.toast("Please select an image file",{title:"Invalid File",variant:"danger",solid:!0});var i=10485760;if(a.size>i)return void this.$bvToast.toast("File size should be less than 10MB",{title:"File Too Large",variant:"danger",solid:!0});this.showCropModal(a)}},showCropModal:function(e){var t=this;if(p.a.start(),p.a.set(.1),this.setLoading(!0),"function"===typeof FileReader){var a=new FileReader;a.onload=function(e){t.imgSrc=e.target.result,t.$nextTick((function(){t.$refs.cropper&&t.$refs.cropper.replace(e.target.result),t.$bvModal.show("crop-image-modal"),p.a.done(),t.setLoading(!1)}))},a.readAsDataURL(e)}else this.$bvToast.toast("Sorry, FileReader API not supported",{title:"Browser Error",variant:"danger",solid:!0}),p.a.done(),this.setLoading(!1)},uploadFile:function(e){var t=this;return Object(r["a"])(Object(n["a"])().mark((function a(){var i,s,r,o;return Object(n["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,p.a.start(),t.setLoading(!0),i=new FormData,i.append("files[]",e),a.next=7,t.$apiCall.post(t.$apiBus.file_upload,i,{headers:{"Content-Type":"multipart/form-data"},timeout:3e4});case 7:s=a.sent,r=(null===s||void 0===s?void 0:s.data)||s,"true"===(null===r||void 0===r?void 0:r.status)||!0===(null===r||void 0===r?void 0:r.success)?t.saveImageUpload(e.name):(console.error("Upload failed:",r),t.$bvToast.toast("Upload failed. Please try again.",{title:"Upload Error",variant:"danger",solid:!0})),a.next=16;break;case 12:a.prev=12,a.t0=a["catch"](0),console.error("Error in uploadFile:",(null===(o=a.t0.response)||void 0===o?void 0:o.data)||a.t0),t.$bvToast.toast("Upload failed. Please check your internet connection and try again.",{title:"Upload Error",variant:"danger",solid:!0});case 16:return a.prev=16,p.a.done(),t.setLoading(!1),a.finish(16);case 20:case"end":return a.stop()}}),a,null,[[0,12,16,20]])})))()},saveImageUpload:function(e){var t=this,a={ITEM:"ADD_UPDATE",MODULE:"IMAGE",UPLOAD_FOR:this.moduleName,CREATED_BY:this.user_sys_id.USER_SYS_ID,FILE_NAME:e,FILE_SYS_ID:this.fileSysId||0,EVENT_SYS_ID:this.event_sys_id};this.$apiCall.post(this.$apiBus.add_update_file_upload,a).then((function(e){var a=(null===e||void 0===e?void 0:e.data)||e;"true"===(null===a||void 0===a?void 0:a.status)||!0===(null===a||void 0===a?void 0:a.success)?(l["a"].showSuccessAlert(!0,"success",a.response||"Image saved successfully!"),t.getViewUploadedImages(),t.resetAllFiles(),t.closeCropModal()):(console.error("Save failed:",a),t.$bvToast.toast("Save failed. Please try again.",{title:"Save Error",variant:"danger",solid:!0}))})).catch((function(e){var a;console.error("Error saving upload:",(null===(a=e.response)||void 0===a?void 0:a.data)||e),t.$bvToast.toast("Save failed. Please try again.",{title:"Save Error",variant:"danger",solid:!0})}))},removeBannerImage:function(e){var t=this;return Object(r["a"])(Object(n["a"])().mark((function a(){var i,s;return Object(n["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,l["a"].showConfirmationAlert("Are you sure?","You want to delete this banner image!","warning");case 2:i=a.sent,i.isConfirmed&&(p.a.start(),t.setLoading(!0),s={ITEM:"DELETE",EVENT_SYS_ID:t.event_sys_id,FILE_SYS_ID:e},t.$apiCall.post(t.$apiBus.add_update_file_upload,s).then((function(e){var a=(null===e||void 0===e?void 0:e.data)||e;"true"===(null===a||void 0===a?void 0:a.status)&&(l["a"].showSuccessAlert(!0,"success",a.response||"Image deleted successfully!"),t.getViewUploadedImages(),t.resetAllFiles())})).catch((function(e){console.error("Error deleting image:",e),t.$bvToast.toast("Delete failed. Please try again.",{title:"Delete Error",variant:"danger",solid:!0})})).finally((function(){p.a.done(),t.setLoading(!1)})));case 4:case"end":return a.stop()}}),a)})))()},getViewUploadedImages:function(){var e=this;return Object(r["a"])(Object(n["a"])().mark((function t(){var a,i,s,r;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return p.a.start(),p.a.set(.1),e.setLoading(!0),e.bannerImages=[],e.adsImages=[],a={ITEM:"SPECIFIC",MODULE:"IMAGE",EVENT_SYS_ID:e.event_sys_id,UPLOAD_FOR:"BANNER_IMAGE"},t.prev=6,t.next=9,e.$apiCall.get(e.$apiBus.view_file_upload_data,{params:a});case 9:i=t.sent,s=(null===i||void 0===i?void 0:i.data)||i,"true"===(null===s||void 0===s?void 0:s.status)&&s.response&&(r=e.groupBy(s.response,"UPLOAD_FOR"),e.bannerImages=(null===r||void 0===r?void 0:r.BANNER_IMAGE)||[],e.adsImages=(null===r||void 0===r?void 0:r.ADS_IMAGE)||[]),t.next=18;break;case 14:t.prev=14,t.t0=t["catch"](6),console.error("Error fetching images:",t.t0),e.$bvToast.toast("Failed to load images. Please refresh the page.",{title:"Load Error",variant:"danger",solid:!0});case 18:return t.prev=18,p.a.done(),e.setLoading(!1),t.finish(18);case 22:case"end":return t.stop()}}),t,null,[[6,14,18,22]])})))()},groupBy:function(e,t){return e.reduce((function(e,a){var i=a[t];return e[i]||(e[i]=[]),e[i].push(a),e}),{})},dataURLtoFile:function(e,t){var a=e.split(","),i=a[0].match(/:(.*?);/)[1],s=atob(a[1]),n=s.length,r=new Uint8Array(n);while(n--)r[n]=s.charCodeAt(n);return new File([r],t,{type:i})},setCropBoxData:function(){var e=this;this.$nextTick((function(){e.$refs.cropper&&(e.$refs.cropper.setAspectRatio(2),e.$refs.cropper.setCropBoxData({width:400,height:200}))}))},cropImage:function(){if(this.$refs.cropper){this.cropImg=this.$refs.cropper.getCroppedCanvas({width:800,height:400,minWidth:400,minHeight:200,maxWidth:1200,maxHeight:600,fillColor:"#fff",imageSmoothingEnabled:!0,imageSmoothingQuality:"high"}).toDataURL("image/jpeg",.9);var e=this.dataURLtoFile(this.cropImg,this.fileData.name);this.uploadFile(e)}else this.$bvToast.toast("Cropper not ready. Please try again.",{title:"Error",variant:"danger",solid:!0})},closeCropModal:function(){this.imgSrc="",this.cropImg="",this.fileData=null,this.$bvModal.hide("crop-image-modal"),this.resetAllFiles()},handleImageError:function(e,t){console.error("‚ùå Image not found: ".concat(t))}})}),m=f,v=(a("6f7a"),a("2877")),h=Object(v["a"])(m,i,s,!1,null,"36271e20",null);t["default"]=h.exports}}]);